import{aa as we,S as Se,i as Ce,s as ke,q as _,Y as le,b as L,y as c,Z as ge,I as ce,j as R,ak as ae,au as Ke,r as q,a as C,v as u,z as K,t as T,d as A,B as G,av as Jl,aw as pt,H as $e,U as Oe,V as De,ax as El,ay as Vl,F as at,g as Ie,e as He,O as Ge,az as Yl,l as B,E as Te,aA as Ee,aB as Nl,C as Qe,D as yt,G as St,aC as Ol,a2 as Zl,aD as Ql,x as Lt,ac as Xl,m as Ut,af as ot,aE as Ct,W as Ze,a7 as xl,a9 as en,a1 as ie,n as tn,w as Yt}from"./vendor-ui-9d42ca49.js";import{R as We,S as ln}from"./vendor-utils-9430c5aa.js";import{J as Dl,_ as nn,o as on}from"./vendor-editor-1278af61.js";import{P as Tl,T as Et,u as Al,y as sn,A as rn,S as an,q as un}from"./vendor-atomic-756de3e6.js";import{E as cn}from"./novel-editor-7c40b83e.js";import{s as Ot,z as fn,a as pn,l as _n,m as dn,c as hn,b as mn,B as gn,d as vn}from"./vendor-charts-e6a4a6c9.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const st={ServerURL:location.protocol+"//"+window.location.host||"/"},Tt=we([]),bn={id:"Desktop",global_shortcut:"",roles:{},default_role:{original:"",lowercase:""},selected_role:{original:"",lowercase:""}},ft=we("spacelab"),rt=we("selected"),ye=we(!1),$n=we(`${st.ServerURL}/documents/search`),Ne=we(bn),Zt=we([]);let Dt=we("");const ct=we(!1);let Ye=null;function kn(l){if(typeof document>"u")return;const e=`/assets/bulmaswatch/${l}/bulmaswatch.min.css`;if(Ye!=null&&Ye.href.endsWith(e))return;const n=document.createElement("link");n.rel="stylesheet",n.href=e,n.id="bulma-theme",n.onload=()=>{Ye&&Ye!==n&&Ye.remove(),Ye=n},document.head.appendChild(n);const t=document.head.querySelector('meta[name="color-scheme"]');t&&t.setAttribute("content",l)}ft.subscribe(kn);function wn(l){let e,n;return{c(){e=_("option"),n=le(l[1]),e.__value=l[0],e.value=e.__value},m(t,o){L(t,e,o),c(e,n)},p(t,[o]){o&2&&ge(n,t[1]),o&1&&(e.__value=t[0],e.value=e.__value)},i:ce,o:ce,d(t){t&&R(e)}}}function yn(l,e,n){let t,{subject:o}=e;const r=Tl(o),s=Et(r,Al.properties.name);return ae(l,s,a=>n(1,t=a)),Et(r,"http://localhost:9883/property/theme"),l.$$set=a=>{"subject"in a&&n(0,o=a.subject)},[o,t,s]}class Sn extends Se{constructor(e){super(),Ce(this,e,yn,wn,ke,{subject:0})}}function Cn(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function At(l,e=!1){const n=Cn(),t=`_${n}`;return Object.defineProperty(window,t,{value:o=>(e&&Reflect.deleteProperty(window,t),l==null?void 0:l(o)),writable:!1,configurable:!0}),n}async function me(l,e={}){return new Promise((n,t)=>{const o=At(s=>{n(s),Reflect.deleteProperty(window,`_${r}`)},!0),r=At(s=>{t(s),Reflect.deleteProperty(window,`_${o}`)},!0);window.__TAURI_IPC__({cmd:l,callback:o,error:r,...e})})}function Qt(l,e,n){const t=l.slice();return t[25]=e[n],t}function Rn(l){let e,n,t;function o(s){l[13](s)}let r={};return l[5]!==void 0&&(r.value=l[5]),e=new pt({props:r}),$e.push(()=>Oe(e,"value",o)),{c(){q(e.$$.fragment)},m(s,a){K(e,s,a),t=!0},p(s,a){const i={};!n&&a&32&&(n=!0,i.value=s[5],De(()=>n=!1)),e.$set(i)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Ln(l){let e,n,t;function o(s){l[14](s)}let r={type:"password",placeholder:"secret",icon:"fas fa-lock",expanded:!0};return l[6]!==void 0&&(r.value=l[6]),e=new pt({props:r}),$e.push(()=>Oe(e,"value",o)),{c(){q(e.$$.fragment)},m(s,a){K(e,s,a),t=!0},p(s,a){const i={};!n&&a&64&&(n=!0,i.value=s[6],De(()=>n=!1)),e.$set(i)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function En(l){let e;return{c(){e=le("Save")},m(n,t){L(n,e,t)},d(n){n&&R(e)}}}function Nn(l){let e,n;return e=new El({props:{type:"is-success",class:"is-right",iconPack:"fa",iconLeft:"check",$$slots:{default:[En]},$$scope:{ctx:l}}}),e.$on("click",l[8]),e.$on("submit",l[8]),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,o){const r={};o&268435456&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function On(l){let e,n,t,o,r,s;return e=new Ke({props:{$$slots:{default:[Rn]},$$scope:{ctx:l}}}),t=new Ke({props:{grouped:!0,$$slots:{default:[Ln]},$$scope:{ctx:l}}}),r=new Ke({props:{grouped:!0,$$slots:{default:[Nn]},$$scope:{ctx:l}}}),{c(){q(e.$$.fragment),n=C(),q(t.$$.fragment),o=C(),q(r.$$.fragment)},m(a,i){K(e,a,i),L(a,n,i),K(t,a,i),L(a,o,i),K(r,a,i),s=!0},p(a,i){const d={};i&268435488&&(d.$$scope={dirty:i,ctx:a}),e.$set(d);const g={};i&268435520&&(g.$$scope={dirty:i,ctx:a}),t.$set(g);const p={};i&268435456&&(p.$$scope={dirty:i,ctx:a}),r.$set(p)},i(a){s||(T(e.$$.fragment,a),T(t.$$.fragment,a),T(r.$$.fragment,a),s=!0)},o(a){A(e.$$.fragment,a),A(t.$$.fragment,a),A(r.$$.fragment,a),s=!1},d(a){G(e,a),a&&R(n),G(t,a),a&&R(o),G(r,a)}}}function Dn(l){let e,n,t;function o(s){l[15](s)}let r={type:"search",placeholder:"Fetch JSON",icon:"search"};return l[3]!==void 0&&(r.value=l[3]),e=new pt({props:r}),$e.push(()=>Oe(e,"value",o)),{c(){q(e.$$.fragment)},m(s,a){K(e,s,a),t=!0},p(s,a){const i={};!n&&a&8&&(n=!0,i.value=s[3],De(()=>n=!1)),e.$set(i)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Tn(l){let e;return{c(){e=le("WikiPage")},m(n,t){L(n,e,t)},d(n){n&&R(e)}}}function An(l){let e,n,t,o,r,s;function a(p){l[16](p)}let i={type:"search",placeholder:"Post JSON",icon:"search"};l[4]!==void 0&&(i.value=l[4]),e=new pt({props:i}),$e.push(()=>Oe(e,"value",a));function d(p){l[17](p)}let g={$$slots:{default:[Tn]},$$scope:{ctx:l}};return l[2]!==void 0&&(g.checked=l[2]),o=new Vl({props:g}),$e.push(()=>Oe(o,"checked",d)),{c(){q(e.$$.fragment),t=C(),q(o.$$.fragment)},m(p,f){K(e,p,f),L(p,t,f),K(o,p,f),s=!0},p(p,f){const h={};!n&&f&16&&(n=!0,h.value=p[4],De(()=>n=!1)),e.$set(h);const m={};f&268435456&&(m.$$scope={dirty:f,ctx:p}),!r&&f&4&&(r=!0,m.checked=p[2],De(()=>r=!1)),o.$set(m)},i(p){s||(T(e.$$.fragment,p),T(o.$$.fragment,p),s=!0)},o(p){A(e.$$.fragment,p),A(o.$$.fragment,p),s=!1},d(p){G(e,p),p&&R(t),G(o,p)}}}function Mn(l){let e;return{c(){e=le("Fetch")},m(n,t){L(n,e,t)},d(n){n&&R(e)}}}function Un(l){let e,n;return e=new El({props:{type:"is-primary",$$slots:{default:[Mn]},$$scope:{ctx:l}}}),e.$on("click",l[9]),e.$on("submit",l[9]),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,o){const r={};o&268435456&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function jn(l){let e,n,t,o,r,s;return e=new Ke({props:{grouped:!0,$$slots:{default:[Dn]},$$scope:{ctx:l}}}),t=new Ke({props:{grouped:!0,$$slots:{default:[An]},$$scope:{ctx:l}}}),r=new Ke({props:{grouped:!0,$$slots:{default:[Un]},$$scope:{ctx:l}}}),{c(){q(e.$$.fragment),n=C(),q(t.$$.fragment),o=C(),q(r.$$.fragment)},m(a,i){K(e,a,i),L(a,n,i),K(t,a,i),L(a,o,i),K(r,a,i),s=!0},p(a,i){const d={};i&268435464&&(d.$$scope={dirty:i,ctx:a}),e.$set(d);const g={};i&268435476&&(g.$$scope={dirty:i,ctx:a}),t.$set(g);const p={};i&268435456&&(p.$$scope={dirty:i,ctx:a}),r.$set(p)},i(a){s||(T(e.$$.fragment,a),T(t.$$.fragment,a),T(r.$$.fragment,a),s=!0)},o(a){A(e.$$.fragment,a),A(t.$$.fragment,a),A(r.$$.fragment,a),s=!1},d(a){G(e,a),a&&R(n),G(t,a),a&&R(o),G(r,a)}}}function Pn(l){let e,n,t,o,r;return o=new Dl({props:{content:l[1],onChange:l[7]}}),{c(){e=_("p"),e.innerHTML=`<i>The best editing experience is to configure Atomic Server, in the
        meantime use editor below. You will need to refresh page via Command R
        or Ctrl-R to see changes</i>`,n=C(),t=_("div"),q(o.$$.fragment),u(t,"class","editor")},m(s,a){L(s,e,a),L(s,n,a),L(s,t,a),K(o,t,null),r=!0},p(s,a){const i={};a&2&&(i.content=s[1]),o.$set(i)},i(s){r||(T(o.$$.fragment,s),r=!0)},o(s){A(o.$$.fragment,s),r=!1},d(s){s&&R(e),s&&R(n),s&&R(t),G(o)}}}function Xt(l){let e,n;return e=new Sn({props:{subject:l[25]}}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,o){const r={};o&1&&(r.subject=t[25]),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Wn(l){let e,n,t=l[0]??[],o=[];for(let s=0;s<t.length;s+=1)o[s]=Xt(Qt(l,t,s));const r=s=>A(o[s],1,1,()=>{o[s]=null});return{c(){for(let s=0;s<o.length;s+=1)o[s].c();e=at()},m(s,a){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(s,a);L(s,e,a),n=!0},p(s,a){if(a&1){t=s[0]??[];let i;for(i=0;i<t.length;i+=1){const d=Qt(s,t,i);o[i]?(o[i].p(d,a),T(o[i],1)):(o[i]=Xt(d),o[i].c(),T(o[i],1),o[i].m(e.parentNode,e))}for(Ie(),i=t.length;i<o.length;i+=1)r(i);He()}},i(s){if(!n){for(let a=0;a<t.length;a+=1)T(o[a]);n=!0}},o(s){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)A(o[a]);n=!1},d(s){Ge(o,s),s&&R(e)}}}function In(l){let e,n;return e=new Jl({props:{$$slots:{default:[Wn]},$$scope:{ctx:l}}}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,o){const r={};o&268435457&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Hn(l){let e,n,t,o,r,s,a,i,d,g,p,f,h;return n=new We({props:{path:"/atomic",$$slots:{default:[On]},$$scope:{ctx:l}}}),o=new We({props:{path:"/json",$$slots:{default:[jn]},$$scope:{ctx:l}}}),s=new We({props:{path:"/editor",$$slots:{default:[Pn]},$$scope:{ctx:l}}}),g=new Ke({props:{grouped:!0,position:"is-right",$$slots:{default:[In]},$$scope:{ctx:l}}}),{c(){e=_("div"),q(n.$$.fragment),t=C(),q(o.$$.fragment),r=C(),q(s.$$.fragment),a=C(),i=_("hr"),d=C(),q(g.$$.fragment),p=C(),f=_("nav"),f.innerHTML=`<div class="navbar-brand"><a class="navbar-item" href="/"><span class="icon" style="color: #333;"><i class="fas fa-home"></i></span></a> 
    <a class="navbar-item" href="/fetch/json">Fetch JSON Data</a> 
    <a class="navbar-item" href="/fetch/atomic">Set Atomic Server</a> 
    <a class="navbar-item" href="/fetch/editor">Edit JSON config</a></div>`,u(e,"class","box"),u(f,"class","navbar")},m(m,$){L(m,e,$),K(n,e,null),c(e,t),K(o,e,null),c(e,r),K(s,e,null),L(m,a,$),L(m,i,$),L(m,d,$),K(g,m,$),L(m,p,$),L(m,f,$),h=!0},p(m,[$]){const y={};$&268435552&&(y.$$scope={dirty:$,ctx:m}),n.$set(y);const b={};$&268435484&&(b.$$scope={dirty:$,ctx:m}),o.$set(b);const w={};$&268435458&&(w.$$scope={dirty:$,ctx:m}),s.$set(w);const S={};$&268435457&&(S.$$scope={dirty:$,ctx:m}),g.$set(S)},i(m){h||(T(n.$$.fragment,m),T(o.$$.fragment,m),T(s.$$.fragment,m),T(g.$$.fragment,m),h=!0)},o(m){A(n.$$.fragment,m),A(o.$$.fragment,m),A(s.$$.fragment,m),A(g.$$.fragment,m),h=!1},d(m){m&&R(e),G(n),G(o),G(s),m&&R(a),m&&R(i),m&&R(d),G(g,m),m&&R(p),m&&R(f)}}}function Fn(l,e,n){let t,o,r,s,a;ae(l,sn,D=>n(19,r=D)),ae(l,ye,D=>n(20,s=D)),ae(l,Ne,D=>n(21,a=D));let i={json:a};function d(D){if(console.log("contents changed:",D),console.log("is tauri",s),Ne.update(k=>(k=D.json,k)),ye)console.log("Updating config on server"),me("update_config",{configNew:D.json}).then(k=>{console.log(`Message: ${k}`)}).catch(k=>console.error(k));else{let k=`${st.ServerURL}/config/`;fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D.json)})}n(1,i=D)}let g=!1,p="https://raw.githubusercontent.com/terraphim/terraphim-cloud-fastapi/main/data/ref_arch.json",f="http://localhost:8000/documents/",h="http://localhost:9883/",m;const $=async()=>{console.log("Updating atomic server configuration");const D=rn.fromSecret(m);r.setServerUrl(h),console.log("Server set.Setting agent"),r.setAgent(D)},y=async()=>{S()},b=({data:{msg:D,data:k}})=>{console.log(D,k)};let w;const S=async()=>{const D=await nn(()=>import("./fetcher.worker-7e58969a.js"),[]);w=new D.default,w.onmessage=b;const k={msg:"fetcher",data:{url:p,postUrl:f,isWiki:g}};w.postMessage(k)},Q=Tl("http://localhost:9883/config/y3zx5wtm0bq"),Y=Et(Q,Al.properties.name);ae(l,Y,D=>n(12,o=D));const E=Et(Q,"http://localhost:9883/property/role");ae(l,E,D=>n(0,t=D));function O(D){h=D,n(5,h)}function I(D){m=D,n(6,m)}function W(D){p=D,n(3,p)}function H(D){f=D,n(4,f)}function z(D){g=D,n(2,g)}return l.$$.update=()=>{l.$$.dirty&4096&&console.log("Print name",o),l.$$.dirty&1&&console.log("Print roles",t)},[t,i,g,p,f,h,m,d,$,y,Y,E,o,O,I,W,H,z]}class zn extends Se{constructor(e){super(),Ce(this,e,Fn,Hn,ke,{})}}function qn(l){let e,n;return e=new cn({props:{defaultValue:l[0],isEditable:!l[1],disableLocalStorage:!0,onUpdate:l[2],extensions:[on]}}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,[o]){const r={};o&1&&(r.defaultValue=t[0]),o&2&&(r.isEditable=!t[1]),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Kn(l,e,n){let{html:t=""}=e,{readOnly:o=!1}=e,{outputFormat:r="html"}=e;const s=a=>{r==="markdown"?n(0,t=a.storage.markdown.getMarkdown()):n(0,t=a.getHTML())};return l.$$set=a=>{"html"in a&&n(0,t=a.html),"readOnly"in a&&n(1,o=a.readOnly),"outputFormat"in a&&n(3,r=a.outputFormat)},[t,o,s,r]}class Gn extends Se{constructor(e){super(),Ce(this,e,Kn,qn,ke,{html:0,readOnly:1,outputFormat:3})}}function Bn(l){let e,n,t,o,r,s,a,i;const d=[Yn,Vn],g=[];function p(f,h){return f[3]?0:1}return n=p(l),t=g[n]=d[n](l),{c(){e=_("div"),t.c(),o=C(),r=_("div"),r.innerHTML='<span class="hint-text svelte-1n7y4av">Double-click to edit • Ctrl+E to edit • Ctrl+S to save</span>',u(r,"class","edit-hint svelte-1n7y4av"),u(e,"class","content-viewer svelte-1n7y4av"),u(e,"tabindex","0"),u(e,"role","button"),u(e,"aria-label","Double-click to edit article content")},m(f,h){L(f,e,h),g[n].m(e,null),c(e,o),c(e,r),l[12](e),s=!0,a||(i=[B(e,"dblclick",l[7]),B(e,"keydown",l[8])],a=!0)},p(f,h){let m=n;n=p(f),n===m?g[n].p(f,h):(Ie(),A(g[m],1,1,()=>{g[m]=null}),He(),t=g[n],t?t.p(f,h):(t=g[n]=d[n](f),t.c()),T(t,1),t.m(e,o))},i(f){s||(T(t),s=!0)},o(f){A(t),s=!1},d(f){f&&R(e),g[n].d(),l[12](null),a=!1,Te(i)}}}function Jn(l){let e,n,t,o,r,s,a,i,d,g;function p(h){l[10](h)}let f={outputFormat:l[5]};return l[1].body!==void 0&&(f.html=l[1].body),e=new Gn({props:f}),$e.push(()=>Oe(e,"html",p)),{c(){q(e.$$.fragment),t=C(),o=_("div"),r=_("button"),r.textContent="Save",s=C(),a=_("button"),a.textContent="Cancel",u(r,"class","button is-primary"),u(a,"class","button is-light"),u(o,"class","edit-controls svelte-1n7y4av")},m(h,m){K(e,h,m),L(h,t,m),L(h,o,m),c(o,r),c(o,s),c(o,a),i=!0,d||(g=[B(r,"click",l[6]),B(a,"click",l[11])],d=!0)},p(h,m){const $={};m&32&&($.outputFormat=h[5]),!n&&m&2&&(n=!0,$.html=h[1].body,De(()=>n=!1)),e.$set($)},i(h){i||(T(e.$$.fragment,h),i=!0)},o(h){A(e.$$.fragment,h),i=!1},d(h){G(e,h),h&&R(t),h&&R(o),d=!1,Te(g)}}}function Vn(l){let e,n;return e=new ln({props:{source:l[1].body}}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,o){const r={};o&2&&(r.source=t[1].body),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Yn(l){let e,n=l[1].body+"";return{c(){e=_("div"),u(e,"class","prose")},m(t,o){L(t,e,o),e.innerHTML=n},p(t,o){o&2&&n!==(n=t[1].body+"")&&(e.innerHTML=n)},i:ce,o:ce,d(t){t&&R(e)}}}function Zn(l){let e,n,t=l[1].title+"",o,r,s,a,i;const d=[Jn,Bn],g=[];function p(f,h){return f[2]?0:1}return s=p(l),a=g[s]=d[s](l),{c(){e=_("div"),n=_("h2"),o=le(t),r=C(),a.c(),u(n,"class","svelte-1n7y4av"),u(e,"class","box wrapper svelte-1n7y4av")},m(f,h){L(f,e,h),c(e,n),c(n,o),c(e,r),g[s].m(e,null),i=!0},p(f,h){(!i||h&2)&&t!==(t=f[1].title+"")&&ge(o,t);let m=s;s=p(f),s===m?g[s].p(f,h):(Ie(),A(g[m],1,1,()=>{g[m]=null}),He(),a=g[s],a?a.p(f,h):(a=g[s]=d[s](f),a.c()),T(a,1),a.m(e,null))},i(f){i||(T(a),i=!0)},o(f){A(a),i=!1},d(f){f&&R(e),g[s].d()}}}function Qn(l){let e,n,t;function o(s){l[13](s)}let r={$$slots:{default:[Zn]},$$scope:{ctx:l}};return l[0]!==void 0&&(r.active=l[0]),e=new Yl({props:r}),$e.push(()=>Oe(e,"active",o)),{c(){q(e.$$.fragment)},m(s,a){K(e,s,a),t=!0},p(s,[a]){const i={};a&65598&&(i.$$scope={dirty:a,ctx:s}),!n&&a&1&&(n=!0,i.active=s[0],De(()=>n=!1)),e.$set(i)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Xn(l,e,n){let t,o,r;ae(l,ye,S=>n(14,r=S));let{active:s=!1}=e,{item:a}=e,{initialEdit:i=!1}=e,d=!1,g;async function p(){if(r)try{const S=await me("get_document",{document_id:a.id});S!=null&&S.document&&n(1,a=S.document)}catch(S){console.error("Failed to load document",S)}}async function f(){if(!r){n(2,d=!1);return}try{await me("create_document",{document:a}),n(2,d=!1)}catch(S){console.error("Failed to save document",S)}}function h(){n(2,d=!0)}function m(S){S.type!=="dblclick"&&((S.ctrlKey||S.metaKey)&&S.key==="e"&&(S.preventDefault(),n(2,d=!0)),d&&(S.ctrlKey||S.metaKey)&&S.key==="s"&&(S.preventDefault(),f()),d&&S.key==="Escape"&&(S.preventDefault(),n(2,d=!1)))}function $(S){l.$$.not_equal(a.body,S)&&(a.body=S,n(1,a))}const y=()=>n(2,d=!1);function b(S){$e[S?"unshift":"push"](()=>{g=S,n(4,g)})}function w(S){s=S,n(0,s)}return l.$$set=S=>{"active"in S&&n(0,s=S.active),"item"in S&&n(1,a=S.item),"initialEdit"in S&&n(9,i=S.initialEdit)},l.$$.update=()=>{l.$$.dirty&513&&s&&i&&n(2,d=!0),l.$$.dirty&7&&s&&a&&!d&&p(),l.$$.dirty&2&&n(3,t=/<\w+/.test((a==null?void 0:a.body)??"")),l.$$.dirty&8&&n(5,o=t?"html":"markdown")},[s,a,d,t,g,o,f,h,m,i,$,y,b,w]}class Ml extends Se{constructor(e){super(),Ce(this,e,Xn,Qn,ke,{active:0,item:1,initialEdit:9})}}async function Ul(l){return me("tauri",l)}async function xn(l,e){return Ul({__tauriModule:"Event",message:{cmd:"unlisten",event:l,eventId:e}})}async function eo(l,e,n){return Ul({__tauriModule:"Event",message:{cmd:"listen",event:l,windowLabel:e,handler:At(n)}}).then(t=>async()=>xn(l,t))}var xt;(function(l){l.WINDOW_RESIZED="tauri://resize",l.WINDOW_MOVED="tauri://move",l.WINDOW_CLOSE_REQUESTED="tauri://close-requested",l.WINDOW_CREATED="tauri://window-created",l.WINDOW_DESTROYED="tauri://destroyed",l.WINDOW_FOCUS="tauri://focus",l.WINDOW_BLUR="tauri://blur",l.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",l.WINDOW_THEME_CHANGED="tauri://theme-changed",l.WINDOW_FILE_DROP="tauri://file-drop",l.WINDOW_FILE_DROP_HOVER="tauri://file-drop-hover",l.WINDOW_FILE_DROP_CANCELLED="tauri://file-drop-cancelled",l.MENU="tauri://menu",l.CHECK_UPDATE="tauri://update",l.UPDATE_AVAILABLE="tauri://update-available",l.INSTALL_UPDATE="tauri://update-install",l.STATUS_UPDATE="tauri://update-status",l.DOWNLOAD_PROGRESS="tauri://update-download-progress"})(xt||(xt={}));async function to(l,e){return eo(l,null,e)}function el(l,e,n){const t=l.slice();return t[9]=e[n],t}function tl(l){let e,n=l[9].name+"",t,o;return{c(){e=_("option"),t=le(n),e.__value=o=l[9].name,e.value=e.__value},m(r,s){L(r,e,s),c(e,t)},p(r,s){s&1&&n!==(n=r[9].name+"")&&ge(t,n),s&1&&o!==(o=r[9].name)&&(e.__value=o,e.value=e.__value)},d(r){r&&R(e)}}}function lo(l){let e,n,t,o,r,s,a=l[0],i=[];for(let d=0;d<a.length;d+=1)i[d]=tl(el(l,a,d));return{c(){e=_("div"),n=_("div"),t=_("div"),o=_("select");for(let d=0;d<i.length;d+=1)i[d].c();u(t,"class","select"),u(n,"class","control"),u(e,"class","field is-grouped is-grouped-right")},m(d,g){L(d,e,g),c(e,n),c(n,t),c(t,o);for(let p=0;p<i.length;p+=1)i[p]&&i[p].m(o,null);Ee(o,l[1]),r||(s=B(o,"change",l[2]),r=!0)},p(d,[g]){if(g&1){a=d[0];let p;for(p=0;p<a.length;p+=1){const f=el(d,a,p);i[p]?i[p].p(f,g):(i[p]=tl(f),i[p].c(),i[p].m(o,null))}for(;p<i.length;p+=1)i[p].d(1);i.length=a.length}g&3&&Ee(o,d[1])},i:ce,o:ce,d(d){d&&R(e),Ge(i,d),r=!1,s()}}}function no(l,e,n){let t,o,r,s;ae(l,Ne,f=>n(5,t=f)),ae(l,ye,f=>n(6,o=f)),ae(l,Zt,f=>n(0,r=f)),ae(l,rt,f=>n(1,s=f));let a="";async function i(){try{ye.set(window.__TAURI__!==void 0),o?(console.log("Loading config from Tauri"),me("get_config").then(f=>{console.log("get_config response",f),f&&f.status==="success"&&d(f.config)}).catch(f=>console.error("Error fetching config in Tauri:",f))):(console.log("Loading config from server"),a=`${st.ServerURL}/config/`,fetch(a).then(f=>f.json()).then(f=>{console.log("Config received",f),f&&f.status==="success"&&d(f.config)}).catch(f=>console.error("Error fetching config:",f)))}catch(f){console.error("Unhandled error in loadConfig:",f)}}function d(f){var y;console.log("Updating stores from config:",f);const h={default_role:f.selected_role,...f};Ne.set(h);const m=Object.entries(f.roles).map(([b,w])=>({name:b,...w}));Zt.set(m),rt.set(f.selected_role);const $=f.roles[f.selected_role];if(console.log("Selected role settings:",$),$){const b=$.theme||"spacelab";console.log("Setting theme to:",b),ft.set(b),(y=$.kg)!=null&&y.publish?o&&me("publish_thesaurus",{roleName:f.selected_role}).then(w=>{console.log("publish_thesaurus response",w),Tt.set(w),ct.set(!0)}):ct.set(!1)}else console.warn("No role settings found for:",f.selected_role),ft.set("spacelab")}typeof window<"u"&&window.__TAURI__&&to("role_changed",f=>{console.log("Role changed event received from backend:",f.payload),d(f.payload)});async function g(){await i()}g(),console.log("Using Terraphim Server URL:",st.ServerURL);function p(f){var b;const m=f.target.value;console.log("Role change requested:",m),rt.set(m);const $=r.find(w=>w.name===m);if(!$){console.error(`No role settings found for role: ${m}.`);return}const y=$.theme||"spacelab";ft.set(y),console.log(`Theme changed to ${y}`),Ne.update(w=>(w.selected_role=m,w)),o?(me("select_role",{roleName:m}).catch(w=>console.error("Error selecting role:",w)),(b=$.kg)!=null&&b.publish?(console.log("Publishing thesaurus for role",m),me("publish_thesaurus",{roleName:m}).then(w=>{Tt.set(w),ct.set(!0)})):ct.set(!1)):fetch(`${st.ServerURL}/config/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).catch(w=>console.error("Error updating config on server:",w))}return[r,s,p,i]}class Rt extends Se{constructor(e){super(),Ce(this,e,no,lo,ke,{loadConfig:3})}get loadConfig(){return this.$$.ctx[3]}}function ll(l,e,n){const t=l.slice();return t[5]=e[n],t}function nl(l){let e,n;return e=new Nl({props:{$$slots:{default:[so]},$$scope:{ctx:l}}}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,o){const r={};o&257&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function oo(l){let e=l[5]+"",n;return{c(){n=le(e)},m(t,o){L(t,n,o)},p(t,o){o&1&&e!==(e=t[5]+"")&&ge(n,e)},d(t){t&&R(n)}}}function ol(l){let e,n,t,o;return n=new Ol({props:{rounded:!0,$$slots:{default:[oo]},$$scope:{ctx:l}}}),{c(){e=_("a"),q(n.$$.fragment),u(e,"href",t="https://terraphim.github.io/terraphim-project/#/page/"+l[5]),u(e,"target","_blank")},m(r,s){L(r,e,s),K(n,e,null),o=!0},p(r,s){const a={};s&257&&(a.$$scope={dirty:s,ctx:r}),n.$set(a),(!o||s&1&&t!==(t="https://terraphim.github.io/terraphim-project/#/page/"+r[5]))&&u(e,"href",t)},i(r){o||(T(n.$$.fragment,r),o=!0)},o(r){A(n.$$.fragment,r),o=!1},d(r){r&&R(e),G(n)}}}function so(l){let e,n,t=l[0].tags,o=[];for(let s=0;s<t.length;s+=1)o[s]=ol(ll(l,t,s));const r=s=>A(o[s],1,1,()=>{o[s]=null});return{c(){for(let s=0;s<o.length;s+=1)o[s].c();e=at()},m(s,a){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(s,a);L(s,e,a),n=!0},p(s,a){if(a&1){t=s[0].tags;let i;for(i=0;i<t.length;i+=1){const d=ll(s,t,i);o[i]?(o[i].p(d,a),T(o[i],1)):(o[i]=ol(d),o[i].c(),T(o[i],1),o[i].m(e.parentNode,e))}for(Ie(),i=t.length;i<o.length;i+=1)r(i);He()}},i(s){if(!n){for(let a=0;a<t.length;a+=1)T(o[a]);n=!0}},o(s){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)A(o[a]);n=!1},d(s){Ge(o,s),s&&R(e)}}}function ro(l){let e,n=l[0].rank+"",t;return{c(){e=le("Rank "),t=le(n)},m(o,r){L(o,e,r),L(o,t,r)},p(o,r){r&1&&n!==(n=o[0].rank+"")&&ge(t,n)},d(o){o&&R(e),o&&R(t)}}}function ao(l){let e,n;return e=new Ol({props:{rounded:!0,$$slots:{default:[ro]},$$scope:{ctx:l}}}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,o){const r={};o&257&&(r.$$scope={dirty:o,ctx:t}),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function sl(l){let e,n,t;return{c(){e=_("a"),n=_("span"),n.innerHTML='<i class="fas fa-link"></i>',u(n,"class","icon is-medium"),u(e,"href",t=l[0].url),u(e,"target","_blank"),u(e,"class","level-item"),u(e,"aria-label","URL")},m(o,r){L(o,e,r),c(e,n)},p(o,r){r&1&&t!==(t=o[0].url)&&u(e,"href",t)},d(o){o&&R(e)}}}function io(l){let e,n,t,o,r,s,a,i,d,g,p,f,h=l[0].title+"",m,$,y,b,w=(l[0].description||"No description available")+"",S,Q,Y,E,O,I,W,H,z,D,k,P,X,Z,j,ee,J,oe,ue,_e,U,F=l[0].tags&&nl(l);i=new Nl({props:{$$slots:{default:[ao]},$$scope:{ctx:l}}});let V="url"in l[0]&&sl(l);function se(v){l[3](v)}let Fe={item:l[0]};return l[1]!==void 0&&(Fe.active=l[1]),J=new Ml({props:Fe}),$e.push(()=>Oe(J,"active",se)),{c(){e=_("div"),n=_("article"),t=_("div"),o=_("div"),r=_("div"),F&&F.c(),s=C(),a=_("div"),q(i.$$.fragment),d=C(),g=_("div"),p=_("button"),f=_("h2"),m=le(h),$=C(),y=_("small"),b=le("Description: "),S=le(w),Q=C(),Y=_("br"),O=C(),I=_("div"),W=_("nav"),H=_("div"),V&&V.c(),z=C(),D=_("button"),D.innerHTML='<span class="icon is-medium"><i class="fas fa-plus" aria-hidden="true"></i></span>',k=C(),P=_("a"),X=_("span"),X.innerHTML='<i class="fas fa-code" aria-hidden="true"></i>',ee=C(),q(J.$$.fragment),u(r,"class","level-right"),u(a,"class","level-right"),u(f,"class","title svelte-1sikyk6"),u(p,"class","svelte-1sikyk6"),u(o,"class","content"),u(D,"type","button"),u(D,"class","level-item button is-ghost svelte-1sikyk6"),u(D,"aria-label","Add to favorites"),u(X,"class","icon is-medium"),u(P,"href",Z=`vscode://${encodeURIComponent(l[0].title)}.md?${encodeURIComponent(l[0].body)}`),u(P,"class","level-item"),u(P,"aria-label","Open in VSCode"),u(H,"class","level-right"),u(W,"class","level is-mobile"),u(I,"class","level-right"),u(t,"class","media-content"),u(n,"class","media"),u(e,"class","box")},m(v,N){L(v,e,N),c(e,n),c(n,t),c(t,o),c(o,r),F&&F.m(r,null),c(o,s),c(o,a),K(i,a,null),c(o,d),c(o,g),c(g,p),c(p,f),c(f,m),c(g,$),c(g,y),c(y,b),c(y,S),c(g,Q),c(g,Y),c(t,O),c(t,I),c(I,W),c(W,H),V&&V.m(H,null),c(H,z),c(H,D),c(H,k),c(H,P),c(P,X),L(v,ee,N),K(J,v,N),ue=!0,_e||(U=[B(p,"click",l[2]),B(D,"click",uo)],_e=!0)},p(v,[N]){v[0].tags?F?(F.p(v,N),N&1&&T(F,1)):(F=nl(v),F.c(),T(F,1),F.m(r,null)):F&&(Ie(),A(F,1,1,()=>{F=null}),He());const M={};N&257&&(M.$$scope={dirty:N,ctx:v}),i.$set(M),(!ue||N&1)&&h!==(h=v[0].title+"")&&ge(m,h),(!ue||N&1)&&w!==(w=(v[0].description||"No description available")+"")&&ge(S,w),"url"in v[0]?V?V.p(v,N):(V=sl(v),V.c(),V.m(H,z)):V&&(V.d(1),V=null),(!ue||N&1&&Z!==(Z=`vscode://${encodeURIComponent(v[0].title)}.md?${encodeURIComponent(v[0].body)}`))&&u(P,"href",Z);const te={};N&1&&(te.item=v[0]),!oe&&N&2&&(oe=!0,te.active=v[1],De(()=>oe=!1)),J.$set(te)},i(v){ue||(T(F),T(i.$$.fragment,v),Qe(()=>{ue&&(E||(E=yt(g,St,{},!0)),E.run(1))}),Qe(()=>{ue&&(j||(j=yt(W,St,{},!0)),j.run(1))}),T(J.$$.fragment,v),ue=!0)},o(v){A(F),A(i.$$.fragment,v),E||(E=yt(g,St,{},!1)),E.run(0),j||(j=yt(W,St,{},!1)),j.run(0),A(J.$$.fragment,v),ue=!1},d(v){v&&R(e),F&&F.d(),G(i),v&&E&&E.end(),V&&V.d(),v&&j&&j.end(),v&&R(ee),G(J,v),_e=!1,Te(U)}}}const uo=()=>{};function co(l,e,n){let t;ae(l,rt,i=>n(4,t=i));let{document:o}=e,r=!1;const s=()=>{n(1,r=!0)};Rt[t]!==void 0&&(console.log("Have attribute",Rt[t]),Rt[t].hasOwnProperty("enableLogseq")?console.log("enable logseq True"):console.log("Didn't make it"));function a(i){r=i,n(1,r)}return l.$$set=i=>{"document"in i&&n(0,o=i.document)},[o,r,s,a]}class fo extends Se{constructor(e){super(),Ce(this,e,co,io,ke,{document:0})}}const po="/assets/terraphim_gray.png";function rl(l,e,n){const t=l.slice();return t[19]=e[n],t}function al(l,e,n){const t=l.slice();return t[22]=e[n],t[24]=n,t}function il(l){let e,n=l[2],t=[];for(let o=0;o<n.length;o+=1)t[o]=ul(al(l,n,o));return{c(){e=_("ul");for(let o=0;o<t.length;o+=1)t[o].c();u(e,"class","suggestions svelte-13t09eu")},m(o,r){L(o,e,r);for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(e,null)},p(o,r){if(r&524){n=o[2];let s;for(s=0;s<n.length;s+=1){const a=al(o,n,s);t[s]?t[s].p(a,r):(t[s]=ul(a),t[s].c(),t[s].m(e,null))}for(;s<t.length;s+=1)t[s].d(1);t.length=n.length}},d(o){o&&R(e),Ge(t,o)}}}function ul(l){let e,n=l[22]+"",t,o,r,s,a,i;function d(){return l[13](l[22])}function g(...p){return l[14](l[22],...p)}return{c(){e=_("li"),t=le(n),o=C(),u(e,"tabindex","0"),u(e,"role","option"),u(e,"aria-selected",r=l[24]===l[3]),u(e,"aria-label",s=`Apply suggestion: ${l[22]}`),u(e,"class","svelte-13t09eu"),Lt(e,"active",l[24]===l[3])},m(p,f){L(p,e,f),c(e,t),c(e,o),a||(i=[B(e,"click",d),B(e,"keydown",g)],a=!0)},p(p,f){l=p,f&4&&n!==(n=l[22]+"")&&ge(t,n),f&8&&r!==(r=l[24]===l[3])&&u(e,"aria-selected",r),f&4&&s!==(s=`Apply suggestion: ${l[22]}`)&&u(e,"aria-label",s),f&8&&Lt(e,"active",l[24]===l[3])},d(p){p&&R(e),a=!1,Te(i)}}}function _o(l){let e,n,t,o,r;function s(d){l[12](d)}let a={type:"search",placeholder:l[6]?`Search over Knowledge graph for ${l[4]}`:"Search",icon:"search",expanded:!0,autofocus:!0};l[5]!==void 0&&(a.value=l[5]),n=new pt({props:a}),$e.push(()=>Oe(n,"value",s)),n.$on("click",l[10]),n.$on("submit",l[10]),n.$on("keydown",l[8]),n.$on("input",l[7]);let i=l[2].length>0&&il(l);return{c(){e=_("div"),q(n.$$.fragment),o=C(),i&&i.c(),u(e,"class","input-wrapper svelte-13t09eu")},m(d,g){L(d,e,g),K(n,e,null),c(e,o),i&&i.m(e,null),r=!0},p(d,g){const p={};g&80&&(p.placeholder=d[6]?`Search over Knowledge graph for ${d[4]}`:"Search"),!t&&g&32&&(t=!0,p.value=d[5],De(()=>t=!1)),n.$set(p),d[2].length>0?i?i.p(d,g):(i=il(d),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},i(d){r||(T(n.$$.fragment,d),r=!0)},o(d){A(n.$$.fragment,d),r=!1},d(d){d&&R(e),G(n),i&&i.d()}}}function ho(l){let e,n,t,o,r,s;return{c(){e=_("section"),n=_("div"),t=_("img"),r=C(),s=_("p"),s.textContent="I am Terraphim, your personal assistant.",Xl(t.src,o=po)||u(t,"src",o),u(t,"alt","Terraphim Logo"),u(t,"class","svelte-13t09eu"),u(n,"class","content has-text-grey has-text-centered svelte-13t09eu"),u(e,"class","section")},m(a,i){L(a,e,i),c(e,n),c(n,t),c(n,r),c(n,s)},p:ce,i:ce,o:ce,d(a){a&&R(e)}}}function mo(l){let e,n,t=l[0],o=[];for(let s=0;s<t.length;s+=1)o[s]=cl(rl(l,t,s));const r=s=>A(o[s],1,1,()=>{o[s]=null});return{c(){for(let s=0;s<o.length;s+=1)o[s].c();e=at()},m(s,a){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(s,a);L(s,e,a),n=!0},p(s,a){if(a&1){t=s[0];let i;for(i=0;i<t.length;i+=1){const d=rl(s,t,i);o[i]?(o[i].p(d,a),T(o[i],1)):(o[i]=cl(d),o[i].c(),T(o[i],1),o[i].m(e.parentNode,e))}for(Ie(),i=t.length;i<o.length;i+=1)r(i);He()}},i(s){if(!n){for(let a=0;a<t.length;a+=1)T(o[a]);n=!0}},o(s){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)A(o[a]);n=!1},d(s){Ge(o,s),s&&R(e)}}}function go(l){let e,n;return{c(){e=_("p"),n=le(l[1]),u(e,"class","error svelte-13t09eu")},m(t,o){L(t,e,o),c(e,n)},p(t,o){o&2&&ge(n,t[1])},i:ce,o:ce,d(t){t&&R(e)}}}function cl(l){let e,n;return e=new fo({props:{document:l[19]}}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},p(t,o){const r={};o&1&&(r.document=t[19]),e.$set(r)},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function vo(l){let e,n,t,o,r,s,a,i,d;n=new Ke({props:{$$slots:{default:[_o]},$$scope:{ctx:l}}});const g=[go,mo,ho],p=[];function f(h,m){return h[1]?0:h[0].length?1:2}return o=f(l),r=p[o]=g[o](l),{c(){e=_("form"),q(n.$$.fragment),t=C(),r.c(),s=at()},m(h,m){L(h,e,m),K(n,e,null),L(h,t,m),p[o].m(h,m),L(h,s,m),a=!0,i||(d=B(e,"submit",Zl(l[10])),i=!0)},p(h,[m]){const $={};m&33554556&&($.$$scope={dirty:m,ctx:h}),n.$set($);let y=o;o=f(h),o===y?p[o].p(h,m):(Ie(),A(p[y],1,1,()=>{p[y]=null}),He(),r=p[o],r?r.p(h,m):(r=p[o]=g[o](h),r.c()),T(r,1),r.m(s.parentNode,s))},i(h){a||(T(n.$$.fragment,h),T(r),a=!0)},o(h){A(n.$$.fragment,h),A(r),a=!1},d(h){h&&R(e),G(n),h&&R(t),p[o].d(h),h&&R(s),i=!1,d()}}}function bo(l,e,n){let t,o,r,s,a,i,d;ae(l,$n,E=>n(16,o=E)),ae(l,rt,E=>n(4,r=E)),ae(l,Dt,E=>n(5,s=E)),ae(l,ye,E=>n(17,a=E)),ae(l,Tt,E=>n(11,i=E)),ae(l,ct,E=>n(6,d=E));let g=[],p=null,f=[],h=-1;function m(E){const O=E.trim().toLowerCase();return O.length===0?[]:t.filter(([W])=>W.toLowerCase().includes(O)).map(([W])=>W).slice(0,5)}function $(E){const O=E.target;if(!O||O.selectionStart==null)return;const I=O.selectionStart,H=s.slice(0,I).split(/\s+/),z=H[H.length-1];n(2,f=m(z)),n(3,h=-1)}function y(E){f.length!==0&&(E.key==="ArrowDown"?(E.preventDefault(),n(3,h=(h+1)%f.length)):E.key==="ArrowUp"?(E.preventDefault(),n(3,h=(h-1+f.length)%f.length)):(E.key==="Enter"||E.key==="Tab")&&h!==-1&&(E.preventDefault(),b(f[h])))}function b(E){var D;const O=document.querySelector('input[type="search"]'),I=(O==null?void 0:O.selectionStart)??0,W=s.slice(0,I),H=s.slice(I),z=W.split(/\s+/);z[z.length-1]=E,Ql(Dt,s=[...z,H].join(" "),s),(D=O==null?void 0:O.setSelectionRange)==null||D.call(O,I+E.length,I+E.length),n(2,f=[]),n(3,h=-1)}async function w(){if(n(1,p=null),a)try{const E=await me("search",{searchQuery:{search_term:s,skip:0,limit:10,role:r}});E.status==="success"?(n(0,g=E.results),console.log("Response results"),console.log(g)):(n(1,p=`Search failed: ${E.status}`),console.error("Search failed:",E))}catch(E){n(1,p=`Error in Tauri search: ${E}`),console.error("Error in Tauri search:",E)}else{if(!s.trim())return;const E=JSON.stringify({search_term:s,skip:0,limit:10,role:r});try{const O=await fetch(o,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:E}),I=await O.json();if(!O.ok)throw new Error(`HTTP error! Status: ${O.status}`);n(0,g=I.results)}catch(O){console.error("Error fetching data:",O),n(1,p=`Error fetching data: ${O}`)}}}function S(E){s=E,Dt.set(s)}const Q=E=>b(E),Y=(E,O)=>{(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),b(E))};return l.$$.update=()=>{l.$$.dirty&2048&&(t=Object.entries(i))},[g,p,f,h,r,s,d,$,y,b,w,i,S,Q,Y]}class $o extends Se{constructor(e){super(),Ce(this,e,bo,vo,ke,{})}}function fl(l,e,n){const t=l.slice();return t[44]=e[n],t[45]=e,t[46]=n,t}function pl(l,e,n){const t=l.slice();return t[47]=e[n],t[48]=e,t[49]=n,t}function _l(l,e,n){const t=l.slice();return t[50]=e[n][0],t[51]=e[n][1],t[52]=e,t[53]=n,t}function dl(l,e,n){const t=l.slice();return t[41]=e[n],t}function ko(l){let e,n,t,o=JSON.stringify(l[1],null,2)+"",r;return{c(){e=_("h4"),e.textContent="Review",n=C(),t=_("pre"),r=le(o),u(e,"class","title is-5"),Ze(t,"max-height","300px"),Ze(t,"overflow","auto")},m(s,a){L(s,e,a),L(s,n,a),L(s,t,a),c(t,r)},p(s,a){a[0]&2&&o!==(o=JSON.stringify(s[1],null,2)+"")&&ge(r,o)},d(s){s&&R(e),s&&R(n),s&&R(t)}}}function wo(l){let e,n,t=[],o=new Map,r,s,a,i,d=l[1].roles;const g=p=>p[44].name;for(let p=0;p<d.length;p+=1){let f=fl(l,d,p),h=g(f);o.set(h,t[p]=bl(h,f))}return{c(){e=_("h4"),e.textContent="Roles",n=C();for(let p=0;p<t.length;p+=1)t[p].c();r=C(),s=_("button"),s.textContent="Add Role",u(e,"class","title is-5"),u(s,"class","button is-link is-light")},m(p,f){L(p,e,f),L(p,n,f);for(let h=0;h<t.length;h+=1)t[h]&&t[h].m(p,f);L(p,r,f),L(p,s,f),a||(i=B(s,"click",l[5]),a=!0)},p(p,f){f[0]&4034&&(d=p[1].roles,t=xl(t,f,g,1,p,d,o,r.parentNode,en,bl,r,fl))},d(p){p&&R(e),p&&R(n);for(let f=0;f<t.length;f+=1)t[f].d(p);p&&R(r),p&&R(s),a=!1,i()}}}function yo(l){let e,n,t,o,r,s,a,i,d,g,p,f,h,m,$,y,b,w,S,Q,Y,E,O,I,W,H,z,D,k,P,X=l[1].roles,Z=[];for(let j=0;j<X.length;j+=1)Z[j]=$l(dl(l,X,j));return{c(){e=_("div"),n=_("label"),n.textContent="Configuration ID",t=C(),o=_("div"),r=_("div"),s=_("select"),a=_("option"),a.textContent="Desktop",i=_("option"),i.textContent="Server",d=_("option"),d.textContent="Embedded",g=C(),p=_("div"),f=_("label"),f.textContent="Global shortcut",h=C(),m=_("div"),$=_("input"),y=C(),b=_("div"),w=_("label"),w.textContent="Default theme",S=C(),Q=_("div"),Y=_("input"),E=C(),O=_("div"),I=_("label"),I.textContent="Default Role",W=C(),H=_("div"),z=_("div"),D=_("select");for(let j=0;j<Z.length;j+=1)Z[j].c();u(n,"class","label"),u(n,"for","config-id"),a.__value="Desktop",a.value=a.__value,i.__value="Server",i.value=i.__value,d.__value="Embedded",d.value=d.__value,u(s,"id","config-id"),l[1].id===void 0&&Qe(()=>l[13].call(s)),u(r,"class","select"),u(o,"class","control"),u(e,"class","field"),u(f,"class","label"),u(f,"for","global-shortcut"),u($,"class","input"),u($,"id","global-shortcut"),u($,"type","text"),u(m,"class","control"),u(p,"class","field"),u(w,"class","label"),u(w,"for","default-theme"),u(Y,"class","input"),u(Y,"id","default-theme"),u(Y,"type","text"),u(Q,"class","control"),u(b,"class","field"),u(I,"class","label"),u(I,"for","default-role"),u(D,"id","default-role"),l[1].default_role===void 0&&Qe(()=>l[16].call(D)),u(z,"class","select"),u(H,"class","control"),u(O,"class","field")},m(j,ee){L(j,e,ee),c(e,n),c(e,t),c(e,o),c(o,r),c(r,s),c(s,a),c(s,i),c(s,d),Ee(s,l[1].id,!0),L(j,g,ee),L(j,p,ee),c(p,f),c(p,h),c(p,m),c(m,$),ie($,l[1].global_shortcut),L(j,y,ee),L(j,b,ee),c(b,w),c(b,S),c(b,Q),c(Q,Y),ie(Y,l[1].default_theme),L(j,E,ee),L(j,O,ee),c(O,I),c(O,W),c(O,H),c(H,z),c(z,D);for(let J=0;J<Z.length;J+=1)Z[J]&&Z[J].m(D,null);Ee(D,l[1].default_role,!0),k||(P=[B(s,"change",l[13]),B($,"input",l[14]),B(Y,"input",l[15]),B(D,"change",l[16])],k=!0)},p(j,ee){if(ee[0]&2&&Ee(s,j[1].id),ee[0]&2&&$.value!==j[1].global_shortcut&&ie($,j[1].global_shortcut),ee[0]&2&&Y.value!==j[1].default_theme&&ie(Y,j[1].default_theme),ee[0]&2){X=j[1].roles;let J;for(J=0;J<X.length;J+=1){const oe=dl(j,X,J);Z[J]?Z[J].p(oe,ee):(Z[J]=$l(oe),Z[J].c(),Z[J].m(D,null))}for(;J<Z.length;J+=1)Z[J].d(1);Z.length=X.length}ee[0]&2&&Ee(D,j[1].default_role)},d(j){j&&R(e),j&&R(g),j&&R(p),j&&R(y),j&&R(b),j&&R(E),j&&R(O),Ge(Z,j),k=!1,Te(P)}}}function So(l){let e;return{c(){e=le("Directory Path")},m(n,t){L(n,e,t)},d(n){n&&R(e)}}}function Co(l){let e;return{c(){e=le("Server URL")},m(n,t){L(n,e,t)},d(n){n&&R(e)}}}function hl(l){let e,n,t,o,r,s,a,i,d,g,p,f;function h(){l[23].call(a,l[46],l[49])}return{c(){e=_("div"),n=_("label"),t=le("Atomic Server Secret"),r=C(),s=_("div"),a=_("input"),d=C(),g=_("p"),g.textContent="Leave empty for anonymous access",u(n,"class","label"),u(n,"for",o=`haystack-secret-${l[46]}-${l[49]}`),u(a,"class","input"),u(a,"id",i=`haystack-secret-${l[46]}-${l[49]}`),u(a,"type","password"),u(a,"placeholder","Base64 encoded secret (optional)"),u(s,"class","control"),u(g,"class","help"),u(e,"class","field")},m(m,$){L(m,e,$),c(e,n),c(n,t),c(e,r),c(e,s),c(s,a),ie(a,l[1].roles[l[46]].haystacks[l[49]].atomic_server_secret),c(e,d),c(e,g),p||(f=B(a,"input",h),p=!0)},p(m,$){l=m,$[0]&2&&o!==(o=`haystack-secret-${l[46]}-${l[49]}`)&&u(n,"for",o),$[0]&2&&i!==(i=`haystack-secret-${l[46]}-${l[49]}`)&&u(a,"id",i),$[0]&2&&a.value!==l[1].roles[l[46]].haystacks[l[49]].atomic_server_secret&&ie(a,l[1].roles[l[46]].haystacks[l[49]].atomic_server_secret)},d(m){m&&R(e),p=!1,f()}}}function ml(l){let e,n,t,o,r,s,a,i,d,g,p,f,h,m,$,y,b,w=Object.entries(l[1].roles[l[46]].haystacks[l[49]].extra_parameters||{}),S=[];for(let O=0;O<w.length;O+=1)S[O]=gl(_l(l,w,O));function Q(){return l[27](l[46],l[49])}function Y(){return l[28](l[46],l[49])}function E(){return l[29](l[46],l[49])}return{c(){e=_("div"),n=_("label"),n.textContent="Extra Parameters (for filtering)",t=C();for(let O=0;O<S.length;O+=1)S[O].c();o=C(),r=_("div"),s=_("div"),a=_("button"),a.textContent="+ Tag Filter",i=C(),d=_("div"),g=_("button"),g.textContent="+ Max Results",p=C(),f=_("div"),h=_("button"),h.textContent="+ Custom Parameter",m=C(),$=_("p"),$.innerHTML=`Common parameters: <code>tag</code> (e.g., &quot;#rust&quot;), <code>glob</code> (e.g., &quot;*.md&quot;), 
                  <code>max_count</code> (e.g., &quot;10&quot;), <code>context</code> (e.g., &quot;5&quot;)`,u(n,"class","label"),u(a,"class","button is-small is-link is-light"),u(s,"class","control"),u(g,"class","button is-small is-link is-light"),u(d,"class","control"),u(h,"class","button is-small is-link is-light"),u(f,"class","control"),u(r,"class","field is-grouped"),u($,"class","help"),u(e,"class","field")},m(O,I){L(O,e,I),c(e,n),c(e,t);for(let W=0;W<S.length;W+=1)S[W]&&S[W].m(e,null);c(e,o),c(e,r),c(r,s),c(s,a),c(r,i),c(r,d),c(d,g),c(r,p),c(r,f),c(f,h),c(e,m),c(e,$),y||(b=[B(a,"click",Q),B(g,"click",Y),B(h,"click",E)],y=!0)},p(O,I){if(l=O,I[0]&3074){w=Object.entries(l[1].roles[l[46]].haystacks[l[49]].extra_parameters||{});let W;for(W=0;W<w.length;W+=1){const H=_l(l,w,W);S[W]?S[W].p(H,I):(S[W]=gl(H),S[W].c(),S[W].m(e,o))}for(;W<S.length;W+=1)S[W].d(1);S.length=w.length}},d(O){O&&R(e),Ge(S,O),y=!1,Te(b)}}}function gl(l){let e,n,t,o,r,s,a,i,d,g,p,f,h;function m(...b){return l[24](l[46],l[49],l[50],...b)}function $(){l[25].call(a,l[46],l[49],l[50])}function y(){return l[26](l[46],l[49],l[50])}return{c(){e=_("div"),n=_("div"),t=_("input"),r=C(),s=_("div"),a=_("input"),i=C(),d=_("div"),g=_("button"),g.textContent="×",p=C(),u(t,"class","input"),u(t,"type","text"),u(t,"placeholder","Parameter name"),t.value=o=l[50],u(n,"class","control"),u(a,"class","input"),u(a,"type","text"),u(a,"placeholder","Parameter value"),u(s,"class","control is-expanded"),u(g,"class","button is-small is-danger"),u(d,"class","control"),u(e,"class","field is-grouped")},m(b,w){L(b,e,w),c(e,n),c(n,t),c(e,r),c(e,s),c(s,a),ie(a,l[1].roles[l[46]].haystacks[l[49]].extra_parameters[l[50]]),c(e,i),c(e,d),c(d,g),c(e,p),f||(h=[B(t,"blur",m),B(a,"input",$),B(g,"click",y)],f=!0)},p(b,w){l=b,w[0]&2&&o!==(o=l[50])&&t.value!==o&&(t.value=o),w[0]&2&&a.value!==l[1].roles[l[46]].haystacks[l[49]].extra_parameters[l[50]]&&ie(a,l[1].roles[l[46]].haystacks[l[49]].extra_parameters[l[50]])},d(b){b&&R(e),f=!1,Te(h)}}}function vl(l){let e,n,t,o,r,s,a,i,d,g,p,f,h,m,$,y,b,w,S,Q,Y,E,O,I,W,H,z,D,k,P,X,Z,j,ee,J;function oe(){l[21].call(d,l[46],l[49])}function ue(N,M){return N[1].roles[N[46]].haystacks[N[49]].service==="Atomic"?Co:So}let _e=ue(l),U=_e(l);function F(){l[22].call(S,l[46],l[49])}let V=l[1].roles[l[46]].haystacks[l[49]].service==="Atomic"&&hl(l),se=l[1].roles[l[46]].haystacks[l[49]].service==="Ripgrep"&&ml(l);function Fe(){l[30].call(z,l[46],l[49])}function v(){return l[31](l[46],l[49])}return{c(){e=_("div"),n=_("div"),t=_("label"),o=le("Service Type"),s=C(),a=_("div"),i=_("div"),d=_("select"),g=_("option"),g.textContent="Ripgrep (File Search)",p=_("option"),p.textContent="Atomic Server",h=C(),m=_("div"),$=_("label"),U.c(),b=C(),w=_("div"),S=_("input"),E=C(),V&&V.c(),O=C(),se&&se.c(),I=C(),W=_("div"),H=_("label"),z=_("input"),k=le(`
                 Read-only`),X=C(),Z=_("div"),j=_("button"),j.textContent="Remove Haystack",u(t,"class","label"),u(t,"for",r=`haystack-service-${l[46]}-${l[49]}`),g.__value="Ripgrep",g.value=g.__value,p.__value="Atomic",p.value=p.__value,u(d,"id",f=`haystack-service-${l[46]}-${l[49]}`),l[1].roles[l[46]].haystacks[l[49]].service===void 0&&Qe(oe),u(i,"class","select"),u(a,"class","control"),u(n,"class","field"),u($,"class","label"),u($,"for",y=`haystack-path-${l[46]}-${l[49]}`),u(S,"class","input"),u(S,"id",Q=`haystack-path-${l[46]}-${l[49]}`),u(S,"type","text"),u(S,"placeholder",Y=l[1].roles[l[46]].haystacks[l[49]].service==="Atomic"?"https://localhost:9883":"/path/to/documents"),u(w,"class","control"),u(m,"class","field"),u(z,"id",D=`haystack-readonly-${l[46]}-${l[49]}`),u(z,"type","checkbox"),u(H,"class","checkbox"),u(H,"for",P=`haystack-readonly-${l[46]}-${l[49]}`),u(W,"class","field"),u(j,"class","button is-small is-danger"),u(Z,"class","field"),u(e,"class","box is-light")},m(N,M){L(N,e,M),c(e,n),c(n,t),c(t,o),c(n,s),c(n,a),c(a,i),c(i,d),c(d,g),c(d,p),Ee(d,l[1].roles[l[46]].haystacks[l[49]].service,!0),c(e,h),c(e,m),c(m,$),U.m($,null),c(m,b),c(m,w),c(w,S),ie(S,l[1].roles[l[46]].haystacks[l[49]].path),c(e,E),V&&V.m(e,null),c(e,O),se&&se.m(e,null),c(e,I),c(e,W),c(W,H),c(H,z),z.checked=l[1].roles[l[46]].haystacks[l[49]].read_only,c(H,k),c(e,X),c(e,Z),c(Z,j),ee||(J=[B(d,"change",oe),B(S,"input",F),B(z,"change",Fe),B(j,"click",v)],ee=!0)},p(N,M){l=N,M[0]&2&&r!==(r=`haystack-service-${l[46]}-${l[49]}`)&&u(t,"for",r),M[0]&2&&f!==(f=`haystack-service-${l[46]}-${l[49]}`)&&u(d,"id",f),M[0]&2&&Ee(d,l[1].roles[l[46]].haystacks[l[49]].service),_e!==(_e=ue(l))&&(U.d(1),U=_e(l),U&&(U.c(),U.m($,null))),M[0]&2&&y!==(y=`haystack-path-${l[46]}-${l[49]}`)&&u($,"for",y),M[0]&2&&Q!==(Q=`haystack-path-${l[46]}-${l[49]}`)&&u(S,"id",Q),M[0]&2&&Y!==(Y=l[1].roles[l[46]].haystacks[l[49]].service==="Atomic"?"https://localhost:9883":"/path/to/documents")&&u(S,"placeholder",Y),M[0]&2&&S.value!==l[1].roles[l[46]].haystacks[l[49]].path&&ie(S,l[1].roles[l[46]].haystacks[l[49]].path),l[1].roles[l[46]].haystacks[l[49]].service==="Atomic"?V?V.p(l,M):(V=hl(l),V.c(),V.m(e,O)):V&&(V.d(1),V=null),l[1].roles[l[46]].haystacks[l[49]].service==="Ripgrep"?se?se.p(l,M):(se=ml(l),se.c(),se.m(e,I)):se&&(se.d(1),se=null),M[0]&2&&D!==(D=`haystack-readonly-${l[46]}-${l[49]}`)&&u(z,"id",D),M[0]&2&&(z.checked=l[1].roles[l[46]].haystacks[l[49]].read_only),M[0]&2&&P!==(P=`haystack-readonly-${l[46]}-${l[49]}`)&&u(H,"for",P)},d(N){N&&R(e),U.d(),V&&V.d(),se&&se.d(),ee=!1,Te(J)}}}function bl(l,e){let n,t,o,r,s,a,i,d,g,p,f,h,m,$,y,b,w,S,Q,Y,E,O,I,W,H,z,D,k,P,X,Z,j,ee,J,oe,ue,_e,U,F,V,se,Fe,v,N,M,te,re,x,Be,ze,fe,Re,ve,Ae,Me,it,Je,Ue,_t,be,dt,jt,ht,Xe,xe,Pt,mt,Wt,gt,Le,et,tt,vt,It,lt,qe,je,bt,Ht,$t,Ft,Ve,Pe,kt,zt,wt,qt,Kt,Gt,ut,Nt,Bt;function Pl(){e[17].call(d,e[46])}function Wl(){e[18].call(w,e[46])}function Il(){e[19].call(z,e[46])}function Hl(){e[20].call(oe,e[46])}let nt=e[44].haystacks,de=[];for(let he=0;he<nt.length;he+=1)de[he]=vl(pl(e,nt,he));function Fl(){return e[32](e[46])}function zl(){e[33].call(fe,e[46])}function ql(){e[34].call(be,e[46])}function Jt(){e[35].call(Le,e[46])}function Kl(){e[36].call(je,e[46])}function Gl(){e[37].call(Pe,e[46])}function Bl(){return e[38](e[46])}return{key:l,first:null,c(){n=_("div"),t=_("div"),o=_("label"),r=le("Role name"),a=C(),i=_("div"),d=_("input"),p=C(),f=_("div"),h=_("label"),m=le("Short name"),y=C(),b=_("div"),w=_("input"),Q=C(),Y=_("div"),E=_("label"),O=le("Theme"),W=C(),H=_("div"),z=_("input"),k=C(),P=_("div"),X=_("label"),Z=le("Relevance function"),ee=C(),J=_("div"),oe=_("input"),_e=C(),U=_("h5"),U.textContent="Haystacks",F=C();for(let he=0;he<de.length;he+=1)de[he].c();V=C(),se=_("button"),se.textContent="Add Haystack",Fe=C(),v=_("h5"),v.textContent="Knowledge Graph",N=C(),M=_("div"),te=_("label"),re=le("Remote automata URL"),Be=C(),ze=_("div"),fe=_("input"),ve=C(),Ae=_("div"),Me=_("label"),it=le("Local KG path"),Ue=C(),_t=_("div"),be=_("input"),jt=C(),ht=_("div"),Xe=_("div"),xe=_("label"),Pt=le("Local KG type"),Wt=C(),gt=_("div"),Le=_("select"),et=_("option"),et.textContent="markdown",tt=_("option"),tt.textContent="json",It=C(),lt=_("div"),qe=_("label"),je=_("input"),Ht=le(`
             Public`),Ft=C(),Ve=_("label"),Pe=_("input"),zt=le(`
             Publish`),qt=C(),Kt=_("hr"),Gt=C(),ut=_("button"),ut.textContent="Remove Role",u(o,"class","label"),u(o,"for",s=`role-name-${e[46]}`),u(d,"class","input"),u(d,"id",g=`role-name-${e[46]}`),u(d,"type","text"),u(i,"class","control"),u(t,"class","field"),u(h,"class","label"),u(h,"for",$=`role-shortname-${e[46]}`),u(w,"class","input"),u(w,"id",S=`role-shortname-${e[46]}`),u(w,"type","text"),u(b,"class","control"),u(f,"class","field"),u(E,"class","label"),u(E,"for",I=`role-theme-${e[46]}`),u(z,"class","input"),u(z,"id",D=`role-theme-${e[46]}`),u(z,"type","text"),u(H,"class","control"),u(Y,"class","field"),u(X,"class","label"),u(X,"for",j=`role-relevance-${e[46]}`),u(oe,"class","input"),u(oe,"id",ue=`role-relevance-${e[46]}`),u(oe,"type","text"),u(J,"class","control"),u(P,"class","field"),u(U,"class","title is-6"),u(se,"class","button is-small"),u(v,"class","title is-6"),u(te,"class","label"),u(te,"for",x=`kg-url-${e[46]}`),u(fe,"class","input"),u(fe,"id",Re=`kg-url-${e[46]}`),u(fe,"type","text"),u(fe,"placeholder","https://example.com/thesaurus.json"),u(ze,"class","control"),u(M,"class","field"),u(Me,"class","label"),u(Me,"for",Je=`kg-local-path-${e[46]}`),u(be,"class","input"),u(be,"id",dt=`kg-local-path-${e[46]}`),u(be,"type","text"),u(be,"placeholder","/path/to/markdown"),u(_t,"class","control"),u(Ae,"class","field"),u(xe,"class","label"),u(xe,"for",mt=`kg-local-type-${e[46]}`),et.__value="markdown",et.value=et.__value,tt.__value="json",tt.value=tt.__value,u(Le,"id",vt=`kg-local-type-${e[46]}`),e[1].roles[e[46]].kg.local_type===void 0&&Qe(Jt),u(gt,"class","select"),u(Xe,"class","control"),u(ht,"class","field is-grouped"),u(je,"id",bt=`kg-public-${e[46]}`),u(je,"type","checkbox"),u(qe,"class","checkbox"),u(qe,"for",$t=`kg-public-${e[46]}`),Ze(qe,"margin-right","1rem"),u(Pe,"id",kt=`kg-publish-${e[46]}`),u(Pe,"type","checkbox"),u(Ve,"class","checkbox"),u(Ve,"for",wt=`kg-publish-${e[46]}`),u(lt,"class","field is-grouped"),u(ut,"class","button is-small is-danger"),u(n,"class","box"),this.first=n},m(he,ne){L(he,n,ne),c(n,t),c(t,o),c(o,r),c(t,a),c(t,i),c(i,d),ie(d,e[1].roles[e[46]].name),c(n,p),c(n,f),c(f,h),c(h,m),c(f,y),c(f,b),c(b,w),ie(w,e[1].roles[e[46]].shortname),c(n,Q),c(n,Y),c(Y,E),c(E,O),c(Y,W),c(Y,H),c(H,z),ie(z,e[1].roles[e[46]].theme),c(n,k),c(n,P),c(P,X),c(X,Z),c(P,ee),c(P,J),c(J,oe),ie(oe,e[1].roles[e[46]].relevance_function),c(n,_e),c(n,U),c(n,F);for(let pe=0;pe<de.length;pe+=1)de[pe]&&de[pe].m(n,null);c(n,V),c(n,se),c(n,Fe),c(n,v),c(n,N),c(n,M),c(M,te),c(te,re),c(M,Be),c(M,ze),c(ze,fe),ie(fe,e[1].roles[e[46]].kg.url),c(n,ve),c(n,Ae),c(Ae,Me),c(Me,it),c(Ae,Ue),c(Ae,_t),c(_t,be),ie(be,e[1].roles[e[46]].kg.local_path),c(n,jt),c(n,ht),c(ht,Xe),c(Xe,xe),c(xe,Pt),c(Xe,Wt),c(Xe,gt),c(gt,Le),c(Le,et),c(Le,tt),Ee(Le,e[1].roles[e[46]].kg.local_type,!0),c(n,It),c(n,lt),c(lt,qe),c(qe,je),je.checked=e[1].roles[e[46]].kg.public,c(qe,Ht),c(lt,Ft),c(lt,Ve),c(Ve,Pe),Pe.checked=e[1].roles[e[46]].kg.publish,c(Ve,zt),c(n,qt),c(n,Kt),c(n,Gt),c(n,ut),Nt||(Bt=[B(d,"input",Pl),B(w,"input",Wl),B(z,"input",Il),B(oe,"input",Hl),B(se,"click",Fl),B(fe,"input",zl),B(be,"input",ql),B(Le,"change",Jt),B(je,"change",Kl),B(Pe,"change",Gl),B(ut,"click",Bl)],Nt=!0)},p(he,ne){if(e=he,ne[0]&2&&s!==(s=`role-name-${e[46]}`)&&u(o,"for",s),ne[0]&2&&g!==(g=`role-name-${e[46]}`)&&u(d,"id",g),ne[0]&2&&d.value!==e[1].roles[e[46]].name&&ie(d,e[1].roles[e[46]].name),ne[0]&2&&$!==($=`role-shortname-${e[46]}`)&&u(h,"for",$),ne[0]&2&&S!==(S=`role-shortname-${e[46]}`)&&u(w,"id",S),ne[0]&2&&w.value!==e[1].roles[e[46]].shortname&&ie(w,e[1].roles[e[46]].shortname),ne[0]&2&&I!==(I=`role-theme-${e[46]}`)&&u(E,"for",I),ne[0]&2&&D!==(D=`role-theme-${e[46]}`)&&u(z,"id",D),ne[0]&2&&z.value!==e[1].roles[e[46]].theme&&ie(z,e[1].roles[e[46]].theme),ne[0]&2&&j!==(j=`role-relevance-${e[46]}`)&&u(X,"for",j),ne[0]&2&&ue!==(ue=`role-relevance-${e[46]}`)&&u(oe,"id",ue),ne[0]&2&&oe.value!==e[1].roles[e[46]].relevance_function&&ie(oe,e[1].roles[e[46]].relevance_function),ne[0]&3842){nt=e[44].haystacks;let pe;for(pe=0;pe<nt.length;pe+=1){const Vt=pl(e,nt,pe);de[pe]?de[pe].p(Vt,ne):(de[pe]=vl(Vt),de[pe].c(),de[pe].m(n,V))}for(;pe<de.length;pe+=1)de[pe].d(1);de.length=nt.length}ne[0]&2&&x!==(x=`kg-url-${e[46]}`)&&u(te,"for",x),ne[0]&2&&Re!==(Re=`kg-url-${e[46]}`)&&u(fe,"id",Re),ne[0]&2&&fe.value!==e[1].roles[e[46]].kg.url&&ie(fe,e[1].roles[e[46]].kg.url),ne[0]&2&&Je!==(Je=`kg-local-path-${e[46]}`)&&u(Me,"for",Je),ne[0]&2&&dt!==(dt=`kg-local-path-${e[46]}`)&&u(be,"id",dt),ne[0]&2&&be.value!==e[1].roles[e[46]].kg.local_path&&ie(be,e[1].roles[e[46]].kg.local_path),ne[0]&2&&mt!==(mt=`kg-local-type-${e[46]}`)&&u(xe,"for",mt),ne[0]&2&&vt!==(vt=`kg-local-type-${e[46]}`)&&u(Le,"id",vt),ne[0]&2&&Ee(Le,e[1].roles[e[46]].kg.local_type),ne[0]&2&&bt!==(bt=`kg-public-${e[46]}`)&&u(je,"id",bt),ne[0]&2&&(je.checked=e[1].roles[e[46]].kg.public),ne[0]&2&&$t!==($t=`kg-public-${e[46]}`)&&u(qe,"for",$t),ne[0]&2&&kt!==(kt=`kg-publish-${e[46]}`)&&u(Pe,"id",kt),ne[0]&2&&(Pe.checked=e[1].roles[e[46]].kg.publish),ne[0]&2&&wt!==(wt=`kg-publish-${e[46]}`)&&u(Ve,"for",wt)},d(he){he&&R(n),Ge(de,he),Nt=!1,Te(Bt)}}}function $l(l){let e,n=l[41].name+"",t,o;return{c(){e=_("option"),t=le(n),e.__value=o=l[41].name,e.value=e.__value},m(r,s){L(r,e,s),c(e,t)},p(r,s){s[0]&2&&n!==(n=r[41].name+"")&&ge(t,n),s[0]&2&&o!==(o=r[41].name)&&(e.__value=o,e.value=e.__value)},d(r){r&&R(e)}}}function kl(l){let e,n,t;return{c(){e=_("button"),e.textContent="Back",u(e,"class","button")},m(o,r){L(o,e,r),n||(t=B(e,"click",l[4]),n=!0)},p:ce,d(o){o&&R(e),n=!1,t()}}}function Ro(l){let e,n,t;return{c(){e=_("button"),e.textContent="Save",u(e,"class","button is-success")},m(o,r){L(o,e,r),n||(t=B(e,"click",l[12]),n=!0)},p:ce,d(o){o&&R(e),n=!1,t()}}}function Lo(l){let e,n,t;return{c(){e=_("button"),e.textContent="Next",u(e,"class","button is-primary")},m(o,r){L(o,e,r),n||(t=B(e,"click",l[3]),n=!0)},p:ce,d(o){o&&R(e),n=!1,t()}}}function Eo(l){let e,n,t,o,r,s,a,i;function d(y,b){return y[0]===1?yo:y[0]===2?wo:ko}let g=d(l),p=g(l),f=l[0]>1&&kl(l);function h(y,b){return y[0]<jl?Lo:Ro}let m=h(l),$=m(l);return{c(){e=_("div"),n=_("h3"),n.textContent="Configuration Wizard",t=C(),p.c(),o=C(),r=_("nav"),s=_("div"),f&&f.c(),a=C(),i=_("div"),$.c(),u(n,"class","title is-4"),u(s,"class","level-left"),u(i,"class","level-right"),u(r,"class","level"),u(e,"class","box")},m(y,b){L(y,e,b),c(e,n),c(e,t),p.m(e,null),c(e,o),c(e,r),c(r,s),f&&f.m(s,null),c(r,a),c(r,i),$.m(i,null)},p(y,b){g===(g=d(y))&&p?p.p(y,b):(p.d(1),p=g(y),p&&(p.c(),p.m(e,o))),y[0]>1?f?f.p(y,b):(f=kl(y),f.c(),f.m(s,null)):f&&(f.d(1),f=null),m===(m=h(y))&&$?$.p(y,b):($.d(1),$=m(y),$&&($.c(),$.m(i,null)))},i:ce,o:ce,d(y){y&&R(e),p.d(),f&&f.d(),$.d()}}}const jl=3;function No(l,e,n){let t;const o=we(null),r=we({id:"Desktop",global_shortcut:"Ctrl+X",default_theme:"spacelab",default_role:"Default",roles:[]});ae(l,r,v=>n(1,t=v)),Ut(async()=>{try{let v;ot(ye)?v=await me("get_config_schema"):v=await(await fetch("/config/schema")).json(),o.set(v);const N=ot(Ne);N&&N.id&&r.update(M=>{var te;return{...M,id:N.id,global_shortcut:N.global_shortcut,default_theme:((te=N.roles[N.default_role])==null?void 0:te.theme)??"spacelab",default_role:N.default_role,roles:Object.values(N.roles).map(re=>{var fe,Re,ve,Ae,Me,it,Je;const x=(fe=re.kg)==null?void 0:fe.automata_path,Be=(x==null?void 0:x.Remote)??"",ze=((ve=(Re=re.kg)==null?void 0:Re.knowledge_graph_local)==null?void 0:ve.path)??"";return{name:re.name,shortname:re.shortname,relevance_function:re.relevance_function,theme:re.theme,haystacks:(re.haystacks??[]).map(Ue=>({path:Ue.location||Ue.path||"",read_only:Ue.read_only??!1,service:Ue.service||"Ripgrep",atomic_server_secret:Ue.atomic_server_secret||"",extra_parameters:Ue.extra_parameters||{}})),kg:{url:Be,local_path:ze,local_type:((Me=(Ae=re.kg)==null?void 0:Ae.knowledge_graph_local)==null?void 0:Me.input_type)??"markdown",public:((it=re.kg)==null?void 0:it.public)??!1,publish:((Je=re.kg)==null?void 0:Je.publish)??!1}}})}})}catch(v){console.error("Failed to load schema",v)}});let s=1;function a(){s<jl&&n(0,s+=1)}function i(){s>1&&n(0,s-=1)}function d(){r.update(v=>({...v,roles:[...v.roles,{name:"New Role",shortname:"new",relevance_function:"title-scorer",theme:"spacelab",haystacks:[],kg:{url:"",local_path:"",local_type:"markdown",public:!1,publish:!1}}]}))}function g(v){r.update(N=>({...N,roles:N.roles.filter((M,te)=>te!==v)}))}function p(v){r.update(N=>(N.roles[v].haystacks.push({path:"",read_only:!1,service:"Ripgrep",atomic_server_secret:"",extra_parameters:{}}),N))}function f(v,N){r.update(M=>(M.roles[v].haystacks=M.roles[v].haystacks.filter((te,re)=>re!==N),M))}function h(v,N,M="",te=""){r.update(re=>{re.roles[v].haystacks[N].extra_parameters||(re.roles[v].haystacks[N].extra_parameters={});const x=M||`param_${Date.now()}`;return re.roles[v].haystacks[N].extra_parameters[x]=te,re})}function m(v,N,M){r.update(te=>(delete te.roles[v].haystacks[N].extra_parameters[M],te))}function $(v,N,M,te){r.update(re=>{const x=re.roles[v].haystacks[N].extra_parameters;return x[M]!==void 0&&M!==te&&(x[te]=x[M],delete x[M]),re})}function y(v,N,M,te){const re=te.target.value;$(v,N,M,re)}async function b(){var re;const v=ot(r),N=ot(Ne);let M={...N};M.id=v.id,M.global_shortcut=v.global_shortcut,M.default_role=v.default_role;const te={};v.roles.forEach(x=>{var fe,Re;const Be=x.name,ze=Be.replace(/^"|"$/g,"");te[ze]={extra:((Re=(fe=N.roles)==null?void 0:fe[Be])==null?void 0:Re.extra)??{},name:x.name,shortname:x.shortname,theme:x.theme,relevance_function:x.relevance_function,haystacks:x.haystacks.map(ve=>({location:ve.path,service:ve.service,read_only:ve.read_only,atomic_server_secret:ve.service==="Atomic"?ve.atomic_server_secret:void 0,extra_parameters:ve.extra_parameters||{}})),kg:x.kg.url||x.kg.local_path?{automata_path:x.kg.url?{Remote:x.kg.url}:null,knowledge_graph_local:x.kg.local_path?{input_type:x.kg.local_type,path:x.kg.local_path}:null,public:x.kg.public,publish:x.kg.publish}:null}}),M.roles=te,(!M.default_role||!te[M.default_role])&&(M.default_role=((re=v.roles[0])==null?void 0:re.name)??"Default"),M.selected_role=M.default_role;try{ot(ye)?await me("update_config",{configNew:M}):await fetch("/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)}),Ne.set(M),alert("Configuration saved")}catch(x){console.error(x),alert("Failed to save config")}}function w(){t.id=Ct(this),r.set(t)}function S(){t.global_shortcut=this.value,r.set(t)}function Q(){t.default_theme=this.value,r.set(t)}function Y(){t.default_role=Ct(this),r.set(t)}function E(v){t.roles[v].name=this.value,r.set(t)}function O(v){t.roles[v].shortname=this.value,r.set(t)}function I(v){t.roles[v].theme=this.value,r.set(t)}function W(v){t.roles[v].relevance_function=this.value,r.set(t)}function H(v,N){t.roles[v].haystacks[N].service=Ct(this),r.set(t)}function z(v,N){t.roles[v].haystacks[N].path=this.value,r.set(t)}function D(v,N){t.roles[v].haystacks[N].atomic_server_secret=this.value,r.set(t)}const k=(v,N,M,te)=>y(v,N,M,te);function P(v,N,M){t.roles[v].haystacks[N].extra_parameters[M]=this.value,r.set(t)}const X=(v,N,M)=>m(v,N,M),Z=(v,N)=>h(v,N,"tag","#rust"),j=(v,N)=>h(v,N,"max_count","10"),ee=(v,N)=>h(v,N,"","");function J(v,N){t.roles[v].haystacks[N].read_only=this.checked,r.set(t)}const oe=(v,N)=>f(v,N),ue=v=>p(v);function _e(v){t.roles[v].kg.url=this.value,r.set(t)}function U(v){t.roles[v].kg.local_path=this.value,r.set(t)}function F(v){t.roles[v].kg.local_type=Ct(this),r.set(t)}function V(v){t.roles[v].kg.public=this.checked,r.set(t)}function se(v){t.roles[v].kg.publish=this.checked,r.set(t)}return[s,t,r,a,i,d,g,p,f,h,m,y,b,w,S,Q,Y,E,O,I,W,H,z,D,k,P,X,Z,j,ee,J,oe,ue,_e,U,F,V,se,v=>g(v)]}class Oo extends Se{constructor(e){super(),Ce(this,e,No,Eo,ke,{},null,[-1,-1])}}function Do(l){let e,n,t,o,r,s;return r=new Dl({props:{content:l[0],onChange:l[1]}}),{c(){e=_("div"),n=_("p"),n.innerHTML="<i>The best editing experience is to configure Atomic Server, in the meantime use editor below. You will need to refresh page via Command R or Ctrl-R to see changes</i>",t=C(),o=_("div"),q(r.$$.fragment),u(o,"class","editor"),u(e,"class","box")},m(a,i){L(a,e,i),c(e,n),c(e,t),c(e,o),K(r,o,null),s=!0},p(a,[i]){const d={};i&1&&(d.content=a[0]),r.$set(d)},i(a){s||(T(r.$$.fragment,a),s=!0)},o(a){A(r.$$.fragment,a),s=!1},d(a){a&&R(e),G(r)}}}function To(l,e,n){let t,o;ae(l,Ne,a=>n(2,t=a)),ae(l,ye,a=>n(3,o=a));let r={json:t};function s(a){if(console.log("contents changed:",a),console.log("is tauri",o),Ne.update(i=>(i=a.json,i)),ot(ye))console.log("Updating config on server"),me("update_config",{configNew:a.json}).then(i=>{console.log(`Message: ${i}`)}).catch(i=>console.error(i));else{let i=`${st.ServerURL}/config/`;fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a.json)})}n(0,r=a)}return Ut(()=>{n(0,r={json:t})}),[r,s]}class Ao extends Se{constructor(e){super(),Ce(this,e,To,Do,ke,{})}}const{window:Mt}=tn;function Mo(l){let e,n,t,o,r,s,a,i,d,g;return{c(){e=_("div"),n=_("div"),t=_("h3"),t.textContent="Error loading graph",o=C(),r=_("p"),s=le(l[3]),a=C(),i=_("button"),i.textContent="Retry",u(i,"class","button is-primary"),u(n,"class","error-content svelte-1ry9pkl"),u(e,"class","error-overlay svelte-1ry9pkl")},m(p,f){L(p,e,f),c(e,n),c(n,t),c(n,o),c(n,r),c(r,s),c(n,a),c(n,i),d||(g=B(i,"click",l[11]),d=!0)},p(p,f){f&8&&ge(s,p[3])},d(p){p&&R(e),d=!1,g()}}}function Uo(l){let e;return{c(){e=_("div"),e.innerHTML=`<div class="loading-content svelte-1ry9pkl"><div class="loader svelte-1ry9pkl"></div> 
        <p>Loading knowledge graph...</p></div>`,u(e,"class","loading-overlay svelte-1ry9pkl")},m(n,t){L(n,e,t)},p:ce,d(n){n&&R(e)}}}function wl(l){let e,n,t;return{c(){e=_("button"),e.innerHTML='<i class="fas fa-times svelte-1ry9pkl"></i>',u(e,"class","close-button svelte-1ry9pkl"),u(e,"title","Close Graph")},m(o,r){L(o,e,r),n||(t=B(e,"click",l[17]),n=!0)},p:ce,d(o){o&&R(e),n=!1,t()}}}function yl(l){let e;return{c(){e=_("div"),e.innerHTML="<span><strong>Left-click:</strong> View node • <strong>Right-click:</strong> Edit node • <strong>Drag:</strong> Move • <strong>Scroll:</strong> Zoom</span>",u(e,"class","controls-info svelte-1ry9pkl")},m(n,t){L(n,e,t)},d(n){n&&R(e)}}}function Sl(l){let e,n;return{c(){e=_("div"),n=le(l[8]),u(e,"class","debug-message svelte-1ry9pkl")},m(t,o){L(t,e,o),c(e,n)},p(t,o){o&256&&ge(n,t[8])},d(t){t&&R(e)}}}function Cl(l){let e=l[5].id,n,t,o=Rl(l);return{c(){o.c(),n=at()},m(r,s){o.m(r,s),L(r,n,s),t=!0},p(r,s){s&32&&ke(e,e=r[5].id)?(Ie(),A(o,1,1,ce),He(),o=Rl(r),o.c(),T(o,1),o.m(n.parentNode,n)):o.p(r,s)},i(r){t||(T(o),t=!0)},o(r){A(o),t=!1},d(r){r&&R(n),o.d(r)}}}function Rl(l){let e,n,t;function o(s){l[18](s)}let r={item:l[5],initialEdit:l[7]};return l[6]!==void 0&&(r.active=l[6]),e=new Ml({props:r}),$e.push(()=>Oe(e,"active",o)),e.$on("close",l[12]),e.$on("save",l[13]),{c(){q(e.$$.fragment)},m(s,a){K(e,s,a),t=!0},p(s,a){const i={};a&32&&(i.item=s[5]),a&128&&(i.initialEdit=s[7]),!n&&a&64&&(n=!0,i.active=s[6],De(()=>n=!1)),e.$set(i)},i(s){t||(T(e.$$.fragment,s),t=!0)},o(s){A(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function jo(l){let e,n,t,o,r,s,a,i,d;Qe(l[15]);function g(b,w){if(b[2])return Uo;if(b[3])return Mo}let p=g(l),f=p&&p(l),h=l[0]&&wl(l),m=!l[2]&&!l[3]&&l[4].length>0&&yl(),$=l[8]&&Sl(l),y=l[5]&&Cl(l);return{c(){e=_("div"),f&&f.c(),n=C(),h&&h.c(),t=C(),m&&m.c(),o=C(),$&&$.c(),r=C(),y&&y.c(),s=at(),u(e,"class","graph-container svelte-1ry9pkl"),Ze(e,"width",l[0]?"100vw":"600px"),Ze(e,"height",l[0]?"100vh":"400px"),Lt(e,"fullscreen",l[0])},m(b,w){L(b,e,w),f&&f.m(e,null),l[16](e),L(b,n,w),h&&h.m(b,w),L(b,t,w),m&&m.m(b,w),L(b,o,w),$&&$.m(b,w),L(b,r,w),y&&y.m(b,w),L(b,s,w),a=!0,i||(d=B(Mt,"resize",l[15]),i=!0)},p(b,[w]){p===(p=g(b))&&f?f.p(b,w):(f&&f.d(1),f=p&&p(b),f&&(f.c(),f.m(e,null))),(!a||w&1)&&Ze(e,"width",b[0]?"100vw":"600px"),(!a||w&1)&&Ze(e,"height",b[0]?"100vh":"400px"),(!a||w&1)&&Lt(e,"fullscreen",b[0]),b[0]?h?h.p(b,w):(h=wl(b),h.c(),h.m(t.parentNode,t)):h&&(h.d(1),h=null),!b[2]&&!b[3]&&b[4].length>0?m||(m=yl(),m.c(),m.m(o.parentNode,o)):m&&(m.d(1),m=null),b[8]?$?$.p(b,w):($=Sl(b),$.c(),$.m(r.parentNode,r)):$&&($.d(1),$=null),b[5]?y?(y.p(b,w),w&32&&T(y,1)):(y=Cl(b),y.c(),T(y,1),y.m(s.parentNode,s)):y&&(Ie(),A(y,1,1,()=>{y=null}),He())},i(b){a||(T(y),a=!0)},o(b){A(y),a=!1},d(b){b&&R(e),f&&f.d(),l[16](null),b&&R(n),h&&h.d(b),b&&R(t),m&&m.d(b),b&&R(o),$&&$.d(b),b&&R(r),y&&y.d(b),b&&R(s),i=!1,d()}}}function Ll(l){return{id:`kg-node-${l.id}`,url:`#/graph/node/${l.id}`,title:l.label,body:`# ${l.label}

**Knowledge Graph Node**

ID: ${l.id}
Rank: ${l.rank}

This is a concept node from the knowledge graph. You can edit this content to add more information about "${l.label}".`,description:`Knowledge graph concept: ${l.label}`,tags:["knowledge-graph","concept"],rank:l.rank,stub:`Knowledge graph concept: ${l.label}`}}function Po(l,e,n){let t,o;ae(l,rt,k=>n(20,t=k)),ae(l,ye,k=>n(21,o=k));let{apiUrl:r="/rolegraph"}=e,{fullscreen:s=!0}=e,a,i=!0,d=null,g=[],p=[],f=null,h=!1,m=!1,$="",y=window.innerWidth,b=window.innerHeight;function w(){n(9,y=window.innerWidth),n(10,b=window.innerHeight),!i&&!d&&I()}async function S(){n(2,i=!0),n(3,d=null);try{if(o){console.log("Loading rolegraph from Tauri");const k=await me("get_rolegraph",{roleName:t||void 0});if(k&&k.status==="success")n(4,g=k.nodes),p=k.edges;else throw new Error(`Tauri rolegraph fetch failed: ${(k==null?void 0:k.status)||"unknown error"}`)}else{console.log("Loading rolegraph from server");const k=t?`${r}?role=${encodeURIComponent(t)}`:r,P=await fetch(k);if(!P.ok)throw new Error(`Failed to fetch: ${P.status}`);const X=await P.json();n(4,g=X.nodes),p=X.edges}}catch(k){n(3,d=k.message),console.error("Error fetching rolegraph:",k)}finally{n(2,i=!1)}}function Q(k,P){k.stopPropagation(),console.log("Node clicked:",P.label),n(5,f=Ll(P)),n(7,m=!1),n(6,h=!0)}function Y(k,P){k.preventDefault(),k.stopPropagation(),console.log("Node right-clicked:",P.label),n(8,$=`Right-clicked: ${P.label}`),n(5,f=Ll(P)),n(7,m=!0),n(6,h=!0),setTimeout(()=>{n(8,$="")},2e3)}function E(){n(6,h=!1),n(5,f=null),n(7,m=!1)}async function O(){if(f)try{const k=await fetch("/documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f)});k.ok?console.log("Successfully saved KG record:",f.id):console.error("Failed to save KG record:",k.statusText)}catch(k){console.error("Error saving KG record:",k)}finally{n(6,h=!1),n(5,f=null),n(7,m=!1)}}function I(){if(!a)return;n(1,a.innerHTML="",a);const k=Ot(a).append("svg").attr("width",y).attr("height",b),P=fn().scaleExtent([.1,10]).on("zoom",U=>{X.attr("transform",U.transform)});k.call(P);const X=k.append("g"),Z=pn(g).force("link",_n(p).id(U=>U.id).distance(100)).force("charge",dn().strength(-200)).force("center",hn(y/2,b/2)).force("collision",mn().radius(20)),j=X.append("g").attr("class","links").selectAll("line").data(p).enter().append("line").attr("stroke","#666").attr("stroke-opacity",.7).attr("stroke-width",U=>{const F=U.weight||U.rank||1;return Math.max(1,Math.min(8,F*2))}),ee=X.append("g").attr("class","nodes").selectAll("circle").data(g).enter().append("circle").attr("r",U=>{const F=U.rank||1;return Math.max(6,Math.min(20,F*2))}).attr("fill",U=>{const F=U.rank||1,V=Math.min(F/10,1);return gn(.2+V*.6)}).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer").on("click",(U,F)=>Q(U,F)).on("contextmenu",(U,F)=>Y(U,F)).on("mouseover",function(U,F){Ot(this).transition().duration(150).attr("stroke-width",3).attr("r",V=>{const se=V.rank||1;return Math.max(8,Math.min(24,se*2.5))})}).on("mouseout",function(U,F){Ot(this).transition().duration(150).attr("stroke-width",2).attr("r",V=>{const se=V.rank||1;return Math.max(6,Math.min(20,se*2))})}).call(vn().on("start",oe).on("drag",ue).on("end",_e)),J=X.append("g").attr("class","labels").selectAll("text").data(g).enter().append("text").attr("text-anchor","middle").attr("dy",".35em").attr("font-size","11px").attr("font-family","Arial, sans-serif").attr("fill","#333").attr("pointer-events","none").text(U=>U.label.length>12?U.label.substring(0,12)+"...":U.label);Z.on("tick",()=>{j.attr("x1",U=>U.source.x).attr("y1",U=>U.source.y).attr("x2",U=>U.target.x).attr("y2",U=>U.target.y),ee.attr("cx",U=>U.x).attr("cy",U=>U.y),J.attr("x",U=>U.x).attr("y",U=>U.y)});function oe(U,F){U.active||Z.alphaTarget(.3).restart(),F.fx=F.x,F.fy=F.y}function ue(U,F){F.fx=U.x,F.fy=U.y}function _e(U,F){U.active||Z.alphaTarget(0),F.fx=null,F.fy=null}}Ut(()=>{S().then(()=>{d||I()});const k=P=>{P.preventDefault()};return a&&a.addEventListener("contextmenu",k),window.addEventListener("resize",w),()=>{a&&a.removeEventListener("contextmenu",k),window.removeEventListener("resize",w)}});function W(){n(9,y=Mt.innerWidth),n(10,b=Mt.innerHeight)}function H(k){$e[k?"unshift":"push"](()=>{a=k,n(1,a)})}const z=()=>history.back();function D(k){h=k,n(6,h)}return l.$$set=k=>{"apiUrl"in k&&n(14,r=k.apiUrl),"fullscreen"in k&&n(0,s=k.fullscreen)},[s,a,i,d,g,f,h,m,$,y,b,S,E,O,r,W,H,z,D]}class Wo extends Se{constructor(e){super(),Ce(this,e,Po,jo,ke,{apiUrl:14,fullscreen:0})}}function Io(l){let e,n;return e=new $o({}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Ho(l){let e,n;return e=new zn({}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Fo(l){let e,n;return e=new Oo({}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function zo(l){let e,n;return e=new Ao({}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function qo(l){let e,n;return e=new Wo({}),{c(){q(e.$$.fragment)},m(t,o){K(e,t,o),n=!0},i(t){n||(T(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){G(e,t)}}}function Ko(l){let e;return{c(){e=_("nav"),e.innerHTML=`<div class="navbar-brand"><a class="navbar-item" href="/"><span class="icon" style="color: #333;"><i class="fas fa-home"></i></span></a> 
            <a class="navbar-item" href="/config/wizard">Wizard</a> 
            <a class="navbar-item" href="/config/json">JSON Editor</a> 
            <a class="navbar-item" href="/graph">Graph</a></div>`,u(e,"class","navbar")},m(n,t){L(n,e,t)},p:ce,d(n){n&&R(e)}}}function Go(l){let e,n,t,o,r,s,a,i,d,g,p,f,h,m,$,y,b,w,S,Q,Y,E,O,I,W,H,z,D;return a=new Rt({}),g=new We({props:{path:"/",$$slots:{default:[Io]},$$scope:{ctx:l}}}),m=new We({props:{path:"/fetch/*",$$slots:{default:[Ho]},$$scope:{ctx:l}}}),y=new We({props:{path:"/config/wizard",$$slots:{default:[Fo]},$$scope:{ctx:l}}}),w=new We({props:{path:"/config/json",$$slots:{default:[zo]},$$scope:{ctx:l}}}),Q=new We({props:{path:"/graph",$$slots:{default:[qo]},$$scope:{ctx:l}}}),I=new We({props:{path:"/",$$slots:{default:[Ko]},$$scope:{ctx:l}}}),{c(){e=_("meta"),n=C(),t=_("div"),o=_("main"),r=_("div"),s=_("div"),q(a.$$.fragment),i=C(),d=_("div"),q(g.$$.fragment),p=C(),f=_("br"),h=C(),q(m.$$.fragment),$=C(),q(y.$$.fragment),b=C(),q(w.$$.fragment),S=C(),q(Q.$$.fragment),Y=C(),E=_("footer"),O=_("div"),q(I.$$.fragment),u(e,"name","color-scheme"),u(e,"content",l[1]),document.title="Terraphim",u(s,"class","role-selector svelte-1bfpta4"),u(r,"class","top-controls svelte-1bfpta4"),u(d,"class","search-area svelte-1bfpta4"),u(o,"class","main-content svelte-1bfpta4"),u(O,"class",W=Yt(l[0])+" svelte-1bfpta4"),u(E,"class","svelte-1bfpta4"),u(t,"class","is-full-height svelte-1bfpta4")},m(k,P){c(document.head,e),L(k,n,P),L(k,t,P),c(t,o),c(o,r),c(r,s),K(a,s,null),c(o,i),c(o,d),K(g,d,null),c(o,p),c(o,f),c(o,h),K(m,o,null),c(o,$),K(y,o,null),c(o,b),K(w,o,null),c(o,S),K(Q,o,null),c(t,Y),c(t,E),c(E,O),K(I,O,null),H=!0,z||(D=[B(E,"mouseover",l[2]),B(E,"focus",l[2])],z=!0)},p(k,[P]){(!H||P&2)&&u(e,"content",k[1]);const X={};P&8&&(X.$$scope={dirty:P,ctx:k}),g.$set(X);const Z={};P&8&&(Z.$$scope={dirty:P,ctx:k}),m.$set(Z);const j={};P&8&&(j.$$scope={dirty:P,ctx:k}),y.$set(j);const ee={};P&8&&(ee.$$scope={dirty:P,ctx:k}),w.$set(ee);const J={};P&8&&(J.$$scope={dirty:P,ctx:k}),Q.$set(J);const oe={};P&8&&(oe.$$scope={dirty:P,ctx:k}),I.$set(oe),(!H||P&1&&W!==(W=Yt(k[0])+" svelte-1bfpta4"))&&u(O,"class",W)},i(k){H||(T(a.$$.fragment,k),T(g.$$.fragment,k),T(m.$$.fragment,k),T(y.$$.fragment,k),T(w.$$.fragment,k),T(Q.$$.fragment,k),T(I.$$.fragment,k),H=!0)},o(k){A(a.$$.fragment,k),A(g.$$.fragment,k),A(m.$$.fragment,k),A(y.$$.fragment,k),A(w.$$.fragment,k),A(Q.$$.fragment,k),A(I.$$.fragment,k),H=!1},d(k){R(e),k&&R(n),k&&R(t),G(a),G(g),G(m),G(y),G(w),G(Q),G(I),z=!1,Te(D)}}}function Bo(l,e,n){let t;ae(l,ft,s=>n(1,t=s));let o="is-hidden";function r(){n(0,o="")}return[o,t,r]}class Jo extends Se{constructor(e){super(),Ce(this,e,Bo,Go,ke,{})}}const Vo=new an;un(Vo);new Jo({target:document.getElementById("app")});

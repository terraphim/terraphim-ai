import{aa as lt,S as Qe,i as Ze,s as qe,q as f,Y as V,b as T,y as i,Z as me,I as ve,j as C,ak as ke,au as mt,r as se,a as k,v as c,z as re,t as E,d as I,B as ie,av as Wn,aw as Ct,H as Ae,U as Ie,V as je,ax as Vt,ay as zn,F as Xe,g as Ne,e as Oe,O as Be,az as nl,l as x,E as Je,aA as yt,aB as Sn,aC as qn,a1 as Se,C as nt,aD as Me,aE as Cn,D as Ut,G as Et,aF as Tn,w as ht,x as rt,A as Bn,a2 as Jn,aG as Vn,ac as Yn,m as ol,af as At,W as St,a7 as Qn,a9 as Zn,n as Xn}from"./vendor-ui-cd3d2b6a.js";import{R as ct,S as Qt}from"./vendor-utils-1b347ea1.js";import{J as Rn,_ as xn,o as eo}from"./vendor-editor-992829d3.js";import{P as Ln,T as Yt,u as Nn,y as to,A as lo,S as no,q as oo}from"./vendor-atomic-1ea13e29.js";import{E as so}from"./novel-editor-b32024cb.js";import{s as Xt,z as ro,a as io,l as ao,m as uo,c as co,b as fo,B as po,d as _o}from"./vendor-charts-e6a4a6c9.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();const tt={ServerURL:location.protocol+"//"+window.location.host||"/"},el=lt([]),mo={id:"Desktop",global_shortcut:"",roles:{},default_role:{original:"",lowercase:""},selected_role:{original:"",lowercase:""}},Ht=lt("spacelab"),gt=lt("selected"),ze=lt(!1),go=lt(`${tt.ServerURL}/documents/search`),Ye=lt(mo),hl=lt([]);let xt=lt("");const jt=lt(!1);let wt=null;function ho(l){if(typeof document>"u")return;const e=`/assets/bulmaswatch/${l}/bulmaswatch.min.css`;if(wt!=null&&wt.href.endsWith(e))return;const t=document.createElement("link");t.rel="stylesheet",t.href=e,t.id="bulma-theme",t.onload=()=>{wt&&wt!==t&&wt.remove(),wt=t},document.head.appendChild(t);const n=document.head.querySelector('meta[name="color-scheme"]');n&&n.setAttribute("content",l)}Ht.subscribe(ho);function vo(l){let e,t;return{c(){e=f("option"),t=V(l[1]),e.__value=l[0],e.value=e.__value},m(n,o){T(n,e,o),i(e,t)},p(n,[o]){o&2&&me(t,n[1]),o&1&&(e.__value=n[0],e.value=e.__value)},i:ve,o:ve,d(n){n&&C(e)}}}function bo(l,e,t){let n,{subject:o}=e;const r=Ln(o),s=Yt(r,Nn.properties.name);return ke(l,s,a=>t(1,n=a)),Yt(r,"http://localhost:9883/property/theme"),l.$$set=a=>{"subject"in a&&t(0,o=a.subject)},[o,n,s]}class ko extends Qe{constructor(e){super(),Ze(this,e,bo,vo,qe,{subject:0})}}function $o(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function tl(l,e=!1){const t=$o(),n=`_${t}`;return Object.defineProperty(window,n,{value:o=>(e&&Reflect.deleteProperty(window,n),l==null?void 0:l(o)),writable:!1,configurable:!0}),t}async function Pe(l,e={}){return new Promise((t,n)=>{const o=tl(s=>{t(s),Reflect.deleteProperty(window,`_${r}`)},!0),r=tl(s=>{n(s),Reflect.deleteProperty(window,`_${o}`)},!0);window.__TAURI_IPC__({cmd:l,callback:o,error:r,...e})})}function vl(l,e,t){const n=l.slice();return n[25]=e[t],n}function wo(l){let e,t,n;function o(s){l[13](s)}let r={};return l[5]!==void 0&&(r.value=l[5]),e=new Ct({props:r}),Ae.push(()=>Ie(e,"value",o)),{c(){se(e.$$.fragment)},m(s,a){re(e,s,a),n=!0},p(s,a){const u={};!t&&a&32&&(t=!0,u.value=s[5],je(()=>t=!1)),e.$set(u)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){ie(e,s)}}}function yo(l){let e,t,n;function o(s){l[14](s)}let r={type:"password",placeholder:"secret",icon:"fas fa-lock",expanded:!0};return l[6]!==void 0&&(r.value=l[6]),e=new Ct({props:r}),Ae.push(()=>Ie(e,"value",o)),{c(){se(e.$$.fragment)},m(s,a){re(e,s,a),n=!0},p(s,a){const u={};!t&&a&64&&(t=!0,u.value=s[6],je(()=>t=!1)),e.$set(u)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){ie(e,s)}}}function So(l){let e;return{c(){e=V("Save")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function Co(l){let e,t;return e=new Vt({props:{type:"is-success",class:"is-right",iconPack:"fa",iconLeft:"check",$$slots:{default:[So]},$$scope:{ctx:l}}}),e.$on("click",l[8]),e.$on("submit",l[8]),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,o){const r={};o&268435456&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function To(l){let e,t,n,o,r,s;return e=new mt({props:{$$slots:{default:[wo]},$$scope:{ctx:l}}}),n=new mt({props:{grouped:!0,$$slots:{default:[yo]},$$scope:{ctx:l}}}),r=new mt({props:{grouped:!0,$$slots:{default:[Co]},$$scope:{ctx:l}}}),{c(){se(e.$$.fragment),t=k(),se(n.$$.fragment),o=k(),se(r.$$.fragment)},m(a,u){re(e,a,u),T(a,t,u),re(n,a,u),T(a,o,u),re(r,a,u),s=!0},p(a,u){const d={};u&268435488&&(d.$$scope={dirty:u,ctx:a}),e.$set(d);const m={};u&268435520&&(m.$$scope={dirty:u,ctx:a}),n.$set(m);const p={};u&268435456&&(p.$$scope={dirty:u,ctx:a}),r.$set(p)},i(a){s||(E(e.$$.fragment,a),E(n.$$.fragment,a),E(r.$$.fragment,a),s=!0)},o(a){I(e.$$.fragment,a),I(n.$$.fragment,a),I(r.$$.fragment,a),s=!1},d(a){ie(e,a),a&&C(t),ie(n,a),a&&C(o),ie(r,a)}}}function Ro(l){let e,t,n;function o(s){l[15](s)}let r={type:"search",placeholder:"Fetch JSON",icon:"search"};return l[3]!==void 0&&(r.value=l[3]),e=new Ct({props:r}),Ae.push(()=>Ie(e,"value",o)),{c(){se(e.$$.fragment)},m(s,a){re(e,s,a),n=!0},p(s,a){const u={};!t&&a&8&&(t=!0,u.value=s[3],je(()=>t=!1)),e.$set(u)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){ie(e,s)}}}function Lo(l){let e;return{c(){e=V("WikiPage")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function No(l){let e,t,n,o,r,s;function a(p){l[16](p)}let u={type:"search",placeholder:"Post JSON",icon:"search"};l[4]!==void 0&&(u.value=l[4]),e=new Ct({props:u}),Ae.push(()=>Ie(e,"value",a));function d(p){l[17](p)}let m={$$slots:{default:[Lo]},$$scope:{ctx:l}};return l[2]!==void 0&&(m.checked=l[2]),o=new zn({props:m}),Ae.push(()=>Ie(o,"checked",d)),{c(){se(e.$$.fragment),n=k(),se(o.$$.fragment)},m(p,_){re(e,p,_),T(p,n,_),re(o,p,_),s=!0},p(p,_){const h={};!t&&_&16&&(t=!0,h.value=p[4],je(()=>t=!1)),e.$set(h);const g={};_&268435456&&(g.$$scope={dirty:_,ctx:p}),!r&&_&4&&(r=!0,g.checked=p[2],je(()=>r=!1)),o.$set(g)},i(p){s||(E(e.$$.fragment,p),E(o.$$.fragment,p),s=!0)},o(p){I(e.$$.fragment,p),I(o.$$.fragment,p),s=!1},d(p){ie(e,p),p&&C(n),ie(o,p)}}}function Oo(l){let e;return{c(){e=V("Fetch")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function Ao(l){let e,t;return e=new Vt({props:{type:"is-primary",$$slots:{default:[Oo]},$$scope:{ctx:l}}}),e.$on("click",l[9]),e.$on("submit",l[9]),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,o){const r={};o&268435456&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Uo(l){let e,t,n,o,r,s;return e=new mt({props:{grouped:!0,$$slots:{default:[Ro]},$$scope:{ctx:l}}}),n=new mt({props:{grouped:!0,$$slots:{default:[No]},$$scope:{ctx:l}}}),r=new mt({props:{grouped:!0,$$slots:{default:[Ao]},$$scope:{ctx:l}}}),{c(){se(e.$$.fragment),t=k(),se(n.$$.fragment),o=k(),se(r.$$.fragment)},m(a,u){re(e,a,u),T(a,t,u),re(n,a,u),T(a,o,u),re(r,a,u),s=!0},p(a,u){const d={};u&268435464&&(d.$$scope={dirty:u,ctx:a}),e.$set(d);const m={};u&268435476&&(m.$$scope={dirty:u,ctx:a}),n.$set(m);const p={};u&268435456&&(p.$$scope={dirty:u,ctx:a}),r.$set(p)},i(a){s||(E(e.$$.fragment,a),E(n.$$.fragment,a),E(r.$$.fragment,a),s=!0)},o(a){I(e.$$.fragment,a),I(n.$$.fragment,a),I(r.$$.fragment,a),s=!1},d(a){ie(e,a),a&&C(t),ie(n,a),a&&C(o),ie(r,a)}}}function Eo(l){let e,t,n,o,r;return o=new Rn({props:{content:l[1],onChange:l[7]}}),{c(){e=f("p"),e.innerHTML=`<i>The best editing experience is to configure Atomic Server, in the
        meantime use editor below. You will need to refresh page via Command R
        or Ctrl-R to see changes</i>`,t=k(),n=f("div"),se(o.$$.fragment),c(n,"class","editor")},m(s,a){T(s,e,a),T(s,t,a),T(s,n,a),re(o,n,null),r=!0},p(s,a){const u={};a&2&&(u.content=s[1]),o.$set(u)},i(s){r||(E(o.$$.fragment,s),r=!0)},o(s){I(o.$$.fragment,s),r=!1},d(s){s&&C(e),s&&C(t),s&&C(n),ie(o)}}}function bl(l){let e,t;return e=new ko({props:{subject:l[25]}}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,o){const r={};o&1&&(r.subject=n[25]),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Do(l){let e,t,n=l[0]??[],o=[];for(let s=0;s<n.length;s+=1)o[s]=bl(vl(l,n,s));const r=s=>I(o[s],1,1,()=>{o[s]=null});return{c(){for(let s=0;s<o.length;s+=1)o[s].c();e=Xe()},m(s,a){for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(s,a);T(s,e,a),t=!0},p(s,a){if(a&1){n=s[0]??[];let u;for(u=0;u<n.length;u+=1){const d=vl(s,n,u);o[u]?(o[u].p(d,a),E(o[u],1)):(o[u]=bl(d),o[u].c(),E(o[u],1),o[u].m(e.parentNode,e))}for(Ne(),u=n.length;u<o.length;u+=1)r(u);Oe()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)E(o[a]);t=!0}},o(s){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)I(o[a]);t=!1},d(s){Be(o,s),s&&C(e)}}}function Mo(l){let e,t;return e=new Wn({props:{$$slots:{default:[Do]},$$scope:{ctx:l}}}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,o){const r={};o&268435457&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Po(l){let e,t,n,o,r,s,a,u,d,m,p,_,h;return t=new ct({props:{path:"/atomic",$$slots:{default:[To]},$$scope:{ctx:l}}}),o=new ct({props:{path:"/json",$$slots:{default:[Uo]},$$scope:{ctx:l}}}),s=new ct({props:{path:"/editor",$$slots:{default:[Eo]},$$scope:{ctx:l}}}),m=new mt({props:{grouped:!0,position:"is-right",$$slots:{default:[Mo]},$$scope:{ctx:l}}}),{c(){e=f("div"),se(t.$$.fragment),n=k(),se(o.$$.fragment),r=k(),se(s.$$.fragment),a=k(),u=f("hr"),d=k(),se(m.$$.fragment),p=k(),_=f("nav"),_.innerHTML=`<div class="navbar-brand"><a class="navbar-item" href="/"><span class="icon" style="color: #333;"><i class="fas fa-home"></i></span></a> 
    <a class="navbar-item" href="/fetch/json">Fetch JSON Data</a> 
    <a class="navbar-item" href="/fetch/atomic">Set Atomic Server</a> 
    <a class="navbar-item" href="/fetch/editor">Edit JSON config</a></div>`,c(e,"class","box"),c(_,"class","navbar")},m(g,$){T(g,e,$),re(t,e,null),i(e,n),re(o,e,null),i(e,r),re(s,e,null),T(g,a,$),T(g,u,$),T(g,d,$),re(m,g,$),T(g,p,$),T(g,_,$),h=!0},p(g,[$]){const y={};$&268435552&&(y.$$scope={dirty:$,ctx:g}),t.$set(y);const v={};$&268435484&&(v.$$scope={dirty:$,ctx:g}),o.$set(v);const b={};$&268435458&&(b.$$scope={dirty:$,ctx:g}),s.$set(b);const L={};$&268435457&&(L.$$scope={dirty:$,ctx:g}),m.$set(L)},i(g){h||(E(t.$$.fragment,g),E(o.$$.fragment,g),E(s.$$.fragment,g),E(m.$$.fragment,g),h=!0)},o(g){I(t.$$.fragment,g),I(o.$$.fragment,g),I(s.$$.fragment,g),I(m.$$.fragment,g),h=!1},d(g){g&&C(e),ie(t),ie(o),ie(s),g&&C(a),g&&C(u),g&&C(d),ie(m,g),g&&C(p),g&&C(_)}}}function Io(l,e,t){let n,o,r,s,a;ke(l,to,M=>t(19,r=M)),ke(l,ze,M=>t(20,s=M)),ke(l,Ye,M=>t(21,a=M));let u={json:a};function d(M){if(console.log("contents changed:",M),console.log("is tauri",s),Ye.update(S=>(S=M.json,S)),ze)console.log("Updating config on server"),Pe("update_config",{configNew:M.json}).then(S=>{console.log(`Message: ${S}`)}).catch(S=>console.error(S));else{let S=`${tt.ServerURL}/config/`;fetch(S,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M.json)})}t(1,u=M)}let m=!1,p="https://raw.githubusercontent.com/terraphim/terraphim-cloud-fastapi/main/data/ref_arch.json",_="http://localhost:8000/documents/",h="http://localhost:9883/",g;const $=async()=>{console.log("Updating atomic server configuration");const M=lo.fromSecret(g);r.setServerUrl(h),console.log("Server set.Setting agent"),r.setAgent(M)},y=async()=>{L()},v=({data:{msg:M,data:S}})=>{console.log(M,S)};let b;const L=async()=>{const M=await xn(()=>import("./fetcher.worker-7e58969a.js"),[]);b=new M.default,b.onmessage=v;const S={msg:"fetcher",data:{url:p,postUrl:_,isWiki:m}};b.postMessage(S)},A=Ln("http://localhost:9883/config/y3zx5wtm0bq"),K=Yt(A,Nn.properties.name);ke(l,K,M=>t(12,o=M));const j=Yt(A,"http://localhost:9883/property/role");ke(l,j,M=>t(0,n=M));function w(M){h=M,t(5,h)}function N(M){g=M,t(6,g)}function P(M){p=M,t(3,p)}function q(M){_=M,t(4,_)}function J(M){m=M,t(2,m)}return l.$$.update=()=>{l.$$.dirty&4096&&console.log("Print name",o),l.$$.dirty&1&&console.log("Print roles",n)},[n,u,m,p,_,h,g,d,$,y,K,j,o,w,N,P,q,J]}class jo extends Qe{constructor(e){super(),Ze(this,e,Io,Po,qe,{})}}function Ho(l){let e,t;return e=new so({props:{defaultValue:l[0],isEditable:!l[1],disableLocalStorage:!0,onUpdate:l[2],extensions:[eo]}}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,[o]){const r={};o&1&&(r.defaultValue=n[0]),o&2&&(r.isEditable=!n[1]),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Fo(l,e,t){let{html:n=""}=e,{readOnly:o=!1}=e,{outputFormat:r="html"}=e;const s=a=>{r==="markdown"?t(0,n=a.storage.markdown.getMarkdown()):t(0,n=a.getHTML())};return l.$$set=a=>{"html"in a&&t(0,n=a.html),"readOnly"in a&&t(1,o=a.readOnly),"outputFormat"in a&&t(3,r=a.outputFormat)},[n,o,s,r]}class Go extends Qe{constructor(e){super(),Ze(this,e,Fo,Ho,qe,{html:0,readOnly:1,outputFormat:3})}}function kl(l){let e,t,n,o,r,s,a,u,d,m,p;return{c(){e=f("div"),t=f("h3"),n=f("span"),n.textContent="Knowledge Graph",o=V(`
          Term: `),r=f("strong"),s=V(l[2]),a=V(" | Rank: "),u=f("strong"),d=V(l[3]),m=k(),p=f("hr"),c(n,"class","tag is-info svelte-329px1"),c(t,"class","subtitle is-6 svelte-329px1"),c(p,"class","svelte-329px1"),c(e,"class","kg-context svelte-329px1")},m(_,h){T(_,e,h),i(e,t),i(t,n),i(t,o),i(t,r),i(r,s),i(t,a),i(t,u),i(u,d),i(e,m),i(e,p)},p(_,h){h&4&&me(s,_[2]),h&8&&me(d,_[3])},d(_){_&&C(e)}}}function Ko(l){let e,t,n,o,r,s,a,u;const d=[qo,zo],m=[];function p(_,h){return _[5]?0:1}return t=p(l),n=m[t]=d[t](l),{c(){e=f("div"),n.c(),o=k(),r=f("div"),r.innerHTML='<span class="hint-text svelte-329px1">Double-click to edit • Ctrl+E to edit • Ctrl+S to save • Click KG links to explore</span>',c(r,"class","edit-hint svelte-329px1"),c(e,"class","content-viewer svelte-329px1"),c(e,"tabindex","0"),c(e,"role","button"),c(e,"aria-label","Double-click to edit article content")},m(_,h){T(_,e,h),m[t].m(e,null),i(e,o),i(e,r),l[20](e),s=!0,a||(u=[x(e,"dblclick",l[14]),x(e,"keydown",l[15]),x(e,"click",l[13])],a=!0)},p(_,h){let g=t;t=p(_),t===g?m[t].p(_,h):(Ne(),I(m[g],1,1,()=>{m[g]=null}),Oe(),n=m[t],n?n.p(_,h):(n=m[t]=d[t](_),n.c()),E(n,1),n.m(e,o))},i(_){s||(E(n),s=!0)},o(_){I(n),s=!1},d(_){_&&C(e),m[t].d(),l[20](null),a=!1,Je(u)}}}function Wo(l){let e,t,n,o,r,s,a,u,d,m;function p(h){l[18](h)}let _={outputFormat:l[11]};return l[1].body!==void 0&&(_.html=l[1].body),e=new Go({props:_}),Ae.push(()=>Ie(e,"html",p)),{c(){se(e.$$.fragment),n=k(),o=f("div"),r=f("button"),r.textContent="Save",s=k(),a=f("button"),a.textContent="Cancel",c(r,"class","button is-primary"),c(a,"class","button is-light"),c(o,"class","edit-controls svelte-329px1")},m(h,g){re(e,h,g),T(h,n,g),T(h,o,g),i(o,r),i(o,s),i(o,a),u=!0,d||(m=[x(r,"click",l[12]),x(a,"click",l[19])],d=!0)},p(h,g){const $={};g&2048&&($.outputFormat=h[11]),!t&&g&2&&(t=!0,$.html=h[1].body,je(()=>t=!1)),e.$set($)},i(h){u||(E(e.$$.fragment,h),u=!0)},o(h){I(e.$$.fragment,h),u=!1},d(h){ie(e,h),h&&C(n),h&&C(o),d=!1,Je(m)}}}function zo(l){let e,t,n;return t=new Qt({props:{source:l[1].body}}),{c(){e=f("div"),se(t.$$.fragment),c(e,"class","markdown-content svelte-329px1")},m(o,r){T(o,e,r),re(t,e,null),n=!0},p(o,r){const s={};r&2&&(s.source=o[1].body),t.$set(s)},i(o){n||(E(t.$$.fragment,o),n=!0)},o(o){I(t.$$.fragment,o),n=!1},d(o){o&&C(e),ie(t)}}}function qo(l){let e,t=l[1].body+"";return{c(){e=f("div"),c(e,"class","prose svelte-329px1")},m(n,o){T(n,e,o),e.innerHTML=t},p(n,o){o&2&&t!==(t=n[1].body+"")&&(e.innerHTML=t)},i:ve,o:ve,d(n){n&&C(e)}}}function Bo(l){let e,t,n,o,r,s=l[1].title+"",a,u,d,m,p,_,h,g=l[2]&&l[3]!==null&&kl(l);const $=[Wo,Ko],y=[];function v(b,L){return b[4]?0:1}return d=v(l),m=y[d]=$[d](l),{c(){e=f("div"),t=f("button"),n=k(),g&&g.c(),o=k(),r=f("h2"),a=V(s),u=k(),m.c(),c(t,"class","delete is-large modal-close-btn svelte-329px1"),c(t,"aria-label","close"),c(r,"class","svelte-329px1"),c(e,"class","box wrapper svelte-329px1")},m(b,L){T(b,e,L),i(e,t),i(e,n),g&&g.m(e,null),i(e,o),i(e,r),i(r,a),i(e,u),y[d].m(e,null),p=!0,_||(h=x(t,"click",l[17]),_=!0)},p(b,L){b[2]&&b[3]!==null?g?g.p(b,L):(g=kl(b),g.c(),g.m(e,o)):g&&(g.d(1),g=null),(!p||L&2)&&s!==(s=b[1].title+"")&&me(a,s);let A=d;d=v(b),d===A?y[d].p(b,L):(Ne(),I(y[A],1,1,()=>{y[A]=null}),Oe(),m=y[d],m?m.p(b,L):(m=y[d]=$[d](b),m.c()),E(m,1),m.m(e,null))},i(b){p||(E(m),p=!0)},o(b){I(m),p=!1},d(b){b&&C(e),g&&g.d(),y[d].d(),_=!1,h()}}}function $l(l){let e,t,n;function o(s){l[23](s)}let r={$$slots:{default:[Yo]},$$scope:{ctx:l}};return l[7]!==void 0&&(r.active=l[7]),e=new nl({props:r}),Ae.push(()=>Ie(e,"active",o)),{c(){se(e.$$.fragment)},m(s,a){re(e,s,a),n=!0},p(s,a){const u={};a&536872832&&(u.$$scope={dirty:a,ctx:s}),!t&&a&128&&(t=!0,u.active=s[7],je(()=>t=!1)),e.$set(u)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){ie(e,s)}}}function wl(l){let e,t,n,o,r,s,a,u,d,m,p;return{c(){e=f("div"),t=f("h3"),n=f("span"),n.textContent="Knowledge Graph",o=V(`
            Term: `),r=f("strong"),s=V(l[9]),a=V(" | Rank: "),u=f("strong"),d=V(l[10]),m=k(),p=f("hr"),c(n,"class","tag is-info svelte-329px1"),c(t,"class","subtitle is-6 svelte-329px1"),c(p,"class","svelte-329px1"),c(e,"class","kg-context svelte-329px1")},m(_,h){T(_,e,h),i(e,t),i(t,n),i(t,o),i(t,r),i(r,s),i(t,a),i(t,u),i(u,d),i(e,m),i(e,p)},p(_,h){h&512&&me(s,_[9]),h&1024&&me(d,_[10])},d(_){_&&C(e)}}}function Jo(l){let e,t,n;return t=new Qt({props:{source:l[8].body}}),{c(){e=f("div"),se(t.$$.fragment),c(e,"class","markdown-content svelte-329px1")},m(o,r){T(o,e,r),re(t,e,null),n=!0},p(o,r){const s={};r&256&&(s.source=o[8].body),t.$set(s)},i(o){n||(E(t.$$.fragment,o),n=!0)},o(o){I(t.$$.fragment,o),n=!1},d(o){o&&C(e),ie(t)}}}function Vo(l){let e,t=l[8].body+"";return{c(){e=f("div"),c(e,"class","prose svelte-329px1")},m(n,o){T(n,e,o),e.innerHTML=t},p(n,o){o&256&&t!==(t=n[8].body+"")&&(e.innerHTML=t)},i:ve,o:ve,d(n){n&&C(e)}}}function Yo(l){let e,t,n,o,r,s=l[8].title+"",a,u,d,m,p,_,h,g,$,y,v,b=l[9]&&l[10]!==null&&wl(l);const L=[Vo,Jo],A=[];function K(j,w){return w&256&&(m=null),m==null&&(m=!!(j[8].body&&(/<html/i.test(j[8].body)||/<body/i.test(j[8].body)||/<head/i.test(j[8].body)))),m?0:1}return p=K(l,-1),_=A[p]=L[p](l),{c(){e=f("div"),t=f("button"),n=k(),b&&b.c(),o=k(),r=f("h2"),a=V(s),u=k(),d=f("div"),_.c(),h=k(),g=f("div"),g.innerHTML='<span class="hint-text svelte-329px1">Knowledge Graph document • Click KG links to explore further</span>',c(t,"class","delete is-large modal-close-btn svelte-329px1"),c(t,"aria-label","close"),c(r,"class","svelte-329px1"),c(g,"class","edit-hint svelte-329px1"),c(d,"class","content-viewer svelte-329px1"),c(d,"tabindex","0"),c(d,"role","button"),c(d,"aria-label","KG document content - click KG links to explore further"),c(e,"class","box wrapper svelte-329px1")},m(j,w){T(j,e,w),i(e,t),i(e,n),b&&b.m(e,null),i(e,o),i(e,r),i(r,a),i(e,u),i(e,d),A[p].m(d,null),i(d,h),i(d,g),$=!0,y||(v=[x(t,"click",l[22]),x(d,"click",l[13])],y=!0)},p(j,w){j[9]&&j[10]!==null?b?b.p(j,w):(b=wl(j),b.c(),b.m(e,o)):b&&(b.d(1),b=null),(!$||w&256)&&s!==(s=j[8].title+"")&&me(a,s);let N=p;p=K(j,w),p===N?A[p].p(j,w):(Ne(),I(A[N],1,1,()=>{A[N]=null}),Oe(),_=A[p],_?_.p(j,w):(_=A[p]=L[p](j),_.c()),E(_,1),_.m(d,h))},i(j){$||(E(_),$=!0)},o(j){I(_),$=!1},d(j){j&&C(e),b&&b.d(),A[p].d(),y=!1,Je(v)}}}function Qo(l){let e,t,n,o,r;function s(d){l[21](d)}let a={$$slots:{default:[Bo]},$$scope:{ctx:l}};l[0]!==void 0&&(a.active=l[0]),e=new nl({props:a}),Ae.push(()=>Ie(e,"active",s));let u=l[8]&&$l(l);return{c(){se(e.$$.fragment),n=k(),u&&u.c(),o=Xe()},m(d,m){re(e,d,m),T(d,n,m),u&&u.m(d,m),T(d,o,m),r=!0},p(d,[m]){const p={};m&536873087&&(p.$$scope={dirty:m,ctx:d}),!t&&m&1&&(t=!0,p.active=d[0],je(()=>t=!1)),e.$set(p),d[8]?u?(u.p(d,m),m&256&&E(u,1)):(u=$l(d),u.c(),E(u,1),u.m(o.parentNode,o)):u&&(Ne(),I(u,1,1,()=>{u=null}),Oe())},i(d){r||(E(e.$$.fragment,d),E(u),r=!0)},o(d){I(e.$$.fragment,d),I(u),r=!1},d(d){ie(e,d),d&&C(n),u&&u.d(d),d&&C(o)}}}function Zo(l,e,t){let n,o,r,s;ke(l,ze,U=>t(25,r=U)),ke(l,gt,U=>t(26,s=U));let{active:a=!1}=e,{item:u}=e,{initialEdit:d=!1}=e,{kgTerm:m=null}=e,{kgRank:p=null}=e,_=!1,h,g=!1,$=null,y=null,v=null;async function b(){if(r)try{const U=await Pe("get_document",{documentId:u.id});U!=null&&U.document&&t(1,u=U.document)}catch(U){console.error("Failed to load document",U)}}async function L(){if(!r){t(4,_=!1);return}try{await Pe("create_document",{document:u}),t(4,_=!1)}catch(U){console.error("Failed to save document",U)}}async function A(U){var Z,F,G,Q,R;t(9,y=U),console.log("🔍 KG Link Click Debug Info:"),console.log("  Term clicked:",U),console.log("  Current role:",s),console.log("  Is Tauri mode:",r);try{if(r){console.log("  Making Tauri invoke call..."),console.log("  Tauri command: find_documents_for_kg_term"),console.log("  Tauri params:",{roleName:s,term:U});const W=await Pe("find_documents_for_kg_term",{roleName:s,term:U});console.log("  📥 Tauri response received:"),console.log("    Status:",W.status),console.log("    Results count:",((Z=W.results)==null?void 0:Z.length)||0),console.log("    Total:",W.total||0),console.log("    Full response:",JSON.stringify(W,null,2)),W.status==="success"&&W.results&&W.results.length>0?(t(8,$=W.results[0]),t(10,v=$.rank||0),console.log("  ✅ Found KG document:"),console.log("    Title:",$.title),console.log("    Rank:",v),console.log("    Body length:",((F=$.body)==null?void 0:F.length)||0,"characters"),t(7,g=!0)):(console.warn(`  ⚠️  No KG documents found for term: "${U}" in role: "${s}"`),console.warn("    This could indicate:"),console.warn("    1. Knowledge graph not built for this role"),console.warn("    2. Term not found in knowledge graph"),console.warn("    3. Role not configured with TerraphimGraph relevance function"),console.warn("    Suggestion: Check server logs for KG building status"))}else{console.log("  Making HTTP fetch call...");const W=tt.ServerURL,X=encodeURIComponent(s),O=encodeURIComponent(U),H=`${W}/roles/${X}/kg_search?term=${O}`;console.log("  📤 HTTP Request details:"),console.log("    Base URL:",W),console.log("    Role (encoded):",X),console.log("    Term (encoded):",O),console.log("    Full URL:",H);const B=await fetch(H);if(console.log("  📥 HTTP Response received:"),console.log("    Status code:",B.status),console.log("    Status text:",B.statusText),console.log("    Headers:",Object.fromEntries(B.headers.entries())),!B.ok)throw new Error(`HTTP error! Status: ${B.status} - ${B.statusText}`);const oe=await B.json();console.log("  📄 Response data:"),console.log("    Status:",oe.status),console.log("    Results count:",((G=oe.results)==null?void 0:G.length)||0),console.log("    Total:",oe.total||0),console.log("    Full response:",JSON.stringify(oe,null,2)),oe.status==="success"&&oe.results&&oe.results.length>0?(t(8,$=oe.results[0]),t(10,v=$.rank||0),console.log("  ✅ Found KG document:"),console.log("    Title:",$.title),console.log("    Rank:",v),console.log("    Body length:",((Q=$.body)==null?void 0:Q.length)||0,"characters"),t(7,g=!0)):(console.warn(`  ⚠️  No KG documents found for term: "${U}" in role: "${s}"`),console.warn("    This could indicate:"),console.warn("    1. Server not configured with Terraphim Engineer role"),console.warn("    2. Knowledge graph not built on server"),console.warn("    3. Term not found in knowledge graph"),console.warn("    Suggestion: Check server logs at startup for KG building status"),console.warn("    API URL tested:",H))}}catch(W){console.error("❌ Error fetching KG document:"),console.error("  Error type:",W.constructor.name),console.error("  Error message:",W.message||W),console.error("  Request details:",{term:U,role:s,isTauri:r,timestamp:new Date().toISOString()}),!r&&((R=W.message)!=null&&R.includes("Failed to fetch"))&&(console.error("  💡 Network error suggestions:"),console.error("    1. Check if server is running on expected port"),console.error("    2. Check CORS configuration"),console.error("    3. Verify server URL in CONFIG.ServerURL"))}finally{}}function K(U){const Z=U.target;if(Z.tagName==="A"){const F=Z.getAttribute("href");if(F&&F.startsWith("kg:")){U.preventDefault();const G=F.substring(3);A(G)}}}function j(){t(4,_=!0)}function w(U){U.type!=="dblclick"&&((U.ctrlKey||U.metaKey)&&U.key==="e"&&(U.preventDefault(),t(4,_=!0)),_&&(U.ctrlKey||U.metaKey)&&U.key==="s"&&(U.preventDefault(),L()),U.key==="Escape"&&(U.preventDefault(),_?t(4,_=!1):t(0,a=!1)))}const N=()=>t(0,a=!1);function P(U){l.$$.not_equal(u.body,U)&&(u.body=U,t(1,u))}const q=()=>t(4,_=!1);function J(U){Ae[U?"unshift":"push"](()=>{h=U,t(6,h)})}function M(U){a=U,t(0,a)}const S=()=>t(7,g=!1);function Y(U){g=U,t(7,g)}return l.$$set=U=>{"active"in U&&t(0,a=U.active),"item"in U&&t(1,u=U.item),"initialEdit"in U&&t(16,d=U.initialEdit),"kgTerm"in U&&t(2,m=U.kgTerm),"kgRank"in U&&t(3,p=U.kgRank)},l.$$.update=()=>{l.$$.dirty&65537&&a&&d&&t(4,_=!0),l.$$.dirty&19&&a&&u&&!_&&b(),l.$$.dirty&2&&t(5,n=u!=null&&u.body?/<html/i.test(u.body)||/<body/i.test(u.body)||/<head/i.test(u.body)||/^\s*<(!DOCTYPE|html|head|body|div|p|span)/i.test(u.body.trim()):!1),l.$$.dirty&32&&t(11,o=n?"html":"markdown")},[a,u,m,p,_,n,h,g,$,y,v,o,L,K,j,w,d,N,P,q,J,M,S,Y]}class sl extends Qe{constructor(e){super(),Ze(this,e,Zo,Qo,qe,{active:0,item:1,initialEdit:16,kgTerm:2,kgRank:3})}}function yl(l,e,t){const n=l.slice();return n[33]=e[t],n}function Sl(l,e,t){const n=l.slice();return n[36]=e[t],n}function Cl(l,e,t){const n=l.slice();return n[39]=e[t],n}function Tl(l){let e,t;return e=new Sn({props:{type:"is-success",$$slots:{default:[Xo]},$$scope:{ctx:l}}}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Xo(l){let e,t,n;return{c(){e=f("p"),e.innerHTML="<strong>Success!</strong> Article saved to atomic server successfully.",t=k(),n=f("p"),n.textContent="The modal will close automatically..."},m(o,r){T(o,e,r),T(o,t,r),T(o,n,r)},p:ve,d(o){o&&C(e),o&&C(t),o&&C(n)}}}function Rl(l){let e,t;return e=new Sn({props:{type:"is-danger",$$slots:{default:[xo]},$$scope:{ctx:l}}}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,o){const r={};o[0]&8|o[1]&2048&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function xo(l){let e,t,n,o;return{c(){e=f("p"),t=f("strong"),t.textContent="Error:",n=k(),o=V(l[3])},m(r,s){T(r,e,s),i(e,t),i(e,n),i(e,o)},p(r,s){s[0]&8&&me(o,r[3])},d(r){r&&C(e)}}}function Ll(l){var Y,U,Z,F;let e,t,n,o,r,s=(((Y=l[1])==null?void 0:Y.title)||"Untitled")+"",a,u,d,m,p,_,h=(((U=l[1])==null?void 0:U.rank)||0)+"",g,$,y,v,b,L,A,K,j,w,N=((Z=l[1])==null?void 0:Z.description)&&Nl(l),P=((F=l[1])==null?void 0:F.tags)&&Ol(l);function q(G,Q){return G[10].length>0?ts:es}let J=q(l),M=J(l),S=l[10].length>0&&El(l);return{c(){e=f("div"),t=f("label"),t.textContent="Document to Save",n=k(),o=f("div"),r=f("h5"),a=V(s),u=k(),N&&N.c(),d=k(),m=f("div"),p=f("span"),_=V("Rank: "),g=V(h),$=k(),P&&P.c(),y=k(),v=f("div"),b=f("label"),b.textContent="Atomic Server",L=k(),A=f("div"),M.c(),K=k(),S&&S.c(),j=Xe(),c(t,"class","label"),c(r,"class","title is-6"),c(p,"class","tag is-info svelte-48g63o"),c(m,"class","tags svelte-48g63o"),c(o,"class","box document-preview svelte-48g63o"),c(e,"class","field"),c(b,"class","label"),c(b,"for","atomic-server-select"),c(A,"class","control"),c(v,"class","field")},m(G,Q){T(G,e,Q),i(e,t),i(e,n),i(e,o),i(o,r),i(r,a),i(o,u),N&&N.m(o,null),i(o,d),i(o,m),i(m,p),i(p,_),i(p,g),i(m,$),P&&P.m(m,null),T(G,y,Q),T(G,v,Q),i(v,b),i(v,L),i(v,A),M.m(A,null),T(G,K,Q),S&&S.m(G,Q),T(G,j,Q),w=!0},p(G,Q){var R,W,X,O;(!w||Q[0]&2)&&s!==(s=(((R=G[1])==null?void 0:R.title)||"Untitled")+"")&&me(a,s),(W=G[1])!=null&&W.description?N?N.p(G,Q):(N=Nl(G),N.c(),N.m(o,d)):N&&(N.d(1),N=null),(!w||Q[0]&2)&&h!==(h=(((X=G[1])==null?void 0:X.rank)||0)+"")&&me(g,h),(O=G[1])!=null&&O.tags?P?P.p(G,Q):(P=Ol(G),P.c(),P.m(m,null)):P&&(P.d(1),P=null),J===(J=q(G))&&M?M.p(G,Q):(M.d(1),M=J(G),M&&(M.c(),M.m(A,null))),G[10].length>0?S?(S.p(G,Q),Q[0]&1024&&E(S,1)):(S=El(G),S.c(),E(S,1),S.m(j.parentNode,j)):S&&(Ne(),I(S,1,1,()=>{S=null}),Oe())},i(G){w||(E(S),w=!0)},o(G){I(S),w=!1},d(G){G&&C(e),N&&N.d(),P&&P.d(),G&&C(y),G&&C(v),M.d(),G&&C(K),S&&S.d(G),G&&C(j)}}}function Nl(l){let e,t=l[1].description+"",n;return{c(){e=f("p"),n=V(t),c(e,"class","content")},m(o,r){T(o,e,r),i(e,n)},p(o,r){r[0]&2&&t!==(t=o[1].description+"")&&me(n,t)},d(o){o&&C(e)}}}function Ol(l){let e,t=l[1].tags,n=[];for(let o=0;o<t.length;o+=1)n[o]=Al(Cl(l,t,o));return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=Xe()},m(o,r){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(o,r);T(o,e,r)},p(o,r){if(r[0]&2){t=o[1].tags;let s;for(s=0;s<t.length;s+=1){const a=Cl(o,t,s);n[s]?n[s].p(a,r):(n[s]=Al(a),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length}},d(o){Be(n,o),o&&C(e)}}}function Al(l){let e,t=l[39]+"",n;return{c(){e=f("span"),n=V(t),c(e,"class","tag svelte-48g63o")},m(o,r){T(o,e,r),i(e,n)},p(o,r){r[0]&2&&t!==(t=o[39]+"")&&me(n,t)},d(o){o&&C(e)}}}function es(l){let e,t,n,o,r,s,a,u,d;return{c(){e=f("div"),t=f("p"),t.innerHTML="<strong>No atomic servers available</strong>",n=k(),o=f("p"),r=V('Your current role "'),s=V(l[12]),a=V(`" doesn't have any writable atomic server configurations.`),u=k(),d=f("p"),d.textContent="Please configure an atomic server haystack in your role settings.",c(e,"class","notification is-warning")},m(m,p){T(m,e,p),i(e,t),i(e,n),i(e,o),i(o,r),i(o,s),i(o,a),i(e,u),i(e,d)},p(m,p){p[0]&4096&&me(s,m[12])},d(m){m&&C(e)}}}function ts(l){let e,t,n,o,r,s,a=l[10],u=[];for(let d=0;d<a.length;d+=1)u[d]=Ul(Sl(l,a,d));return{c(){e=f("div"),t=f("select");for(let d=0;d<u.length;d+=1)u[d].c();n=k(),o=f("p"),o.textContent=`Select the atomic server from your current role configuration.
              🔐 = Authenticated, ⚠️ = Anonymous access`,c(t,"id","atomic-server-select"),t.disabled=l[2],l[11]===void 0&&nt(()=>l[18].call(t)),c(e,"class","select is-fullwidth"),c(o,"class","help svelte-48g63o")},m(d,m){T(d,e,m),i(e,t);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(t,null);Me(t,l[11],!0),T(d,n,m),T(d,o,m),r||(s=x(t,"change",l[18]),r=!0)},p(d,m){if(m[0]&1024){a=d[10];let p;for(p=0;p<a.length;p+=1){const _=Sl(d,a,p);u[p]?u[p].p(_,m):(u[p]=Ul(_),u[p].c(),u[p].m(t,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=a.length}m[0]&4&&(t.disabled=d[2]),m[0]&3072&&Me(t,d[11])},d(d){d&&C(e),Be(u,d),d&&C(n),d&&C(o),r=!1,s()}}}function ls(l){let e;return{c(){e=f("span"),e.textContent="⚠️ No Auth",c(e,"class","has-text-warning")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function ns(l){let e;return{c(){e=f("span"),e.textContent="🔐",c(e,"class","has-text-success")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function Ul(l){let e,t=l[36].location+"",n,o,r,s;function a(m,p){return m[36].atomic_server_secret?ns:ls}let u=a(l),d=u(l);return{c(){e=f("option"),n=V(t),o=k(),d.c(),r=k(),e.__value=s=l[36].location,e.value=e.__value},m(m,p){T(m,e,p),i(e,n),i(e,o),d.m(e,null),i(e,r)},p(m,p){p[0]&1024&&t!==(t=m[36].location+"")&&me(n,t),u!==(u=a(m))&&(d.d(1),d=u(m),d&&(d.c(),d.m(e,r))),p[0]&1024&&s!==(s=m[36].location)&&(e.__value=s,e.value=e.__value)},d(m){m&&C(e),d.d()}}}function El(l){var vt,He;let e,t,n,o,r,s,a,u,d,m,p,_,h,g,$,y,v,b,L,A,K,j,w,N,P,q,J,M,S,Y,U,Z,F,G,Q,R,W,X,O,H,B,oe,pe,ae=(l[8]||"Untitled")+"",Ue,we,ge,ue,Ce,be=(((He=(vt=l[1])==null?void 0:vt.body)==null?void 0:He.length)||0)+"",D,ee,le,he,fe,ne,$e=l[14]()+"",z,ce,ye,Te,Ve,Le=l[15]()+"",xe,Ee,Re,ft,Dt;function dt(te){l[19](te)}let it={id:"article-title",placeholder:"Enter article title",disabled:l[2],required:!0};l[8]!==void 0&&(it.value=l[8]),r=new Ct({props:it}),Ae.push(()=>Ie(r,"value",dt));const Mt=[ss,os],We=[];function Pt(te,_e){return te[7]?1:0}return q=Pt(l),J=We[q]=Mt[q](l),U=new Vt({props:{type:"is-primary",loading:l[2],disabled:l[2]||!l[8].trim()||!l[11],$$slots:{default:[rs]},$$scope:{ctx:l}}}),U.$on("click",l[16]),G=new Vt({props:{type:"is-light",disabled:l[2],$$slots:{default:[is]},$$scope:{ctx:l}}}),G.$on("click",l[17]),Re=qn(l[22][0]),{c(){e=f("div"),t=f("label"),t.textContent="Article Title",n=k(),o=f("div"),se(r.$$.fragment),a=k(),u=f("div"),d=f("label"),d.textContent="Description",m=k(),p=f("div"),_=f("textarea"),h=k(),g=f("div"),$=f("label"),$.textContent="Parent Collection",y=k(),v=f("div"),b=f("label"),L=f("input"),A=V(`
              Use predefined collection`),K=k(),j=f("label"),w=f("input"),N=V(`
              Custom parent URL/path`),P=k(),J.c(),M=k(),S=f("div"),Y=f("div"),se(U.$$.fragment),Z=k(),F=f("div"),se(G.$$.fragment),Q=k(),R=f("div"),W=f("div"),X=f("p"),X.innerHTML="<strong>What will be saved:</strong>",O=k(),H=f("ul"),B=f("li"),oe=f("strong"),oe.textContent="Title:",pe=k(),Ue=V(ae),we=k(),ge=f("li"),ue=f("strong"),ue.textContent="Body:",Ce=V(" Original document content ("),D=V(be),ee=V(" characters)"),le=k(),he=f("li"),fe=f("strong"),fe.textContent="Parent:",ne=k(),z=V($e),ce=k(),ye=f("li"),Te=f("strong"),Te.textContent="Subject URL:",Ve=k(),xe=V(Le),c(t,"class","label"),c(t,"for","article-title"),c(o,"class","control"),c(e,"class","field"),c(d,"class","label"),c(d,"for","article-description"),c(_,"id","article-description"),c(_,"class","textarea"),c(_,"placeholder","Brief description of the article"),_.disabled=l[2],c(_,"rows","3"),c(p,"class","control"),c(u,"class","field"),c($,"class","label"),c(L,"type","radio"),L.__value=!1,L.value=L.__value,L.disabled=l[2],c(b,"class","radio svelte-48g63o"),c(w,"type","radio"),w.__value=!0,w.value=w.__value,w.disabled=l[2],c(j,"class","radio svelte-48g63o"),c(v,"class","control"),c(g,"class","field"),c(Y,"class","control"),c(F,"class","control"),c(S,"class","field is-grouped"),c(B,"class","svelte-48g63o"),c(ge,"class","svelte-48g63o"),c(he,"class","svelte-48g63o"),c(ye,"class","svelte-48g63o"),c(H,"class","svelte-48g63o"),c(W,"class","notification is-info is-light svelte-48g63o"),c(R,"class","field"),Re.p(L,w)},m(te,_e){T(te,e,_e),i(e,t),i(e,n),i(e,o),re(r,o,null),T(te,a,_e),T(te,u,_e),i(u,d),i(u,m),i(u,p),i(p,_),Se(_,l[9]),T(te,h,_e),T(te,g,_e),i(g,$),i(g,y),i(g,v),i(v,b),i(b,L),L.checked=L.__value===l[7],i(b,A),i(v,K),i(v,j),i(j,w),w.checked=w.__value===l[7],i(j,N),T(te,P,_e),We[q].m(te,_e),T(te,M,_e),T(te,S,_e),i(S,Y),re(U,Y,null),i(S,Z),i(S,F),re(G,F,null),T(te,Q,_e),T(te,R,_e),i(R,W),i(W,X),i(W,O),i(W,H),i(H,B),i(B,oe),i(B,pe),i(B,Ue),i(H,we),i(H,ge),i(ge,ue),i(ge,Ce),i(ge,D),i(ge,ee),i(H,le),i(H,he),i(he,fe),i(he,ne),i(he,z),i(H,ce),i(H,ye),i(ye,Te),i(ye,Ve),i(ye,xe),Ee=!0,ft||(Dt=[x(_,"input",l[20]),x(L,"change",l[21]),x(w,"change",l[23])],ft=!0)},p(te,_e){var bt,It;const pt={};_e[0]&4&&(pt.disabled=te[2]),!s&&_e[0]&256&&(s=!0,pt.value=te[8],je(()=>s=!1)),r.$set(pt),(!Ee||_e[0]&4)&&(_.disabled=te[2]),_e[0]&512&&Se(_,te[9]),(!Ee||_e[0]&4)&&(L.disabled=te[2]),_e[0]&128&&(L.checked=L.__value===te[7]),(!Ee||_e[0]&4)&&(w.disabled=te[2]),_e[0]&128&&(w.checked=w.__value===te[7]);let ot=q;q=Pt(te),q===ot?We[q].p(te,_e):(Ne(),I(We[ot],1,1,()=>{We[ot]=null}),Oe(),J=We[q],J?J.p(te,_e):(J=We[q]=Mt[q](te),J.c()),E(J,1),J.m(M.parentNode,M));const et={};_e[0]&4&&(et.loading=te[2]),_e[0]&2308&&(et.disabled=te[2]||!te[8].trim()||!te[11]),_e[1]&2048&&(et.$$scope={dirty:_e,ctx:te}),U.$set(et);const Tt={};_e[0]&4&&(Tt.disabled=te[2]),_e[1]&2048&&(Tt.$$scope={dirty:_e,ctx:te}),G.$set(Tt),(!Ee||_e[0]&256)&&ae!==(ae=(te[8]||"Untitled")+"")&&me(Ue,ae),(!Ee||_e[0]&2)&&be!==(be=(((It=(bt=te[1])==null?void 0:bt.body)==null?void 0:It.length)||0)+"")&&me(D,be)},i(te){Ee||(E(r.$$.fragment,te),E(J),E(U.$$.fragment,te),E(G.$$.fragment,te),Ee=!0)},o(te){I(r.$$.fragment,te),I(J),I(U.$$.fragment,te),I(G.$$.fragment,te),Ee=!1},d(te){te&&C(e),ie(r),te&&C(a),te&&C(u),te&&C(h),te&&C(g),te&&C(P),We[q].d(te),te&&C(M),te&&C(S),ie(U),ie(G),te&&C(Q),te&&C(R),Re.r(),ft=!1,Je(Dt)}}}function os(l){let e,t,n,o,r,s,a;function u(m){l[25](m)}let d={placeholder:"e.g., my-collection or http://server/custom-parent",disabled:l[2]};return l[6]!==void 0&&(d.value=l[6]),n=new Ct({props:d}),Ae.push(()=>Ie(n,"value",u)),{c(){e=f("div"),t=f("div"),se(n.$$.fragment),r=k(),s=f("p"),s.textContent=`Enter a collection name (e.g., "my-articles") or full URL. 
              If the collection doesn't exist, it will be created.`,c(t,"class","control"),c(s,"class","help svelte-48g63o"),c(e,"class","field")},m(m,p){T(m,e,p),i(e,t),re(n,t,null),i(e,r),i(e,s),a=!0},p(m,p){const _={};p[0]&4&&(_.disabled=m[2]),!o&&p[0]&64&&(o=!0,_.value=m[6],je(()=>o=!1)),n.$set(_)},i(m){a||(E(n.$$.fragment,m),a=!0)},o(m){I(n.$$.fragment,m),a=!1},d(m){m&&C(e),ie(n)}}}function ss(l){let e,t,n,o,r,s,a=l[13],u=[];for(let d=0;d<a.length;d+=1)u[d]=Dl(yl(l,a,d));return{c(){e=f("div"),t=f("div"),n=f("div"),o=f("select");for(let d=0;d<u.length;d+=1)u[d].c();o.disabled=l[2],l[5]===void 0&&nt(()=>l[24].call(o)),c(n,"class","select is-fullwidth"),c(t,"class","control"),c(e,"class","field")},m(d,m){T(d,e,m),i(e,t),i(t,n),i(n,o);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(o,null);Me(o,l[5],!0),r||(s=x(o,"change",l[24]),r=!0)},p(d,m){if(m[0]&8192){a=d[13];let p;for(p=0;p<a.length;p+=1){const _=yl(d,a,p);u[p]?u[p].p(_,m):(u[p]=Dl(_),u[p].c(),u[p].m(o,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=a.length}m[0]&4&&(o.disabled=d[2]),m[0]&8224&&Me(o,d[5])},i:ve,o:ve,d(d){d&&C(e),Be(u,d),r=!1,s()}}}function Dl(l){let e,t=l[33].label+"",n;return{c(){e=f("option"),n=V(t),e.__value=l[33].value,e.value=e.__value},m(o,r){T(o,e,r),i(e,n)},p:ve,d(o){o&&C(e)}}}function rs(l){let e,t,n;return{c(){e=f("span"),e.innerHTML='<i class="fas fa-cloud-upload-alt"></i>',t=k(),n=f("span"),n.textContent="Save to Atomic Server",c(e,"class","icon")},m(o,r){T(o,e,r),T(o,t,r),T(o,n,r)},p:ve,d(o){o&&C(e),o&&C(t),o&&C(n)}}}function is(l){let e;return{c(){e=V("Cancel")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function as(l){let e,t,n,o,r,s,a,u,d,m,p,_,h,g=l[4]&&Tl(l),$=l[3]&&Rl(l),y=!l[4]&&Ll(l);return{c(){e=f("div"),t=f("div"),n=f("div"),n.innerHTML=`<div class="level-item"><h3 class="title is-4"><span class="icon"><i class="fas fa-save"></i></span>
            Save to Atomic Server</h3></div>`,o=k(),r=f("div"),s=f("div"),a=f("button"),u=k(),g&&g.c(),d=k(),$&&$.c(),m=k(),y&&y.c(),c(n,"class","level-left"),c(a,"class","delete is-large"),a.disabled=l[2],c(a,"aria-label","close"),c(s,"class","level-item"),c(r,"class","level-right"),c(t,"class","level svelte-48g63o"),c(e,"class","box")},m(v,b){T(v,e,b),i(e,t),i(t,n),i(t,o),i(t,r),i(r,s),i(s,a),i(e,u),g&&g.m(e,null),i(e,d),$&&$.m(e,null),i(e,m),y&&y.m(e,null),p=!0,_||(h=x(a,"click",l[17]),_=!0)},p(v,b){(!p||b[0]&4)&&(a.disabled=v[2]),v[4]?g?b[0]&16&&E(g,1):(g=Tl(v),g.c(),E(g,1),g.m(e,d)):g&&(Ne(),I(g,1,1,()=>{g=null}),Oe()),v[3]?$?($.p(v,b),b[0]&8&&E($,1)):($=Rl(v),$.c(),E($,1),$.m(e,m)):$&&(Ne(),I($,1,1,()=>{$=null}),Oe()),v[4]?y&&(Ne(),I(y,1,1,()=>{y=null}),Oe()):y?(y.p(v,b),b[0]&16&&E(y,1)):(y=Ll(v),y.c(),E(y,1),y.m(e,null))},i(v){p||(E(g),E($),E(y),p=!0)},o(v){I(g),I($),I(y),p=!1},d(v){v&&C(e),g&&g.d(),$&&$.d(),y&&y.d(),_=!1,h()}}}function us(l){let e,t,n;function o(s){l[26](s)}let r={$$slots:{default:[as]},$$scope:{ctx:l}};return l[0]!==void 0&&(r.active=l[0]),e=new nl({props:r}),Ae.push(()=>Ie(e,"active",o)),e.$on("close",l[17]),{c(){se(e.$$.fragment)},m(s,a){re(e,s,a),n=!0},p(s,a){const u={};a[0]&8190|a[1]&2048&&(u.$$scope={dirty:a,ctx:s}),!t&&a[0]&1&&(t=!0,u.active=s[0],je(()=>t=!1)),e.$set(u)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){ie(e,s)}}}function cs(l,e,t){let n,o,r;ke(l,ze,R=>t(27,n=R)),ke(l,Ye,R=>t(28,o=R)),ke(l,gt,R=>t(12,r=R));let{active:s=!1}=e,{document:a}=e,u=!1,d=null,m=!1,p="",_="",h=!1,g="",$="",y=[],v="";const b=[{label:"Root (Server Root)",value:""},{label:"Articles Collection",value:"articles"},{label:"Documents Collection",value:"documents"},{label:"Knowledge Base",value:"knowledge-base"},{label:"Research",value:"research"},{label:"Projects",value:"projects"}];function L(){t(2,u=!1),t(3,d=null),t(4,m=!1),t(5,p=""),t(6,_=""),t(7,h=!1),t(8,g=(a==null?void 0:a.title)||""),t(9,$=(a==null?void 0:a.description)||`Article saved from Terraphim search: ${a==null?void 0:a.title}`),t(10,y=[]),t(11,v="")}function A(){var O;const R=r,W=o;if(!(W!=null&&W.roles)||!R){console.warn("No role configuration found");return}let X=null;try{for(const[H,B]of Object.entries(W.roles)){const oe=B,pe=typeof oe.name=="object"?oe.name.original:String(oe.name);if(H===R||pe===R){X=oe;break}}}catch(H){console.warn("Error checking role configuration:",H);return}if(!X){console.warn(`Role "${R}" not found in configuration`);return}t(10,y=((O=X.haystacks)==null?void 0:O.filter(H=>H.service==="Atomic"&&H.location&&!H.read_only))||[]),y.length>0&&t(11,v=y[0].location),console.log("Loaded atomic servers:",y)}function K(){const R=y.find(W=>W.location===v);return R==null?void 0:R.atomic_server_secret}function j(){const R=v.replace(/\/$/,"");if(h&&_.trim()){const W=_.trim();return W.startsWith("http://")||W.startsWith("https://")?W:`${R}/${W.replace(/^\//,"")}`}else return p?`${R}/${p}`:R}function w(){return g.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").substring(0,50)}function N(){const R=v.replace(/\/$/,""),W=w(),X=Date.now();return`${R}/${W}-${X}`}async function P(){if(!v||!g.trim()){t(3,d="Please select an atomic server and provide a title");return}t(2,u=!0),t(3,d=null);try{const R=N(),W=j(),X=K();console.log("🔄 Saving article to atomic server:",{subject:R,parent:W,server:v,hasSecret:!!X});const O={subject:R,title:g.trim(),description:$.trim(),body:a.body,parent:W,shortname:w(),original_id:a.id,original_url:a.url,original_rank:a.rank,tags:a.tags||[]};if(n)await Pe("save_article_to_atomic",{article:O,serverUrl:v,atomicSecret:X});else{const H=await fetch(`${tt.ServerURL}/atomic/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({article:O,server_url:v,atomic_secret:X})});if(!H.ok){const B=await H.json().catch(()=>({error:H.statusText}));throw new Error(B.error||`HTTP ${H.status}: ${H.statusText}`)}}t(4,m=!0),console.log("✅ Article saved successfully to atomic server"),setTimeout(()=>{t(0,s=!1)},2e3)}catch(R){console.error("❌ Failed to save article to atomic server:",R),t(3,d=R.message||"Failed to save article to atomic server")}finally{t(2,u=!1)}}function q(){u||t(0,s=!1)}const J=[[]];function M(){v=yt(this),t(11,v),t(10,y)}function S(R){g=R,t(8,g)}function Y(){$=this.value,t(9,$)}function U(){h=this.__value,t(7,h)}function Z(){h=this.__value,t(7,h)}function F(){p=yt(this),t(5,p),t(13,b)}function G(R){_=R,t(6,_)}function Q(R){s=R,t(0,s)}return l.$$set=R=>{"active"in R&&t(0,s=R.active),"document"in R&&t(1,a=R.document)},l.$$.update=()=>{l.$$.dirty[0]&3&&s&&a&&(L(),A())},[s,a,u,d,m,p,_,h,g,$,y,v,r,b,j,N,P,q,M,S,Y,U,J,Z,F,G,Q]}class fs extends Qe{constructor(e){super(),Ze(this,e,cs,us,qe,{active:0,document:1},null,[-1,-1])}}async function On(l){return Pe("tauri",l)}async function ds(l,e){return On({__tauriModule:"Event",message:{cmd:"unlisten",event:l,eventId:e}})}async function ps(l,e,t){return On({__tauriModule:"Event",message:{cmd:"listen",event:l,windowLabel:e,handler:tl(t)}}).then(n=>async()=>ds(l,n))}var Ml;(function(l){l.WINDOW_RESIZED="tauri://resize",l.WINDOW_MOVED="tauri://move",l.WINDOW_CLOSE_REQUESTED="tauri://close-requested",l.WINDOW_CREATED="tauri://window-created",l.WINDOW_DESTROYED="tauri://destroyed",l.WINDOW_FOCUS="tauri://focus",l.WINDOW_BLUR="tauri://blur",l.WINDOW_SCALE_FACTOR_CHANGED="tauri://scale-change",l.WINDOW_THEME_CHANGED="tauri://theme-changed",l.WINDOW_FILE_DROP="tauri://file-drop",l.WINDOW_FILE_DROP_HOVER="tauri://file-drop-hover",l.WINDOW_FILE_DROP_CANCELLED="tauri://file-drop-cancelled",l.MENU="tauri://menu",l.CHECK_UPDATE="tauri://update",l.UPDATE_AVAILABLE="tauri://update-available",l.INSTALL_UPDATE="tauri://update-install",l.STATUS_UPDATE="tauri://update-status",l.DOWNLOAD_PROGRESS="tauri://update-download-progress"})(Ml||(Ml={}));async function _s(l,e){return ps(l,null,e)}function Pl(l,e,t){const n=l.slice();return n[9]=e[t],n}function Il(l){let e,t=l[9].name+"",n,o;return{c(){e=f("option"),n=V(t),e.__value=o=l[9].name,e.value=e.__value},m(r,s){T(r,e,s),i(e,n)},p(r,s){s&1&&t!==(t=r[9].name+"")&&me(n,t),s&1&&o!==(o=r[9].name)&&(e.__value=o,e.value=e.__value)},d(r){r&&C(e)}}}function ms(l){let e,t,n,o,r,s,a=l[0],u=[];for(let d=0;d<a.length;d+=1)u[d]=Il(Pl(l,a,d));return{c(){e=f("div"),t=f("div"),n=f("div"),o=f("select");for(let d=0;d<u.length;d+=1)u[d].c();c(n,"class","select"),c(t,"class","control"),c(e,"class","field is-grouped is-grouped-right")},m(d,m){T(d,e,m),i(e,t),i(t,n),i(n,o);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(o,null);Me(o,l[1]),r||(s=x(o,"change",l[2]),r=!0)},p(d,[m]){if(m&1){a=d[0];let p;for(p=0;p<a.length;p+=1){const _=Pl(d,a,p);u[p]?u[p].p(_,m):(u[p]=Il(_),u[p].c(),u[p].m(o,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=a.length}m&3&&Me(o,d[1])},i:ve,o:ve,d(d){d&&C(e),Be(u,d),r=!1,s()}}}function gs(l,e,t){let n,o,r,s;ke(l,Ye,_=>t(5,n=_)),ke(l,ze,_=>t(6,o=_)),ke(l,hl,_=>t(0,r=_)),ke(l,gt,_=>t(1,s=_));let a="";async function u(){try{ze.set(window.__TAURI__!==void 0),o?(console.log("Loading config from Tauri"),Pe("get_config").then(_=>{console.log("get_config response",_),_&&_.status==="success"&&d(_.config)}).catch(_=>console.error("Error fetching config in Tauri:",_))):(console.log("Loading config from server"),a=`${tt.ServerURL}/config/`,fetch(a).then(_=>_.json()).then(_=>{console.log("Config received",_),_&&_.status==="success"&&d(_.config)}).catch(_=>console.error("Error fetching config:",_)))}catch(_){console.error("Unhandled error in loadConfig:",_)}}function d(_){var y;console.log("Updating stores from config:",_);const h={default_role:_.selected_role,..._};Ye.set(h);const g=Object.entries(_.roles).map(([v,b])=>({name:v,...b}));hl.set(g),gt.set(_.selected_role);const $=_.roles[_.selected_role];if(console.log("Selected role settings:",$),$){const v=$.theme||"spacelab";console.log("Setting theme to:",v),Ht.set(v),(y=$.kg)!=null&&y.publish?o&&Pe("publish_thesaurus",{roleName:_.selected_role}).then(b=>{console.log("publish_thesaurus response",b),el.set(b),jt.set(!0)}):jt.set(!1)}else console.warn("No role settings found for:",_.selected_role),Ht.set("spacelab")}typeof window<"u"&&window.__TAURI__&&_s("role_changed",_=>{console.log("Role changed event received from backend:",_.payload),d(_.payload)});async function m(){await u()}m(),console.log("Using Terraphim Server URL:",tt.ServerURL);function p(_){var v;const g=_.target.value;console.log("Role change requested:",g),gt.set(g);const $=r.find(b=>b.name===g);if(!$){console.error(`No role settings found for role: ${g}.`);return}const y=$.theme||"spacelab";Ht.set(y),console.log(`Theme changed to ${y}`),Ye.update(b=>(b.selected_role=g,b)),o?(Pe("select_role",{roleName:g}).catch(b=>console.error("Error selecting role:",b)),(v=$.kg)!=null&&v.publish?(console.log("Publishing thesaurus for role",g),Pe("publish_thesaurus",{roleName:g}).then(b=>{el.set(b),jt.set(!0)})):jt.set(!1)):fetch(`${tt.ServerURL}/config/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).catch(b=>console.error("Error updating config on server:",b))}return[r,s,p,u]}class Jt extends Qe{constructor(e){super(),Ze(this,e,gs,ms,qe,{loadConfig:3})}get loadConfig(){return this.$$.ctx[3]}}function jl(l,e,t){const n=l.slice();return n[33]=e[t],n}function Hl(l,e,t){const n=l.slice();return n[36]=e[t],n}function Fl(l){let e,t;return e=new Cn({props:{$$slots:{default:[vs]},$$scope:{ctx:l}}}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,o){const r={};o[0]&129|o[1]&256&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function hs(l){let e=l[36]+"",t;return{c(){t=V(e)},m(n,o){T(n,t,o)},p(n,o){o[0]&1&&e!==(e=n[36]+"")&&me(t,e)},d(n){n&&C(t)}}}function Gl(l){let e,t,n,o,r,s;t=new Tn({props:{rounded:!0,$$slots:{default:[hs]},$$scope:{ctx:l}}});function a(){return l[18](l[36])}return{c(){e=f("button"),se(t.$$.fragment),n=k(),c(e,"class","tag-button svelte-2smypa"),e.disabled=l[7],c(e,"title","Click to view knowledge graph document")},m(u,d){T(u,e,d),re(t,e,null),i(e,n),o=!0,r||(s=x(e,"click",a),r=!0)},p(u,d){l=u;const m={};d[0]&1|d[1]&256&&(m.$$scope={dirty:d,ctx:l}),t.$set(m),(!o||d[0]&128)&&(e.disabled=l[7])},i(u){o||(E(t.$$.fragment,u),o=!0)},o(u){I(t.$$.fragment,u),o=!1},d(u){u&&C(e),ie(t),r=!1,s()}}}function vs(l){let e,t,n=l[0].tags,o=[];for(let s=0;s<n.length;s+=1)o[s]=Gl(Hl(l,n,s));const r=s=>I(o[s],1,1,()=>{o[s]=null});return{c(){for(let s=0;s<o.length;s+=1)o[s].c();e=Xe()},m(s,a){for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(s,a);T(s,e,a),t=!0},p(s,a){if(a[0]&65665){n=s[0].tags;let u;for(u=0;u<n.length;u+=1){const d=Hl(s,n,u);o[u]?(o[u].p(d,a),E(o[u],1)):(o[u]=Gl(d),o[u].c(),E(o[u],1),o[u].m(e.parentNode,e))}for(Ne(),u=n.length;u<o.length;u+=1)r(u);Oe()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)E(o[a]);t=!0}},o(s){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)I(o[a]);t=!1},d(s){Be(o,s),s&&C(e)}}}function bs(l){let e,t=l[0].rank+"",n;return{c(){e=V("Rank "),n=V(t)},m(o,r){T(o,e,r),T(o,n,r)},p(o,r){r[0]&1&&t!==(t=o[0].rank+"")&&me(n,t)},d(o){o&&C(e),o&&C(n)}}}function ks(l){let e,t;return e=new Tn({props:{rounded:!0,$$slots:{default:[bs]},$$scope:{ctx:l}}}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,o){const r={};o[0]&1|o[1]&256&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function $s(l){let e;return{c(){e=f("small"),e.textContent="No description available",c(e,"class","no-description svelte-2smypa")},m(t,n){T(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&C(e)}}}function ws(l){let e,t;return e=new Qt({props:{source:l[0].description}}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,o){const r={};o[0]&1&&(r.source=n[0].description),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Kl(l){let e,t,n,o,r,s;return{c(){e=f("button"),t=f("span"),t.innerHTML='<i class="fas fa-magic" aria-hidden="true"></i>',n=k(),o=f("span"),o.textContent="AI Summary",c(t,"class","icon is-small"),c(e,"class","button is-small is-info is-outlined ai-summary-button svelte-2smypa"),e.disabled=l[9],c(e,"title","Generate AI-powered summary using OpenRouter")},m(a,u){T(a,e,u),i(e,t),i(e,n),i(e,o),r||(s=x(e,"click",l[17]),r=!0)},p(a,u){u[0]&512&&(e.disabled=a[9])},d(a){a&&C(e),r=!1,s()}}}function Wl(l){let e;return{c(){e=f("div"),e.innerHTML=`<span class="icon"><i class="fas fa-spinner fa-spin" aria-hidden="true"></i></span> 
                <small>Generating AI summary...</small>`,c(e,"class","ai-summary-loading svelte-2smypa")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function zl(l){let e,t,n,o,r,s,a,u,d,m;return{c(){e=f("div"),t=f("span"),t.innerHTML='<i class="fas fa-exclamation-triangle" aria-hidden="true"></i>',n=k(),o=f("small"),r=V("Summary error: "),s=V(l[10]),a=k(),u=f("button"),u.textContent="Retry",c(t,"class","icon has-text-danger"),c(o,"class","has-text-danger"),c(u,"class","button is-small is-text svelte-2smypa"),c(u,"title","Retry generating summary"),c(e,"class","ai-summary-error svelte-2smypa")},m(p,_){T(p,e,_),i(e,t),i(e,n),i(e,o),i(o,r),i(o,s),i(e,a),i(e,u),d||(m=x(u,"click",l[19]),d=!0)},p(p,_){_[0]&1024&&me(s,p[10])},d(p){p&&C(e),d=!1,m()}}}function ql(l){let e,t,n,o,r,s,a,u,d,m,p,_,h,g,$,y,v,b,L,A;function K(N,P){return N[12]?Ss:ys}let j=K(l),w=j(l);return m=new Qt({props:{source:l[8]}}),{c(){e=f("div"),t=f("div"),n=f("small"),o=f("span"),o.innerHTML='<i class="fas fa-robot" aria-hidden="true"></i>',r=V(`
                    AI Summary
                    `),w.c(),s=k(),a=f("button"),a.innerHTML='<span class="icon is-small"><i class="fas fa-times" aria-hidden="true"></i></span>',u=k(),d=f("div"),se(m.$$.fragment),p=k(),_=f("div"),h=f("button"),g=f("span"),g.innerHTML='<i class="fas fa-redo" aria-hidden="true"></i>',$=k(),y=f("span"),y.textContent="Regenerate",c(o,"class","icon is-small"),c(n,"class","ai-summary-label svelte-2smypa"),c(a,"class","button is-small is-text svelte-2smypa"),c(a,"title","Hide AI summary"),c(t,"class","ai-summary-header svelte-2smypa"),c(d,"class","ai-summary-content svelte-2smypa"),c(g,"class","icon is-small"),c(h,"class","button is-small is-text svelte-2smypa"),h.disabled=l[9],c(h,"title","Regenerate summary"),c(_,"class","ai-summary-actions svelte-2smypa"),c(e,"class","ai-summary svelte-2smypa")},m(N,P){T(N,e,P),i(e,t),i(t,n),i(n,o),i(n,r),w.m(n,null),i(t,s),i(t,a),i(e,u),i(e,d),re(m,d,null),i(e,p),i(e,_),i(_,h),i(h,g),i(h,$),i(h,y),b=!0,L||(A=[x(a,"click",l[20]),x(h,"click",l[21])],L=!0)},p(N,P){j!==(j=K(N))&&(w.d(1),w=j(N),w&&(w.c(),w.m(n,null)));const q={};P[0]&256&&(q.source=N[8]),m.$set(q),(!b||P[0]&512)&&(h.disabled=N[9])},i(N){b||(E(m.$$.fragment,N),nt(()=>{b&&(v||(v=Ut(e,Et,{},!0)),v.run(1))}),b=!0)},o(N){I(m.$$.fragment,N),v||(v=Ut(e,Et,{},!1)),v.run(0),b=!1},d(N){N&&C(e),w.d(),ie(m),N&&v&&v.end(),L=!1,Je(A)}}}function ys(l){let e;return{c(){e=f("span"),e.textContent="fresh",c(e,"class","tag is-small is-success")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function Ss(l){let e;return{c(){e=f("span"),e.textContent="cached",c(e,"class","tag is-small is-light")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function Bl(l){let e;function t(r,s){return r[33].disabled?Rs:r[33].isLink?Ts:Cs}let n=t(l),o=n(l);return{c(){o.c(),e=Xe()},m(r,s){o.m(r,s),T(r,e,s)},p(r,s){n===(n=t(r))&&o?o.p(r,s):(o.d(1),o=n(r),o&&(o.c(),o.m(e.parentNode,e)))},d(r){o.d(r),r&&C(e)}}}function Cs(l){let e,t,n,o,r,s,a,u,d;return{c(){e=f("button"),t=f("span"),n=f("i"),r=k(),c(n,"class",o=ht(l[33].icon)+" svelte-2smypa"),c(t,"class","icon is-medium"),rt(t,"has-text-primary",l[33].className),c(e,"type","button"),c(e,"class","level-item button is-ghost svelte-2smypa"),c(e,"aria-label",s=l[33].title),c(e,"title",a=l[33].title)},m(m,p){T(m,e,p),i(e,t),i(t,n),i(e,r),u||(d=x(e,"click",function(){Bn(l[33].action)&&l[33].action.apply(this,arguments)}),u=!0)},p(m,p){l=m,p[0]&16384&&o!==(o=ht(l[33].icon)+" svelte-2smypa")&&c(n,"class",o),p[0]&16384&&rt(t,"has-text-primary",l[33].className),p[0]&16384&&s!==(s=l[33].title)&&c(e,"aria-label",s),p[0]&16384&&a!==(a=l[33].title)&&c(e,"title",a)},d(m){m&&C(e),u=!1,d()}}}function Ts(l){let e,t,n,o,r,s,a,u;return{c(){e=f("a"),t=f("span"),n=f("i"),r=k(),c(n,"class",o=ht(l[33].icon)+" svelte-2smypa"),c(t,"class","icon is-medium"),rt(t,"has-text-primary",l[33].className),c(e,"href",s=l[33].href),c(e,"target","_blank"),c(e,"class","level-item"),c(e,"aria-label",a=l[33].title),c(e,"title",u=l[33].title)},m(d,m){T(d,e,m),i(e,t),i(t,n),i(e,r)},p(d,m){m[0]&16384&&o!==(o=ht(d[33].icon)+" svelte-2smypa")&&c(n,"class",o),m[0]&16384&&rt(t,"has-text-primary",d[33].className),m[0]&16384&&s!==(s=d[33].href)&&c(e,"href",s),m[0]&16384&&a!==(a=d[33].title)&&c(e,"aria-label",a),m[0]&16384&&u!==(u=d[33].title)&&c(e,"title",u)},d(d){d&&C(e)}}}function Rs(l){let e,t,n,o,r,s,a;return{c(){e=f("button"),t=f("span"),n=f("i"),r=k(),c(n,"class",o=ht(l[33].icon)+" svelte-2smypa"),c(t,"class","icon is-medium"),rt(t,"has-text-primary",l[33].className),c(e,"type","button"),c(e,"class","level-item button is-ghost svelte-2smypa"),c(e,"aria-label",s=l[33].title),c(e,"title",a=l[33].title),e.disabled=!0},m(u,d){T(u,e,d),i(e,t),i(t,n),i(e,r)},p(u,d){d[0]&16384&&o!==(o=ht(u[33].icon)+" svelte-2smypa")&&c(n,"class",o),d[0]&16384&&rt(t,"has-text-primary",u[33].className),d[0]&16384&&s!==(s=u[33].title)&&c(e,"aria-label",s),d[0]&16384&&a!==(a=u[33].title)&&c(e,"title",a)},d(u){u&&C(e)}}}function Jl(l){let e,t=l[33].visible&&Bl(l);return{c(){t&&t.c(),e=Xe()},m(n,o){t&&t.m(n,o),T(n,e,o)},p(n,o){n[33].visible?t?t.p(n,o):(t=Bl(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){t&&t.d(n),n&&C(e)}}}function Vl(l){let e,t,n;function o(s){l[23](s)}let r={item:l[4],kgTerm:l[5],kgRank:l[6]};return l[2]!==void 0&&(r.active=l[2]),e=new sl({props:r}),Ae.push(()=>Ie(e,"active",o)),{c(){se(e.$$.fragment)},m(s,a){re(e,s,a),n=!0},p(s,a){const u={};a[0]&16&&(u.item=s[4]),a[0]&32&&(u.kgTerm=s[5]),a[0]&64&&(u.kgRank=s[6]),!t&&a[0]&4&&(t=!0,u.active=s[2],je(()=>t=!1)),e.$set(u)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){ie(e,s)}}}function Yl(l){let e,t,n;function o(s){l[24](s)}let r={document:l[0]};return l[3]!==void 0&&(r.active=l[3]),e=new fs({props:r}),Ae.push(()=>Ie(e,"active",o)),{c(){se(e.$$.fragment)},m(s,a){re(e,s,a),n=!0},p(s,a){const u={};a[0]&1&&(u.document=s[0]),!t&&a[0]&8&&(t=!0,u.active=s[3],je(()=>t=!1)),e.$set(u)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){ie(e,s)}}}function Ls(l){let e,t,n,o,r,s,a,u,d,m,p,_,h=l[0].title+"",g,$,y,v,b,L,A,K,j,w,N,P,q,J,M,S,Y,U,Z,F,G,Q,R,W,X,O,H,B,oe,pe,ae=l[0].tags&&Fl(l);u=new Cn({props:{$$slots:{default:[ks]},$$scope:{ctx:l}}});const Ue=[ws,$s],we=[];function ge(z,ce){return z[0].description?0:1}A=ge(l),K=we[A]=Ue[A](l);let ue=!l[11]&&!l[9]&&!l[10]&&Kl(l),Ce=l[9]&&Wl(),be=l[10]&&zl(l),D=l[11]&&l[8]&&ql(l),ee=l[14],le=[];for(let z=0;z<ee.length;z+=1)le[z]=Jl(jl(l,ee,z));function he(z){l[22](z)}let fe={item:l[0]};l[1]!==void 0&&(fe.active=l[1]),R=new sl({props:fe}),Ae.push(()=>Ie(R,"active",he));let ne=l[4]&&Vl(l),$e=l[13]&&Yl(l);return{c(){e=f("div"),t=f("article"),n=f("div"),o=f("div"),r=f("div"),ae&&ae.c(),s=k(),a=f("div"),se(u.$$.fragment),d=k(),m=f("div"),p=f("button"),_=f("h2"),g=V(h),$=k(),y=f("div"),v=f("small"),v.textContent="Description:",b=k(),L=f("div"),K.c(),j=k(),w=f("div"),ue&&ue.c(),N=k(),Ce&&Ce.c(),P=k(),be&&be.c(),q=k(),D&&D.c(),J=k(),M=f("br"),Y=k(),U=f("div"),Z=f("nav"),F=f("div");for(let z=0;z<le.length;z+=1)le[z].c();Q=k(),se(R.$$.fragment),X=k(),ne&&ne.c(),O=k(),$e&&$e.c(),H=Xe(),c(r,"class","level-right"),c(a,"class","level-right"),c(_,"class","title svelte-2smypa"),c(p,"class","svelte-2smypa"),c(v,"class","description-label svelte-2smypa"),c(L,"class","description-content svelte-2smypa"),c(y,"class","description svelte-2smypa"),c(w,"class","ai-summary-section svelte-2smypa"),c(o,"class","content"),c(F,"class","level-right"),c(Z,"class","level is-mobile"),c(U,"class","level-right"),c(n,"class","media-content"),c(t,"class","media"),c(e,"class","box")},m(z,ce){T(z,e,ce),i(e,t),i(t,n),i(n,o),i(o,r),ae&&ae.m(r,null),i(o,s),i(o,a),re(u,a,null),i(o,d),i(o,m),i(m,p),i(p,_),i(_,g),i(m,$),i(m,y),i(y,v),i(y,b),i(y,L),we[A].m(L,null),i(m,j),i(m,w),ue&&ue.m(w,null),i(w,N),Ce&&Ce.m(w,null),i(w,P),be&&be.m(w,null),i(w,q),D&&D.m(w,null),i(m,J),i(m,M),i(n,Y),i(n,U),i(U,Z),i(Z,F);for(let ye=0;ye<le.length;ye+=1)le[ye]&&le[ye].m(F,null);T(z,Q,ce),re(R,z,ce),T(z,X,ce),ne&&ne.m(z,ce),T(z,O,ce),$e&&$e.m(z,ce),T(z,H,ce),B=!0,oe||(pe=x(p,"click",l[15]),oe=!0)},p(z,ce){z[0].tags?ae?(ae.p(z,ce),ce[0]&1&&E(ae,1)):(ae=Fl(z),ae.c(),E(ae,1),ae.m(r,null)):ae&&(Ne(),I(ae,1,1,()=>{ae=null}),Oe());const ye={};ce[0]&1|ce[1]&256&&(ye.$$scope={dirty:ce,ctx:z}),u.$set(ye),(!B||ce[0]&1)&&h!==(h=z[0].title+"")&&me(g,h);let Te=A;if(A=ge(z),A===Te?we[A].p(z,ce):(Ne(),I(we[Te],1,1,()=>{we[Te]=null}),Oe(),K=we[A],K?K.p(z,ce):(K=we[A]=Ue[A](z),K.c()),E(K,1),K.m(L,null)),!z[11]&&!z[9]&&!z[10]?ue?ue.p(z,ce):(ue=Kl(z),ue.c(),ue.m(w,N)):ue&&(ue.d(1),ue=null),z[9]?Ce||(Ce=Wl(),Ce.c(),Ce.m(w,P)):Ce&&(Ce.d(1),Ce=null),z[10]?be?be.p(z,ce):(be=zl(z),be.c(),be.m(w,q)):be&&(be.d(1),be=null),z[11]&&z[8]?D?(D.p(z,ce),ce[0]&2304&&E(D,1)):(D=ql(z),D.c(),E(D,1),D.m(w,null)):D&&(Ne(),I(D,1,1,()=>{D=null}),Oe()),ce[0]&16384){ee=z[14];let Le;for(Le=0;Le<ee.length;Le+=1){const xe=jl(z,ee,Le);le[Le]?le[Le].p(xe,ce):(le[Le]=Jl(xe),le[Le].c(),le[Le].m(F,null))}for(;Le<le.length;Le+=1)le[Le].d(1);le.length=ee.length}const Ve={};ce[0]&1&&(Ve.item=z[0]),!W&&ce[0]&2&&(W=!0,Ve.active=z[1],je(()=>W=!1)),R.$set(Ve),z[4]?ne?(ne.p(z,ce),ce[0]&16&&E(ne,1)):(ne=Vl(z),ne.c(),E(ne,1),ne.m(O.parentNode,O)):ne&&(Ne(),I(ne,1,1,()=>{ne=null}),Oe()),z[13]?$e?($e.p(z,ce),ce[0]&8192&&E($e,1)):($e=Yl(z),$e.c(),E($e,1),$e.m(H.parentNode,H)):$e&&(Ne(),I($e,1,1,()=>{$e=null}),Oe())},i(z){B||(E(ae),E(u.$$.fragment,z),E(K),E(D),nt(()=>{B&&(S||(S=Ut(m,Et,{},!0)),S.run(1))}),nt(()=>{B&&(G||(G=Ut(Z,Et,{},!0)),G.run(1))}),E(R.$$.fragment,z),E(ne),E($e),B=!0)},o(z){I(ae),I(u.$$.fragment,z),I(K),I(D),S||(S=Ut(m,Et,{},!1)),S.run(0),G||(G=Ut(Z,Et,{},!1)),G.run(0),I(R.$$.fragment,z),I(ne),I($e),B=!1},d(z){z&&C(e),ae&&ae.d(),ie(u),we[A].d(),ue&&ue.d(),Ce&&Ce.d(),be&&be.d(),D&&D.d(),z&&S&&S.end(),Be(le,z),z&&G&&G.end(),z&&C(Q),ie(R,z),z&&C(X),ne&&ne.d(z),z&&C(O),$e&&$e.d(z),z&&C(H),oe=!1,pe()}}}function Ns(l,e,t){let n,o,r,s,a;ke(l,gt,R=>t(25,r=R)),ke(l,ze,R=>t(26,s=R)),ke(l,Ye,R=>t(27,a=R));let{document:u}=e,d=!1,m=!1,p=!1,_=null,h=null,g=null,$=!1,y=null,v=!1,b=null,L=!1,A=!1;function K(){const R=[];return R.push({id:"download-markdown",label:"Download to Markdown",icon:"fas fa-download",action:()=>J(),visible:!0,title:"Download document as markdown file"}),n&&R.push({id:"save-atomic",label:"Save to Atomic Server",icon:"fas fa-cloud-upload-alt",action:()=>N(),visible:!0,title:"Save article to Atomic Server",className:"has-text-primary"}),u.url&&R.push({id:"external-url",label:"Open URL",icon:"fas fa-link",action:()=>window.open(u.url,"_blank"),visible:!0,title:"Open original URL in new tab",isLink:!0,href:u.url}),R.push({id:"open-vscode",label:"Open in VSCode",icon:"fas fa-code",action:()=>M(),visible:!0,title:"Open document in VSCode",isLink:!0,href:`vscode://${encodeURIComponent(u.title)}.md?${encodeURIComponent(u.body)}`}),R.push({id:"add-favorites",label:"Add to Favorites",icon:"fas fa-plus",action:()=>{},visible:!0,title:"Add to favorites (coming soon)",disabled:!0}),R}function j(){var H;const R=r,W=a;if(!(W!=null&&W.roles)||!R)return!1;let X=null;try{for(const[B,oe]of Object.entries(W.roles)){const pe=oe,ae=typeof pe.name=="object"?pe.name.original:String(pe.name);if(B===R||ae===R){X=pe;break}}}catch(B){return console.warn("Error checking role configuration:",B),!1}return X?(((H=X.haystacks)==null?void 0:H.filter(B=>B.service==="Atomic"&&B.location&&!B.read_only))||[]).length>0:!1}const w=()=>{t(1,d=!0)},N=()=>{console.log("🔄 Opening atomic save modal for document:",u.title),t(3,p=!0)};async function P(R){var W,X,O,H,B;t(7,$=!0),t(5,h=R),console.log("🔍 KG Search Debug Info:"),console.log("  Tag clicked:",R),console.log("  Current role:",r),console.log("  Is Tauri mode:",s);try{if(s){console.log("  Making Tauri invoke call..."),console.log("  Tauri command: find_documents_for_kg_term"),console.log("  Tauri params:",{roleName:r,term:R});const oe=await Pe("find_documents_for_kg_term",{roleName:r,term:R});console.log("  📥 Tauri response received:"),console.log("    Status:",oe.status),console.log("    Results count:",((W=oe.results)==null?void 0:W.length)||0),console.log("    Total:",oe.total||0),console.log("    Full response:",JSON.stringify(oe,null,2)),oe.status==="success"&&oe.results&&oe.results.length>0?(t(4,_=oe.results[0]),t(6,g=_.rank||0),console.log("  ✅ Found KG document:"),console.log("    Title:",_.title),console.log("    Rank:",g),console.log("    Body length:",((X=_.body)==null?void 0:X.length)||0,"characters"),t(2,m=!0)):(console.warn(`  ⚠️  No KG documents found for term: "${R}" in role: "${r}"`),console.warn("    This could indicate:"),console.warn("    1. Knowledge graph not built for this role"),console.warn("    2. Term not found in knowledge graph"),console.warn("    3. Role not configured with TerraphimGraph relevance function"),console.warn("    Suggestion: Check server logs for KG building status"))}else{console.log("  Making HTTP fetch call...");const oe=tt.ServerURL,pe=encodeURIComponent(r),ae=encodeURIComponent(R),Ue=`${oe}/roles/${pe}/kg_search?term=${ae}`;console.log("  📤 HTTP Request details:"),console.log("    Base URL:",oe),console.log("    Role (encoded):",pe),console.log("    Term (encoded):",ae),console.log("    Full URL:",Ue);const we=await fetch(Ue);if(console.log("  📥 HTTP Response received:"),console.log("    Status code:",we.status),console.log("    Status text:",we.statusText),console.log("    Headers:",Object.fromEntries(we.headers.entries())),!we.ok)throw new Error(`HTTP error! Status: ${we.status} - ${we.statusText}`);const ge=await we.json();console.log("  📄 Response data:"),console.log("    Status:",ge.status),console.log("    Results count:",((O=ge.results)==null?void 0:O.length)||0),console.log("    Total:",ge.total||0),console.log("    Full response:",JSON.stringify(ge,null,2)),ge.status==="success"&&ge.results&&ge.results.length>0?(t(4,_=ge.results[0]),t(6,g=_.rank||0),console.log("  ✅ Found KG document:"),console.log("    Title:",_.title),console.log("    Rank:",g),console.log("    Body length:",((H=_.body)==null?void 0:H.length)||0,"characters"),t(2,m=!0)):(console.warn(`  ⚠️  No KG documents found for term: "${R}" in role: "${r}"`),console.warn("    This could indicate:"),console.warn("    1. Server not configured with Terraphim Engineer role"),console.warn("    2. Knowledge graph not built on server"),console.warn("    3. Term not found in knowledge graph"),console.warn("    Suggestion: Check server logs at startup for KG building status"),console.warn("    API URL tested:",Ue))}}catch(oe){console.error("❌ Error fetching KG document:"),console.error("  Error type:",oe.constructor.name),console.error("  Error message:",oe.message||oe),console.error("  Request details:",{tag:R,role:r,isTauri:s,timestamp:new Date().toISOString()}),!s&&((B=oe.message)!=null&&B.includes("Failed to fetch"))&&(console.error("  💡 Network error suggestions:"),console.error("    1. Check if server is running on expected port"),console.error("    2. Check CORS configuration"),console.error("    3. Verify server URL in CONFIG.ServerURL"))}finally{t(7,$=!1)}}async function q(){var R;if(!(v||!u.id||!r)){t(9,v=!0),t(10,b=null),console.log("🤖 AI Summary Debug Info:"),console.log("  Document ID:",u.id),console.log("  Current role:",r),console.log("  Is Tauri mode:",s);try{const W={document_id:u.id,role:r,max_length:250,force_regenerate:!1};console.log("  📤 Summarization request:",W);let X;if(s){const B=`${tt.ServerURL}/documents/summarize`;X=await fetch(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(W)})}else{const B=`${tt.ServerURL}/documents/summarize`;X=await fetch(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(W)})}if(console.log("  📥 Summary response received:"),console.log("    Status code:",X.status),console.log("    Status text:",X.statusText),!X.ok)throw new Error(`HTTP error! Status: ${X.status} - ${X.statusText}`);const O=await X.json();console.log("  📄 Summary response data:",O),O.status==="Success"&&O.summary?(t(8,y=O.summary),t(12,A=O.from_cache||!1),t(11,L=!0),console.log("  ✅ Summary generated successfully"),console.log("    Summary length:",y.length,"characters"),console.log("    From cache:",A),console.log("    Model used:",O.model_used)):(t(10,b=O.error||"Failed to generate summary"),console.error("  ❌ Summary generation failed:",b))}catch(W){console.error("❌ Error generating summary:"),console.error("  Error type:",W.constructor.name),console.error("  Error message:",W.message||W),console.error("  Request details:",{document_id:u.id,role:r,isTauri:s,timestamp:new Date().toISOString()}),t(10,b=W.message||"Network error occurred"),(R=W.message)!=null&&R.includes("Failed to fetch")&&(console.error("  💡 Network error suggestions:"),console.error("    1. Check if server is running on expected port"),console.error("    2. Verify OpenRouter is enabled for this role"),console.error("    3. Check OPENROUTER_KEY environment variable"),console.error("    4. Verify server URL in CONFIG.ServerURL"))}finally{t(9,v=!1)}}}function J(){console.log("📥 Downloading document as markdown:",u.title);let R=`# ${u.title}

`;R+=`**Source:** Terraphim Search
`,R+=`**Rank:** ${u.rank}
`,u.url&&(R+=`**URL:** ${u.url}
`),u.tags&&u.tags.length>0&&(R+=`**Tags:** ${u.tags.join(", ")}
`),R+=`**Downloaded:** ${new Date().toISOString()}

`,u.description&&(R+=`## Description

${u.description}

`),R+=`## Content

${u.body}
`;const W=`${u.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${Date.now()}.md`,X=new Blob([R],{type:"text/markdown"}),O=URL.createObjectURL(X),H=window.document.createElement("a");H.href=O,H.download=W,window.document.body.appendChild(H),H.click(),window.document.body.removeChild(H),URL.revokeObjectURL(O),console.log("✅ Markdown file downloaded:",W)}function M(){const R=`vscode://${encodeURIComponent(u.title)}.md?${encodeURIComponent(u.body)}`;window.open(R,"_blank")}Jt[r]!==void 0&&(console.log("Have attribute",Jt[r]),Jt[r].hasOwnProperty("enableLogseq")?console.log("enable logseq True"):console.log("Didn't make it"));const S=R=>P(R),Y=()=>{t(10,b=null),q()},U=()=>t(11,L=!1),Z=()=>{q()};function F(R){d=R,t(1,d)}function G(R){m=R,t(2,m)}function Q(R){p=R,t(3,p)}return l.$$set=R=>{"document"in R&&t(0,u=R.document)},t(13,n=j()),t(14,o=K()),[u,d,m,p,_,h,g,$,y,v,b,L,A,n,o,w,P,q,S,Y,U,Z,F,G,Q]}class Os extends Qe{constructor(e){super(),Ze(this,e,Ns,Ls,qe,{document:0},null,[-1,-1])}}const As="/assets/terraphim_gray.png";function Ql(l,e,t){const n=l.slice();return n[20]=e[t],n}function Zl(l,e,t){const n=l.slice();return n[23]=e[t],n[25]=t,n}function Xl(l){let e,t=l[2],n=[];for(let o=0;o<t.length;o+=1)n[o]=xl(Zl(l,t,o));return{c(){e=f("ul");for(let o=0;o<n.length;o+=1)n[o].c();c(e,"class","suggestions svelte-13t09eu")},m(o,r){T(o,e,r);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(e,null)},p(o,r){if(r&524){t=o[2];let s;for(s=0;s<t.length;s+=1){const a=Zl(o,t,s);n[s]?n[s].p(a,r):(n[s]=xl(a),n[s].c(),n[s].m(e,null))}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length}},d(o){o&&C(e),Be(n,o)}}}function xl(l){let e,t=l[23]+"",n,o,r,s,a,u;function d(){return l[13](l[23])}function m(...p){return l[14](l[23],...p)}return{c(){e=f("li"),n=V(t),o=k(),c(e,"tabindex","0"),c(e,"role","option"),c(e,"aria-selected",r=l[25]===l[3]),c(e,"aria-label",s=`Apply suggestion: ${l[23]}`),c(e,"class","svelte-13t09eu"),rt(e,"active",l[25]===l[3])},m(p,_){T(p,e,_),i(e,n),i(e,o),a||(u=[x(e,"click",d),x(e,"keydown",m)],a=!0)},p(p,_){l=p,_&4&&t!==(t=l[23]+"")&&me(n,t),_&8&&r!==(r=l[25]===l[3])&&c(e,"aria-selected",r),_&4&&s!==(s=`Apply suggestion: ${l[23]}`)&&c(e,"aria-label",s),_&8&&rt(e,"active",l[25]===l[3])},d(p){p&&C(e),a=!1,Je(u)}}}function Us(l){let e,t,n,o,r;function s(d){l[12](d)}let a={type:"search",placeholder:l[6]?`Search over Knowledge graph for ${l[4]}`:"Search",icon:"search",expanded:!0,autofocus:!0};l[5]!==void 0&&(a.value=l[5]),t=new Ct({props:a}),Ae.push(()=>Ie(t,"value",s)),t.$on("click",l[10]),t.$on("submit",l[10]),t.$on("keydown",l[8]),t.$on("input",l[7]);let u=l[2].length>0&&Xl(l);return{c(){e=f("div"),se(t.$$.fragment),o=k(),u&&u.c(),c(e,"class","input-wrapper svelte-13t09eu")},m(d,m){T(d,e,m),re(t,e,null),i(e,o),u&&u.m(e,null),r=!0},p(d,m){const p={};m&80&&(p.placeholder=d[6]?`Search over Knowledge graph for ${d[4]}`:"Search"),!n&&m&32&&(n=!0,p.value=d[5],je(()=>n=!1)),t.$set(p),d[2].length>0?u?u.p(d,m):(u=Xl(d),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(d){r||(E(t.$$.fragment,d),r=!0)},o(d){I(t.$$.fragment,d),r=!1},d(d){d&&C(e),ie(t),u&&u.d()}}}function Es(l){let e,t,n,o,r,s,a,u,d,m;return{c(){e=f("section"),t=f("div"),n=f("img"),r=k(),s=f("p"),s.textContent="I am Terraphim, your personal assistant.",a=k(),u=f("button"),u.innerHTML=`<span class="icon"><i class="fas fa-magic"></i></span> 
        <span>Configuration Wizard</span>`,Yn(n.src,o=As)||c(n,"src",o),c(n,"alt","Terraphim Logo"),c(n,"class","svelte-13t09eu"),c(u,"class","button is-primary"),c(u,"data-testid","wizard-start"),c(t,"class","content has-text-grey has-text-centered svelte-13t09eu"),c(e,"class","section")},m(p,_){T(p,e,_),i(e,t),i(t,n),i(t,r),i(t,s),i(t,a),i(t,u),d||(m=x(u,"click",l[15]),d=!0)},p:ve,i:ve,o:ve,d(p){p&&C(e),d=!1,m()}}}function Ds(l){let e,t,n=l[0],o=[];for(let s=0;s<n.length;s+=1)o[s]=en(Ql(l,n,s));const r=s=>I(o[s],1,1,()=>{o[s]=null});return{c(){for(let s=0;s<o.length;s+=1)o[s].c();e=Xe()},m(s,a){for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(s,a);T(s,e,a),t=!0},p(s,a){if(a&1){n=s[0];let u;for(u=0;u<n.length;u+=1){const d=Ql(s,n,u);o[u]?(o[u].p(d,a),E(o[u],1)):(o[u]=en(d),o[u].c(),E(o[u],1),o[u].m(e.parentNode,e))}for(Ne(),u=n.length;u<o.length;u+=1)r(u);Oe()}},i(s){if(!t){for(let a=0;a<n.length;a+=1)E(o[a]);t=!0}},o(s){o=o.filter(Boolean);for(let a=0;a<o.length;a+=1)I(o[a]);t=!1},d(s){Be(o,s),s&&C(e)}}}function Ms(l){let e,t;return{c(){e=f("p"),t=V(l[1]),c(e,"class","error svelte-13t09eu")},m(n,o){T(n,e,o),i(e,t)},p(n,o){o&2&&me(t,n[1])},i:ve,o:ve,d(n){n&&C(e)}}}function en(l){let e,t;return e=new Os({props:{document:l[20]}}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},p(n,o){const r={};o&1&&(r.document=n[20]),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Ps(l){let e,t,n,o,r,s,a,u,d;t=new mt({props:{$$slots:{default:[Us]},$$scope:{ctx:l}}});const m=[Ms,Ds,Es],p=[];function _(h,g){return h[1]?0:h[0].length?1:2}return o=_(l),r=p[o]=m[o](l),{c(){e=f("form"),se(t.$$.fragment),n=k(),r.c(),s=Xe()},m(h,g){T(h,e,g),re(t,e,null),T(h,n,g),p[o].m(h,g),T(h,s,g),a=!0,u||(d=x(e,"submit",Jn(l[10])),u=!0)},p(h,[g]){const $={};g&67108988&&($.$$scope={dirty:g,ctx:h}),t.$set($);let y=o;o=_(h),o===y?p[o].p(h,g):(Ne(),I(p[y],1,1,()=>{p[y]=null}),Oe(),r=p[o],r?r.p(h,g):(r=p[o]=m[o](h),r.c()),E(r,1),r.m(s.parentNode,s))},i(h){a||(E(t.$$.fragment,h),E(r),a=!0)},o(h){I(t.$$.fragment,h),I(r),a=!1},d(h){h&&C(e),ie(t),h&&C(n),p[o].d(h),h&&C(s),u=!1,d()}}}function Is(l,e,t){let n,o,r,s,a,u,d;ke(l,go,w=>t(17,o=w)),ke(l,gt,w=>t(4,r=w)),ke(l,xt,w=>t(5,s=w)),ke(l,ze,w=>t(18,a=w)),ke(l,el,w=>t(11,u=w)),ke(l,jt,w=>t(6,d=w));let m=[],p=null,_=[],h=-1;function g(w){const N=w.trim().toLowerCase();return N.length===0?[]:n.filter(([q])=>q.toLowerCase().includes(N)).map(([q])=>q).slice(0,5)}function $(w){const N=w.target;if(!N||N.selectionStart==null)return;const P=N.selectionStart,J=s.slice(0,P).split(/\s+/),M=J[J.length-1];t(2,_=g(M)),t(3,h=-1)}function y(w){_.length!==0&&(w.key==="ArrowDown"?(w.preventDefault(),t(3,h=(h+1)%_.length)):w.key==="ArrowUp"?(w.preventDefault(),t(3,h=(h-1+_.length)%_.length)):(w.key==="Enter"||w.key==="Tab")&&h!==-1&&(w.preventDefault(),v(_[h])))}function v(w){var S;const N=document.querySelector('input[type="search"]'),P=(N==null?void 0:N.selectionStart)??0,q=s.slice(0,P),J=s.slice(P),M=q.split(/\s+/);M[M.length-1]=w,Vn(xt,s=[...M,J].join(" "),s),(S=N==null?void 0:N.setSelectionRange)==null||S.call(N,P+w.length,P+w.length),t(2,_=[]),t(3,h=-1)}async function b(){if(t(1,p=null),a)try{const w=await Pe("search",{searchQuery:{search_term:s,skip:0,limit:10,role:r}});w.status==="success"?(t(0,m=w.results),console.log("Response results"),console.log(m)):(t(1,p=`Search failed: ${w.status}`),console.error("Search failed:",w))}catch(w){t(1,p=`Error in Tauri search: ${w}`),console.error("Error in Tauri search:",w)}else{if(!s.trim())return;const w=JSON.stringify({search_term:s,skip:0,limit:10,role:r});try{const N=await fetch(o,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:w}),P=await N.json();if(!N.ok)throw new Error(`HTTP error! Status: ${N.status}`);t(0,m=P.results)}catch(N){console.error("Error fetching data:",N),t(1,p=`Error fetching data: ${N}`)}}}function L(w){s=w,xt.set(s)}const A=w=>v(w),K=(w,N)=>{(N.key==="Enter"||N.key===" ")&&(N.preventDefault(),v(w))},j=()=>window.location.href="/config/wizard";return l.$$.update=()=>{l.$$.dirty&2048&&(n=Object.entries(u))},[m,p,_,h,r,s,d,$,y,v,b,u,L,A,K,j]}class js extends Qe{constructor(e){super(),Ze(this,e,Is,Ps,qe,{})}}function tn(l,e,t){const n=l.slice();return n[48]=e[t],n[53]=t,n}function ln(l,e,t){const n=l.slice();return n[51]=e[t],n[52]=e,n[53]=t,n}function nn(l,e,t){const n=l.slice();return n[54]=e[t],n[55]=e,n[56]=t,n}function on(l,e,t){const n=l.slice();return n[57]=e[t][0],n[58]=e[t][1],n[59]=e,n[60]=t,n}function sn(l,e,t){const n=l.slice();return n[48]=e[t],n}function rn(l){let e,t,n,o,r;return{c(){e=f("div"),t=f("button"),n=V(`
      Configuration saved successfully!`),c(t,"class","delete"),c(e,"class","notification is-success"),c(e,"data-testid","wizard-success")},m(s,a){T(s,e,a),i(e,t),i(e,n),o||(r=x(t,"click",l[14]),o=!0)},p:ve,d(s){s&&C(e),o=!1,r()}}}function an(l){let e,t,n,o,r;return{c(){e=f("div"),t=f("button"),n=V(`
      Failed to save configuration. Please try again.`),c(t,"class","delete"),c(e,"class","notification is-danger"),c(e,"data-testid","wizard-error")},m(s,a){T(s,e,a),i(e,t),i(e,n),o||(r=x(t,"click",l[15]),o=!0)},p:ve,d(s){s&&C(e),o=!1,r()}}}function Hs(l){let e,t,n,o,r,s,a,u,d,m=l[2].id+"",p,_,h,g,$,y=l[2].global_shortcut+"",v,b,L,A,K,j=l[2].default_theme+"",w,N,P,q,J,M=l[2].default_role+"",S,Y,U,Z,F,G,Q=JSON.stringify(l[2],null,2)+"",R,W=l[2].roles,X=[];for(let O=0;O<W.length;O+=1)X[O]=un(tn(l,W,O));return{c(){e=f("h4"),e.textContent="Review",t=k(),n=f("div"),o=f("h5"),o.textContent="Configuration Summary:",r=k(),s=f("ul"),a=f("li"),u=f("strong"),u.textContent="Configuration ID:",d=k(),p=V(m),_=k(),h=f("li"),g=f("strong"),g.textContent="Global Shortcut:",$=k(),v=V(y),b=k(),L=f("li"),A=f("strong"),A.textContent="Default Theme:",K=k(),w=V(j),N=k(),P=f("li"),q=f("strong"),q.textContent="Default Role:",J=k(),S=V(M),Y=k(),U=f("h5"),U.textContent="Roles:",Z=k();for(let O=0;O<X.length;O+=1)X[O].c();F=k(),G=f("pre"),R=V(Q),c(e,"class","title is-5"),c(n,"class","content"),St(G,"max-height","300px"),St(G,"overflow","auto")},m(O,H){T(O,e,H),T(O,t,H),T(O,n,H),i(n,o),i(n,r),i(n,s),i(s,a),i(a,u),i(a,d),i(a,p),i(s,_),i(s,h),i(h,g),i(h,$),i(h,v),i(s,b),i(s,L),i(L,A),i(L,K),i(L,w),i(s,N),i(s,P),i(P,q),i(P,J),i(P,S),i(n,Y),i(n,U),i(n,Z);for(let B=0;B<X.length;B+=1)X[B]&&X[B].m(n,null);T(O,F,H),T(O,G,H),i(G,R)},p(O,H){if(H[0]&4&&m!==(m=O[2].id+"")&&me(p,m),H[0]&4&&y!==(y=O[2].global_shortcut+"")&&me(v,y),H[0]&4&&j!==(j=O[2].default_theme+"")&&me(w,j),H[0]&4&&M!==(M=O[2].default_role+"")&&me(S,M),H[0]&5){W=O[2].roles;let B;for(B=0;B<W.length;B+=1){const oe=tn(O,W,B);X[B]?X[B].p(oe,H):(X[B]=un(oe),X[B].c(),X[B].m(n,null))}for(;B<X.length;B+=1)X[B].d(1);X.length=W.length}H[0]&4&&Q!==(Q=JSON.stringify(O[2],null,2)+"")&&me(R,Q)},d(O){O&&C(e),O&&C(t),O&&C(n),Be(X,O),O&&C(F),O&&C(G)}}}function Fs(l){let e,t,n=[],o=new Map,r,s,a,u,d=l[2].roles;const m=p=>p[51].name;for(let p=0;p<d.length;p+=1){let _=ln(l,d,p),h=m(_);o.set(h,n[p]=mn(h,_))}return{c(){e=f("h4"),e.textContent="Roles",t=k();for(let p=0;p<n.length;p+=1)n[p].c();r=k(),s=f("button"),s.textContent="Add Role",c(e,"class","title is-5"),c(s,"class","button is-link is-light"),c(s,"data-testid","add-role")},m(p,_){T(p,e,_),T(p,t,_);for(let h=0;h<n.length;h+=1)n[h]&&n[h].m(p,_);T(p,r,_),T(p,s,_),a||(u=x(s,"click",l[6]),a=!0)},p(p,_){_[0]&8068&&(d=p[2].roles,n=Qn(n,_,m,1,p,d,o,r.parentNode,Zn,mn,r,ln))},d(p){p&&C(e),p&&C(t);for(let _=0;_<n.length;_+=1)n[_].d(p);p&&C(r),p&&C(s),a=!1,u()}}}function Gs(l){let e,t,n,o,r,s,a,u,d,m,p,_,h,g,$,y,v,b,L,A,K,j,w,N,P,q,J,M,S,Y,U=l[2].roles,Z=[];for(let F=0;F<U.length;F+=1)Z[F]=gn(sn(l,U,F));return{c(){e=f("div"),t=f("label"),t.textContent="Configuration ID",n=k(),o=f("div"),r=f("div"),s=f("select"),a=f("option"),a.textContent="Desktop",u=f("option"),u.textContent="Server",d=f("option"),d.textContent="Embedded",m=k(),p=f("div"),_=f("label"),_.textContent="Global shortcut",h=k(),g=f("div"),$=f("input"),y=k(),v=f("div"),b=f("label"),b.textContent="Default theme",L=k(),A=f("div"),K=f("input"),j=k(),w=f("div"),N=f("label"),N.textContent="Default Role",P=k(),q=f("div"),J=f("div"),M=f("select");for(let F=0;F<Z.length;F+=1)Z[F].c();c(t,"class","label"),c(t,"for","config-id"),a.__value="Desktop",a.value=a.__value,u.__value="Server",u.value=u.__value,d.__value="Embedded",d.value=d.__value,c(s,"id","config-id"),l[2].id===void 0&&nt(()=>l[16].call(s)),c(r,"class","select"),c(o,"class","control"),c(e,"class","field"),c(_,"class","label"),c(_,"for","global-shortcut"),c($,"class","input"),c($,"id","global-shortcut"),c($,"type","text"),c(g,"class","control"),c(p,"class","field"),c(b,"class","label"),c(b,"for","default-theme"),c(K,"class","input"),c(K,"id","default-theme"),c(K,"type","text"),c(A,"class","control"),c(v,"class","field"),c(N,"class","label"),c(N,"for","default-role"),c(M,"id","default-role"),l[2].default_role===void 0&&nt(()=>l[19].call(M)),c(J,"class","select"),c(q,"class","control"),c(w,"class","field")},m(F,G){T(F,e,G),i(e,t),i(e,n),i(e,o),i(o,r),i(r,s),i(s,a),i(s,u),i(s,d),Me(s,l[2].id,!0),T(F,m,G),T(F,p,G),i(p,_),i(p,h),i(p,g),i(g,$),Se($,l[2].global_shortcut),T(F,y,G),T(F,v,G),i(v,b),i(v,L),i(v,A),i(A,K),Se(K,l[2].default_theme),T(F,j,G),T(F,w,G),i(w,N),i(w,P),i(w,q),i(q,J),i(J,M);for(let Q=0;Q<Z.length;Q+=1)Z[Q]&&Z[Q].m(M,null);Me(M,l[2].default_role,!0),S||(Y=[x(s,"change",l[16]),x($,"input",l[17]),x(K,"input",l[18]),x(M,"change",l[19])],S=!0)},p(F,G){if(G[0]&4&&Me(s,F[2].id),G[0]&4&&$.value!==F[2].global_shortcut&&Se($,F[2].global_shortcut),G[0]&4&&K.value!==F[2].default_theme&&Se(K,F[2].default_theme),G[0]&4){U=F[2].roles;let Q;for(Q=0;Q<U.length;Q+=1){const R=sn(F,U,Q);Z[Q]?Z[Q].p(R,G):(Z[Q]=gn(R),Z[Q].c(),Z[Q].m(M,null))}for(;Q<Z.length;Q+=1)Z[Q].d(1);Z.length=U.length}G[0]&4&&Me(M,F[2].default_role)},d(F){F&&C(e),F&&C(m),F&&C(p),F&&C(y),F&&C(v),F&&C(j),F&&C(w),Be(Z,F),S=!1,Je(Y)}}}function un(l){let e,t,n=l[48].name+"",o,r,s,a,u,d=l[48].shortname+"",m,p,_,h,g,$=l[48].theme+"",y,v,b,L,A,K=l[48].relevance_function+"",j,w,N,P,q,J;return{c(){e=f("div"),t=f("h6"),o=V(n),r=k(),s=f("p"),a=f("strong"),a.textContent="Shortname:",u=k(),m=V(d),p=k(),_=f("p"),h=f("strong"),h.textContent="Theme:",g=k(),y=V($),v=k(),b=f("p"),L=f("strong"),L.textContent="Relevance Function:",A=k(),j=V(K),w=k(),N=f("button"),N.textContent="Edit Role",P=k(),c(t,"data-testid","review-role-name-"+l[53]),c(N,"class","button is-small"),c(N,"data-testid","edit-role-"+l[53]),c(e,"class","box")},m(M,S){T(M,e,S),i(e,t),i(t,o),i(e,r),i(e,s),i(s,a),i(s,u),i(s,m),i(e,p),i(e,_),i(_,h),i(_,g),i(_,y),i(e,v),i(e,b),i(b,L),i(b,A),i(b,j),i(e,w),i(e,N),i(e,P),q||(J=x(N,"click",l[45]),q=!0)},p(M,S){S[0]&4&&n!==(n=M[48].name+"")&&me(o,n),S[0]&4&&d!==(d=M[48].shortname+"")&&me(m,d),S[0]&4&&$!==($=M[48].theme+"")&&me(y,$),S[0]&4&&K!==(K=M[48].relevance_function+"")&&me(j,K)},d(M){M&&C(e),q=!1,J()}}}function Ks(l){let e;return{c(){e=V("Directory Path")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function Ws(l){let e;return{c(){e=V("Server URL")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function cn(l){let e,t,n,o,r,s,a,u,d,m,p,_;function h(){l[26].call(a,l[53],l[56])}return{c(){e=f("div"),t=f("label"),n=V("Atomic Server Secret"),r=k(),s=f("div"),a=f("input"),d=k(),m=f("p"),m.textContent="Leave empty for anonymous access",c(t,"class","label"),c(t,"for",o=`haystack-secret-${l[53]}-${l[56]}`),c(a,"class","input"),c(a,"id",u=`haystack-secret-${l[53]}-${l[56]}`),c(a,"type","password"),c(a,"placeholder","Base64 encoded secret (optional)"),c(s,"class","control"),c(m,"class","help"),c(e,"class","field")},m(g,$){T(g,e,$),i(e,t),i(t,n),i(e,r),i(e,s),i(s,a),Se(a,l[2].roles[l[53]].haystacks[l[56]].atomic_server_secret),i(e,d),i(e,m),p||(_=x(a,"input",h),p=!0)},p(g,$){l=g,$[0]&4&&o!==(o=`haystack-secret-${l[53]}-${l[56]}`)&&c(t,"for",o),$[0]&4&&u!==(u=`haystack-secret-${l[53]}-${l[56]}`)&&c(a,"id",u),$[0]&4&&a.value!==l[2].roles[l[53]].haystacks[l[56]].atomic_server_secret&&Se(a,l[2].roles[l[53]].haystacks[l[56]].atomic_server_secret)},d(g){g&&C(e),p=!1,_()}}}function fn(l){let e,t,n,o,r,s,a,u,d,m,p,_,h,g,$,y,v,b=Object.entries(l[2].roles[l[53]].haystacks[l[56]].extra_parameters||{}),L=[];for(let w=0;w<b.length;w+=1)L[w]=dn(on(l,b,w));function A(){return l[30](l[53],l[56])}function K(){return l[31](l[53],l[56])}function j(){return l[32](l[53],l[56])}return{c(){e=f("div"),t=f("label"),t.textContent="Extra Parameters (for filtering)",n=k();for(let w=0;w<L.length;w+=1)L[w].c();o=k(),r=f("div"),s=f("div"),a=f("button"),a.textContent="+ Tag Filter",u=k(),d=f("div"),m=f("button"),m.textContent="+ Max Results",p=k(),_=f("div"),h=f("button"),h.textContent="+ Custom Parameter",g=k(),$=f("p"),$.innerHTML=`Common parameters: <code>tag</code> (e.g., &quot;#rust&quot;), <code>glob</code> (e.g., &quot;*.md&quot;), 
                  <code>max_count</code> (e.g., &quot;10&quot;), <code>context</code> (e.g., &quot;5&quot;)`,c(t,"class","label"),c(a,"class","button is-small is-link is-light"),c(s,"class","control"),c(m,"class","button is-small is-link is-light"),c(d,"class","control"),c(h,"class","button is-small is-link is-light"),c(_,"class","control"),c(r,"class","field is-grouped"),c($,"class","help"),c(e,"class","field")},m(w,N){T(w,e,N),i(e,t),i(e,n);for(let P=0;P<L.length;P+=1)L[P]&&L[P].m(e,null);i(e,o),i(e,r),i(r,s),i(s,a),i(r,u),i(r,d),i(d,m),i(r,p),i(r,_),i(_,h),i(e,g),i(e,$),y||(v=[x(a,"click",A),x(m,"click",K),x(h,"click",j)],y=!0)},p(w,N){if(l=w,N[0]&6148){b=Object.entries(l[2].roles[l[53]].haystacks[l[56]].extra_parameters||{});let P;for(P=0;P<b.length;P+=1){const q=on(l,b,P);L[P]?L[P].p(q,N):(L[P]=dn(q),L[P].c(),L[P].m(e,o))}for(;P<L.length;P+=1)L[P].d(1);L.length=b.length}},d(w){w&&C(e),Be(L,w),y=!1,Je(v)}}}function dn(l){let e,t,n,o,r,s,a,u,d,m,p,_,h;function g(...v){return l[27](l[53],l[56],l[57],...v)}function $(){l[28].call(a,l[53],l[56],l[57])}function y(){return l[29](l[53],l[56],l[57])}return{c(){e=f("div"),t=f("div"),n=f("input"),r=k(),s=f("div"),a=f("input"),u=k(),d=f("div"),m=f("button"),m.textContent="×",p=k(),c(n,"class","input"),c(n,"type","text"),c(n,"placeholder","Parameter name"),n.value=o=l[57],c(t,"class","control"),c(a,"class","input"),c(a,"type","text"),c(a,"placeholder","Parameter value"),c(s,"class","control is-expanded"),c(m,"class","button is-small is-danger"),c(d,"class","control"),c(e,"class","field is-grouped")},m(v,b){T(v,e,b),i(e,t),i(t,n),i(e,r),i(e,s),i(s,a),Se(a,l[2].roles[l[53]].haystacks[l[56]].extra_parameters[l[57]]),i(e,u),i(e,d),i(d,m),i(e,p),_||(h=[x(n,"blur",g),x(a,"input",$),x(m,"click",y)],_=!0)},p(v,b){l=v,b[0]&4&&o!==(o=l[57])&&n.value!==o&&(n.value=o),b[0]&4&&a.value!==l[2].roles[l[53]].haystacks[l[56]].extra_parameters[l[57]]&&Se(a,l[2].roles[l[53]].haystacks[l[56]].extra_parameters[l[57]])},d(v){v&&C(e),_=!1,Je(h)}}}function pn(l){let e,t,n,o,r,s,a,u,d,m,p,_,h,g,$,y,v,b,L,A,K,j,w,N,P,q,J,M,S,Y,U,Z,F,G,Q,R,W;function X(){l[24].call(d,l[53],l[56])}function O(ge,ue){return ge[2].roles[ge[53]].haystacks[ge[56]].service==="Atomic"?Ws:Ks}let H=O(l),B=H(l);function oe(){l[25].call(L,l[53],l[56])}let pe=l[2].roles[l[53]].haystacks[l[56]].service==="Atomic"&&cn(l),ae=l[2].roles[l[53]].haystacks[l[56]].service==="Ripgrep"&&fn(l);function Ue(){l[33].call(J,l[53],l[56])}function we(){return l[34](l[53],l[56])}return{c(){e=f("div"),t=f("div"),n=f("label"),o=V("Service Type"),s=k(),a=f("div"),u=f("div"),d=f("select"),m=f("option"),m.textContent="Ripgrep (File Search)",p=f("option"),p.textContent="Atomic Server",h=k(),g=f("div"),$=f("label"),B.c(),v=k(),b=f("div"),L=f("input"),j=k(),pe&&pe.c(),w=k(),ae&&ae.c(),N=k(),P=f("div"),q=f("label"),J=f("input"),S=V(`
                 Read-only`),U=k(),Z=f("div"),F=f("button"),G=V("Remove Haystack"),c(n,"class","label"),c(n,"for",r=`haystack-service-${l[53]}-${l[56]}`),m.__value="Ripgrep",m.value=m.__value,p.__value="Atomic",p.value=p.__value,c(d,"id",_=`haystack-service-${l[53]}-${l[56]}`),l[2].roles[l[53]].haystacks[l[56]].service===void 0&&nt(X),c(u,"class","select"),c(a,"class","control"),c(t,"class","field"),c($,"class","label"),c($,"for",y=`haystack-path-${l[53]}-${l[56]}`),c(L,"class","input"),c(L,"id",A=`haystack-path-${l[53]}-${l[56]}`),c(L,"type","text"),c(L,"placeholder",K=l[2].roles[l[53]].haystacks[l[56]].service==="Atomic"?"https://localhost:9883":"/path/to/documents"),c(b,"class","control"),c(g,"class","field"),c(J,"id",M=`haystack-readonly-${l[53]}-${l[56]}`),c(J,"type","checkbox"),c(q,"class","checkbox"),c(q,"for",Y=`haystack-readonly-${l[53]}-${l[56]}`),c(P,"class","field"),c(F,"class","button is-small is-danger"),c(F,"data-testid",Q="remove-haystack-"+l[53]+"-"+l[56]),c(Z,"class","field"),c(e,"class","box is-light")},m(ge,ue){T(ge,e,ue),i(e,t),i(t,n),i(n,o),i(t,s),i(t,a),i(a,u),i(u,d),i(d,m),i(d,p),Me(d,l[2].roles[l[53]].haystacks[l[56]].service,!0),i(e,h),i(e,g),i(g,$),B.m($,null),i(g,v),i(g,b),i(b,L),Se(L,l[2].roles[l[53]].haystacks[l[56]].path),i(e,j),pe&&pe.m(e,null),i(e,w),ae&&ae.m(e,null),i(e,N),i(e,P),i(P,q),i(q,J),J.checked=l[2].roles[l[53]].haystacks[l[56]].read_only,i(q,S),i(e,U),i(e,Z),i(Z,F),i(F,G),R||(W=[x(d,"change",X),x(L,"input",oe),x(J,"change",Ue),x(F,"click",we)],R=!0)},p(ge,ue){l=ge,ue[0]&4&&r!==(r=`haystack-service-${l[53]}-${l[56]}`)&&c(n,"for",r),ue[0]&4&&_!==(_=`haystack-service-${l[53]}-${l[56]}`)&&c(d,"id",_),ue[0]&4&&Me(d,l[2].roles[l[53]].haystacks[l[56]].service),H!==(H=O(l))&&(B.d(1),B=H(l),B&&(B.c(),B.m($,null))),ue[0]&4&&y!==(y=`haystack-path-${l[53]}-${l[56]}`)&&c($,"for",y),ue[0]&4&&A!==(A=`haystack-path-${l[53]}-${l[56]}`)&&c(L,"id",A),ue[0]&4&&K!==(K=l[2].roles[l[53]].haystacks[l[56]].service==="Atomic"?"https://localhost:9883":"/path/to/documents")&&c(L,"placeholder",K),ue[0]&4&&L.value!==l[2].roles[l[53]].haystacks[l[56]].path&&Se(L,l[2].roles[l[53]].haystacks[l[56]].path),l[2].roles[l[53]].haystacks[l[56]].service==="Atomic"?pe?pe.p(l,ue):(pe=cn(l),pe.c(),pe.m(e,w)):pe&&(pe.d(1),pe=null),l[2].roles[l[53]].haystacks[l[56]].service==="Ripgrep"?ae?ae.p(l,ue):(ae=fn(l),ae.c(),ae.m(e,N)):ae&&(ae.d(1),ae=null),ue[0]&4&&M!==(M=`haystack-readonly-${l[53]}-${l[56]}`)&&c(J,"id",M),ue[0]&4&&(J.checked=l[2].roles[l[53]].haystacks[l[56]].read_only),ue[0]&4&&Y!==(Y=`haystack-readonly-${l[53]}-${l[56]}`)&&c(q,"for",Y),ue[0]&4&&Q!==(Q="remove-haystack-"+l[53]+"-"+l[56])&&c(F,"data-testid",Q)},d(ge){ge&&C(e),B.d(),pe&&pe.d(),ae&&ae.d(),R=!1,Je(W)}}}function _n(l){let e,t,n,o,r,s,a,u,d,m,p,_,h,g,$,y,v,b,L,A,K,j,w,N,P,q,J,M,S;function Y(){l[37].call(a,l[53])}function U(){l[38].call(L,l[53])}return{c(){e=f("div"),t=f("label"),n=V("OpenRouter API Key"),r=k(),s=f("div"),a=f("input"),d=k(),m=f("p"),m.innerHTML='Get your API key from <a href="https://openrouter.ai" target="_blank" rel="noopener">OpenRouter</a>',p=k(),_=f("div"),h=f("label"),g=V("Model"),y=k(),v=f("div"),b=f("div"),L=f("select"),A=f("option"),A.textContent="GPT-3.5 Turbo (Fast & Affordable)",K=f("option"),K.textContent="GPT-4 (High Quality)",j=f("option"),j.textContent="Claude 3 Sonnet (Balanced)",w=f("option"),w.textContent="Claude 3 Haiku (Fast)",N=f("option"),N.textContent="Mixtral 8x7B (Open Source)",q=k(),J=f("p"),J.textContent="Choose the language model for generating summaries. Different models offer different speed/quality tradeoffs.",c(t,"class","label"),c(t,"for",o=`openrouter-api-key-${l[53]}`),c(a,"class","input"),c(a,"id",u=`openrouter-api-key-${l[53]}`),c(a,"type","password"),c(a,"placeholder","sk-or-v1-..."),c(s,"class","control"),c(m,"class","help"),c(e,"class","field"),c(h,"class","label"),c(h,"for",$=`openrouter-model-${l[53]}`),A.__value="openai/gpt-3.5-turbo",A.value=A.__value,K.__value="openai/gpt-4",K.value=K.__value,j.__value="anthropic/claude-3-sonnet",j.value=j.__value,w.__value="anthropic/claude-3-haiku",w.value=w.__value,N.__value="mistralai/mixtral-8x7b-instruct",N.value=N.__value,c(L,"id",P=`openrouter-model-${l[53]}`),l[2].roles[l[53]].openrouter_model===void 0&&nt(U),c(b,"class","select is-fullwidth"),c(v,"class","control"),c(J,"class","help"),c(_,"class","field")},m(Z,F){T(Z,e,F),i(e,t),i(t,n),i(e,r),i(e,s),i(s,a),Se(a,l[2].roles[l[53]].openrouter_api_key),i(e,d),i(e,m),T(Z,p,F),T(Z,_,F),i(_,h),i(h,g),i(_,y),i(_,v),i(v,b),i(b,L),i(L,A),i(L,K),i(L,j),i(L,w),i(L,N),Me(L,l[2].roles[l[53]].openrouter_model,!0),i(_,q),i(_,J),M||(S=[x(a,"input",Y),x(L,"change",U)],M=!0)},p(Z,F){l=Z,F[0]&4&&o!==(o=`openrouter-api-key-${l[53]}`)&&c(t,"for",o),F[0]&4&&u!==(u=`openrouter-api-key-${l[53]}`)&&c(a,"id",u),F[0]&4&&a.value!==l[2].roles[l[53]].openrouter_api_key&&Se(a,l[2].roles[l[53]].openrouter_api_key),F[0]&4&&$!==($=`openrouter-model-${l[53]}`)&&c(h,"for",$),F[0]&4&&P!==(P=`openrouter-model-${l[53]}`)&&c(L,"id",P),F[0]&4&&Me(L,l[2].roles[l[53]].openrouter_model)},d(Z){Z&&C(e),Z&&C(p),Z&&C(_),M=!1,Je(S)}}}function mn(l,e){let t,n,o,r,s,a,u,d,m,p,_,h,g,$,y,v,b,L,A,K,j,w,N,P,q,J,M,S,Y,U,Z,F,G,Q,R,W,X,O,H,B,oe,pe,ae,Ue,we,ge,ue,Ce,be,D,ee,le,he,fe,ne,$e,z,ce,ye,Te,Ve,Le,xe,Ee,Re,ft,Dt,dt,it,Mt,We,Pt,vt,He,te,_e,pt,ot,et,Tt,bt,It,Ft,st,Rt,Lt,Gt,rl,Nt,_t,at,Kt,il,Wt,al,kt,ut,zt,ul,qt,cl,fl,dl,$t,pl,Bt,Zt,_l;function Un(){e[20].call(d,e[53])}function En(){e[21].call(b,e[53])}function Dn(){e[22].call(J,e[53])}function Mn(){e[23].call(R,e[53])}let Ot=e[51].haystacks,Fe=[];for(let Ge=0;Ge<Ot.length;Ge+=1)Fe[Ge]=pn(nn(e,Ot,Ge));function Pn(){return e[35](e[53])}function In(){e[36].call(be,e[53])}let Ke=e[2].roles[e[53]].openrouter_enabled&&_n(e);function jn(){e[39].call(Re,e[53])}function Hn(){e[40].call(He,e[53])}function ml(){e[41].call(st,e[53])}function Fn(){e[42].call(at,e[53])}function Gn(){e[43].call(ut,e[53])}function Kn(){return e[44](e[53])}return{key:l,first:null,c(){t=f("div"),n=f("div"),o=f("label"),r=V("Role name"),a=k(),u=f("div"),d=f("input"),p=k(),_=f("div"),h=f("label"),g=V("Short name"),y=k(),v=f("div"),b=f("input"),A=k(),K=f("div"),j=f("label"),w=V("Theme"),P=k(),q=f("div"),J=f("input"),S=k(),Y=f("div"),U=f("label"),Z=V("Relevance function"),G=k(),Q=f("div"),R=f("input"),X=k(),O=f("h5"),O.textContent="Haystacks",H=k();for(let Ge=0;Ge<Fe.length;Ge+=1)Fe[Ge].c();B=k(),oe=f("button"),pe=V("Add Haystack"),Ue=k(),we=f("h5"),we.textContent="AI-Enhanced Summaries (OpenRouter)",ge=k(),ue=f("div"),Ce=f("label"),be=f("input"),ee=V(`
             Enable AI-generated article summaries`),he=k(),fe=f("p"),fe.textContent="Generate intelligent summaries using OpenRouter's language models",ne=k(),Ke&&Ke.c(),$e=k(),z=f("h5"),z.textContent="Knowledge Graph",ce=k(),ye=f("div"),Te=f("label"),Ve=V("Remote automata URL"),xe=k(),Ee=f("div"),Re=f("input"),Dt=k(),dt=f("div"),it=f("label"),Mt=V("Local KG path"),Pt=k(),vt=f("div"),He=f("input"),_e=k(),pt=f("div"),ot=f("div"),et=f("label"),Tt=V("Local KG type"),It=k(),Ft=f("div"),st=f("select"),Rt=f("option"),Rt.textContent="markdown",Lt=f("option"),Lt.textContent="json",rl=k(),Nt=f("div"),_t=f("label"),at=f("input"),il=V(`
             Public`),al=k(),kt=f("label"),ut=f("input"),ul=V(`
             Publish`),cl=k(),fl=f("hr"),dl=k(),$t=f("button"),pl=V("Remove Role"),c(o,"class","label"),c(o,"for",s=`role-name-${e[53]}`),c(d,"class","input"),c(d,"id",m=`role-name-${e[53]}`),c(d,"type","text"),c(u,"class","control"),c(n,"class","field"),c(h,"class","label"),c(h,"for",$=`role-shortname-${e[53]}`),c(b,"class","input"),c(b,"id",L=`role-shortname-${e[53]}`),c(b,"type","text"),c(v,"class","control"),c(_,"class","field"),c(j,"class","label"),c(j,"for",N=`role-theme-${e[53]}`),c(J,"class","input"),c(J,"id",M=`role-theme-${e[53]}`),c(J,"type","text"),c(q,"class","control"),c(K,"class","field"),c(U,"class","label"),c(U,"for",F=`role-relevance-${e[53]}`),c(R,"class","input"),c(R,"id",W=`role-relevance-${e[53]}`),c(R,"type","text"),c(Q,"class","control"),c(Y,"class","field"),c(O,"class","title is-6"),c(oe,"class","button is-small"),c(oe,"data-testid",ae="add-haystack-"+e[53]),c(we,"class","title is-6"),c(be,"id",D=`openrouter-enabled-${e[53]}`),c(be,"type","checkbox"),c(Ce,"class","checkbox"),c(Ce,"for",le=`openrouter-enabled-${e[53]}`),c(fe,"class","help"),c(ue,"class","field"),c(z,"class","title is-6"),c(Te,"class","label"),c(Te,"for",Le=`kg-url-${e[53]}`),c(Re,"class","input"),c(Re,"id",ft=`kg-url-${e[53]}`),c(Re,"type","text"),c(Re,"placeholder","https://example.com/thesaurus.json"),c(Ee,"class","control"),c(ye,"class","field"),c(it,"class","label"),c(it,"for",We=`kg-local-path-${e[53]}`),c(He,"class","input"),c(He,"id",te=`kg-local-path-${e[53]}`),c(He,"type","text"),c(He,"placeholder","/path/to/markdown"),c(vt,"class","control"),c(dt,"class","field"),c(et,"class","label"),c(et,"for",bt=`kg-local-type-${e[53]}`),Rt.__value="markdown",Rt.value=Rt.__value,Lt.__value="json",Lt.value=Lt.__value,c(st,"id",Gt=`kg-local-type-${e[53]}`),e[2].roles[e[53]].kg.local_type===void 0&&nt(ml),c(Ft,"class","select"),c(ot,"class","control"),c(pt,"class","field is-grouped"),c(at,"id",Kt=`kg-public-${e[53]}`),c(at,"type","checkbox"),c(_t,"class","checkbox"),c(_t,"for",Wt=`kg-public-${e[53]}`),St(_t,"margin-right","1rem"),c(ut,"id",zt=`kg-publish-${e[53]}`),c(ut,"type","checkbox"),c(kt,"class","checkbox"),c(kt,"for",qt=`kg-publish-${e[53]}`),c(Nt,"class","field is-grouped"),c($t,"class","button is-small is-danger"),c($t,"data-testid",Bt="remove-role-"+e[53]),c(t,"class","box"),this.first=t},m(Ge,de){T(Ge,t,de),i(t,n),i(n,o),i(o,r),i(n,a),i(n,u),i(u,d),Se(d,e[2].roles[e[53]].name),i(t,p),i(t,_),i(_,h),i(h,g),i(_,y),i(_,v),i(v,b),Se(b,e[2].roles[e[53]].shortname),i(t,A),i(t,K),i(K,j),i(j,w),i(K,P),i(K,q),i(q,J),Se(J,e[2].roles[e[53]].theme),i(t,S),i(t,Y),i(Y,U),i(U,Z),i(Y,G),i(Y,Q),i(Q,R),Se(R,e[2].roles[e[53]].relevance_function),i(t,X),i(t,O),i(t,H);for(let De=0;De<Fe.length;De+=1)Fe[De]&&Fe[De].m(t,null);i(t,B),i(t,oe),i(oe,pe),i(t,Ue),i(t,we),i(t,ge),i(t,ue),i(ue,Ce),i(Ce,be),be.checked=e[2].roles[e[53]].openrouter_enabled,i(Ce,ee),i(ue,he),i(ue,fe),i(t,ne),Ke&&Ke.m(t,null),i(t,$e),i(t,z),i(t,ce),i(t,ye),i(ye,Te),i(Te,Ve),i(ye,xe),i(ye,Ee),i(Ee,Re),Se(Re,e[2].roles[e[53]].kg.url),i(t,Dt),i(t,dt),i(dt,it),i(it,Mt),i(dt,Pt),i(dt,vt),i(vt,He),Se(He,e[2].roles[e[53]].kg.local_path),i(t,_e),i(t,pt),i(pt,ot),i(ot,et),i(et,Tt),i(ot,It),i(ot,Ft),i(Ft,st),i(st,Rt),i(st,Lt),Me(st,e[2].roles[e[53]].kg.local_type,!0),i(t,rl),i(t,Nt),i(Nt,_t),i(_t,at),at.checked=e[2].roles[e[53]].kg.public,i(_t,il),i(Nt,al),i(Nt,kt),i(kt,ut),ut.checked=e[2].roles[e[53]].kg.publish,i(kt,ul),i(t,cl),i(t,fl),i(t,dl),i(t,$t),i($t,pl),Zt||(_l=[x(d,"input",Un),x(b,"input",En),x(J,"input",Dn),x(R,"input",Mn),x(oe,"click",Pn),x(be,"change",In),x(Re,"input",jn),x(He,"input",Hn),x(st,"change",ml),x(at,"change",Fn),x(ut,"change",Gn),x($t,"click",Kn)],Zt=!0)},p(Ge,de){if(e=Ge,de[0]&4&&s!==(s=`role-name-${e[53]}`)&&c(o,"for",s),de[0]&4&&m!==(m=`role-name-${e[53]}`)&&c(d,"id",m),de[0]&4&&d.value!==e[2].roles[e[53]].name&&Se(d,e[2].roles[e[53]].name),de[0]&4&&$!==($=`role-shortname-${e[53]}`)&&c(h,"for",$),de[0]&4&&L!==(L=`role-shortname-${e[53]}`)&&c(b,"id",L),de[0]&4&&b.value!==e[2].roles[e[53]].shortname&&Se(b,e[2].roles[e[53]].shortname),de[0]&4&&N!==(N=`role-theme-${e[53]}`)&&c(j,"for",N),de[0]&4&&M!==(M=`role-theme-${e[53]}`)&&c(J,"id",M),de[0]&4&&J.value!==e[2].roles[e[53]].theme&&Se(J,e[2].roles[e[53]].theme),de[0]&4&&F!==(F=`role-relevance-${e[53]}`)&&c(U,"for",F),de[0]&4&&W!==(W=`role-relevance-${e[53]}`)&&c(R,"id",W),de[0]&4&&R.value!==e[2].roles[e[53]].relevance_function&&Se(R,e[2].roles[e[53]].relevance_function),de[0]&7684){Ot=e[51].haystacks;let De;for(De=0;De<Ot.length;De+=1){const gl=nn(e,Ot,De);Fe[De]?Fe[De].p(gl,de):(Fe[De]=pn(gl),Fe[De].c(),Fe[De].m(t,B))}for(;De<Fe.length;De+=1)Fe[De].d(1);Fe.length=Ot.length}de[0]&4&&ae!==(ae="add-haystack-"+e[53])&&c(oe,"data-testid",ae),de[0]&4&&D!==(D=`openrouter-enabled-${e[53]}`)&&c(be,"id",D),de[0]&4&&(be.checked=e[2].roles[e[53]].openrouter_enabled),de[0]&4&&le!==(le=`openrouter-enabled-${e[53]}`)&&c(Ce,"for",le),e[2].roles[e[53]].openrouter_enabled?Ke?Ke.p(e,de):(Ke=_n(e),Ke.c(),Ke.m(t,$e)):Ke&&(Ke.d(1),Ke=null),de[0]&4&&Le!==(Le=`kg-url-${e[53]}`)&&c(Te,"for",Le),de[0]&4&&ft!==(ft=`kg-url-${e[53]}`)&&c(Re,"id",ft),de[0]&4&&Re.value!==e[2].roles[e[53]].kg.url&&Se(Re,e[2].roles[e[53]].kg.url),de[0]&4&&We!==(We=`kg-local-path-${e[53]}`)&&c(it,"for",We),de[0]&4&&te!==(te=`kg-local-path-${e[53]}`)&&c(He,"id",te),de[0]&4&&He.value!==e[2].roles[e[53]].kg.local_path&&Se(He,e[2].roles[e[53]].kg.local_path),de[0]&4&&bt!==(bt=`kg-local-type-${e[53]}`)&&c(et,"for",bt),de[0]&4&&Gt!==(Gt=`kg-local-type-${e[53]}`)&&c(st,"id",Gt),de[0]&4&&Me(st,e[2].roles[e[53]].kg.local_type),de[0]&4&&Kt!==(Kt=`kg-public-${e[53]}`)&&c(at,"id",Kt),de[0]&4&&(at.checked=e[2].roles[e[53]].kg.public),de[0]&4&&Wt!==(Wt=`kg-public-${e[53]}`)&&c(_t,"for",Wt),de[0]&4&&zt!==(zt=`kg-publish-${e[53]}`)&&c(ut,"id",zt),de[0]&4&&(ut.checked=e[2].roles[e[53]].kg.publish),de[0]&4&&qt!==(qt=`kg-publish-${e[53]}`)&&c(kt,"for",qt),de[0]&4&&Bt!==(Bt="remove-role-"+e[53])&&c($t,"data-testid",Bt)},d(Ge){Ge&&C(t),Be(Fe,Ge),Ke&&Ke.d(),Zt=!1,Je(_l)}}}function gn(l){let e,t=l[48].name+"",n,o;return{c(){e=f("option"),n=V(t),e.__value=o=l[48].name,e.value=e.__value},m(r,s){T(r,e,s),i(e,n)},p(r,s){s[0]&4&&t!==(t=r[48].name+"")&&me(n,t),s[0]&4&&o!==(o=r[48].name)&&(e.__value=o,e.value=e.__value)},d(r){r&&C(e)}}}function hn(l){let e,t,n;return{c(){e=f("button"),e.textContent="Back",c(e,"class","button"),c(e,"data-testid","wizard-back")},m(o,r){T(o,e,r),t||(n=x(e,"click",l[5]),t=!0)},p:ve,d(o){o&&C(e),t=!1,n()}}}function zs(l){let e,t,n;return{c(){e=f("button"),e.textContent="Save",c(e,"class","button is-success"),c(e,"data-testid","wizard-save")},m(o,r){T(o,e,r),t||(n=x(e,"click",l[13]),t=!0)},p:ve,d(o){o&&C(e),t=!1,n()}}}function qs(l){let e,t,n;return{c(){e=f("button"),e.textContent="Next",c(e,"class","button is-primary"),c(e,"data-testid","wizard-next")},m(o,r){T(o,e,r),t||(n=x(e,"click",l[4]),t=!0)},p:ve,d(o){o&&C(e),t=!1,n()}}}function Bs(l){let e,t,n,o,r,s,a,u,d,m,p=l[1]==="success"&&rn(l),_=l[1]==="error"&&an(l);function h(A,K){return A[0]===1?Gs:A[0]===2?Fs:Hs}let g=h(l),$=g(l),y=l[0]>1&&hn(l);function v(A,K){return A[0]<An?qs:zs}let b=v(l),L=b(l);return{c(){e=f("div"),t=f("h3"),t.textContent="Configuration Wizard",n=k(),p&&p.c(),o=k(),_&&_.c(),r=k(),$.c(),s=k(),a=f("nav"),u=f("div"),y&&y.c(),d=k(),m=f("div"),L.c(),c(t,"class","title is-4"),c(u,"class","level-left"),c(m,"class","level-right"),c(a,"class","level"),c(e,"class","box")},m(A,K){T(A,e,K),i(e,t),i(e,n),p&&p.m(e,null),i(e,o),_&&_.m(e,null),i(e,r),$.m(e,null),i(e,s),i(e,a),i(a,u),y&&y.m(u,null),i(a,d),i(a,m),L.m(m,null)},p(A,K){A[1]==="success"?p?p.p(A,K):(p=rn(A),p.c(),p.m(e,o)):p&&(p.d(1),p=null),A[1]==="error"?_?_.p(A,K):(_=an(A),_.c(),_.m(e,r)):_&&(_.d(1),_=null),g===(g=h(A))&&$?$.p(A,K):($.d(1),$=g(A),$&&($.c(),$.m(e,s))),A[0]>1?y?y.p(A,K):(y=hn(A),y.c(),y.m(u,null)):y&&(y.d(1),y=null),b===(b=v(A))&&L?L.p(A,K):(L.d(1),L=b(A),L&&(L.c(),L.m(m,null)))},i:ve,o:ve,d(A){A&&C(e),p&&p.d(),_&&_.d(),$.d(),y&&y.d(),L.d()}}}const An=3;function Js(l,e,t){let n;const o=lt(null),r=lt({id:"Desktop",global_shortcut:"Ctrl+X",default_theme:"spacelab",default_role:"Default",roles:[]});ke(l,r,D=>t(2,n=D)),ol(async()=>{try{let D;At(ze)?D=await Pe("get_config_schema"):D=await(await fetch("/config/schema")).json(),o.set(D);const ee=At(Ye);ee&&ee.id&&r.update(le=>{var he;return{...le,id:ee.id,global_shortcut:ee.global_shortcut,default_theme:((he=ee.roles[ee.default_role])==null?void 0:he.theme)??"spacelab",default_role:ee.default_role,roles:Object.values(ee.roles).map(fe=>{var ce,ye,Te,Ve,Le,xe,Ee;const ne=(ce=fe.kg)==null?void 0:ce.automata_path,$e=(ne==null?void 0:ne.Remote)??"",z=((Te=(ye=fe.kg)==null?void 0:ye.knowledge_graph_local)==null?void 0:Te.path)??"";return{name:fe.name,shortname:fe.shortname,relevance_function:fe.relevance_function,theme:fe.theme,haystacks:(fe.haystacks??[]).map(Re=>({path:Re.location||Re.path||"",read_only:Re.read_only??!1,service:Re.service||"Ripgrep",atomic_server_secret:Re.atomic_server_secret||"",extra_parameters:Re.extra_parameters||{}})),kg:{url:$e,local_path:z,local_type:((Le=(Ve=fe.kg)==null?void 0:Ve.knowledge_graph_local)==null?void 0:Le.input_type)??"markdown",public:((xe=fe.kg)==null?void 0:xe.public)??!1,publish:((Ee=fe.kg)==null?void 0:Ee.publish)??!1},openrouter_enabled:fe.openrouter_enabled??!1,openrouter_api_key:fe.openrouter_api_key??"",openrouter_model:fe.openrouter_model??"openai/gpt-3.5-turbo"}})}})}catch(D){console.error("Failed to load schema",D)}});let s=1,a="";function u(){s<An&&t(0,s+=1)}function d(){s>1&&t(0,s-=1)}function m(){r.update(D=>({...D,roles:[...D.roles,{name:"New Role",shortname:"new",relevance_function:"title-scorer",theme:"spacelab",haystacks:[],kg:{url:"",local_path:"",local_type:"markdown",public:!1,publish:!1},openrouter_enabled:!1,openrouter_api_key:"",openrouter_model:"openai/gpt-3.5-turbo"}]}))}function p(D){r.update(ee=>({...ee,roles:ee.roles.filter((le,he)=>he!==D)}))}function _(D){r.update(ee=>(ee.roles[D].haystacks.push({path:"",read_only:!1,service:"Ripgrep",atomic_server_secret:"",extra_parameters:{}}),ee))}function h(D,ee){r.update(le=>(le.roles[D].haystacks=le.roles[D].haystacks.filter((he,fe)=>fe!==ee),le))}function g(D,ee,le="",he=""){r.update(fe=>{fe.roles[D].haystacks[ee].extra_parameters||(fe.roles[D].haystacks[ee].extra_parameters={});const ne=le||`param_${Date.now()}`;return fe.roles[D].haystacks[ee].extra_parameters[ne]=he,fe})}function $(D,ee,le){r.update(he=>(delete he.roles[D].haystacks[ee].extra_parameters[le],he))}function y(D,ee,le,he){r.update(fe=>{const ne=fe.roles[D].haystacks[ee].extra_parameters;return ne[le]!==void 0&&le!==he&&(ne[he]=ne[le],delete ne[le]),fe})}function v(D,ee,le,he){const fe=he.target.value;y(D,ee,le,fe)}async function b(){var fe;const D=At(r),ee=At(Ye);let le={...ee};le.id=D.id,le.global_shortcut=D.global_shortcut,le.default_role=D.default_role;const he={};D.roles.forEach(ne=>{var ce,ye;const $e=ne.name,z=$e.replace(/^"|"$/g,"");he[z]={extra:((ye=(ce=ee.roles)==null?void 0:ce[$e])==null?void 0:ye.extra)??{},name:ne.name,shortname:ne.shortname,theme:ne.theme,relevance_function:ne.relevance_function,haystacks:ne.haystacks.map(Te=>({location:Te.path,service:Te.service,read_only:Te.read_only,atomic_server_secret:Te.service==="Atomic"?Te.atomic_server_secret:void 0,extra_parameters:Te.extra_parameters||{}})),kg:ne.kg.url||ne.kg.local_path?{automata_path:ne.kg.url?{Remote:ne.kg.url}:null,knowledge_graph_local:ne.kg.local_path?{input_type:ne.kg.local_type,path:ne.kg.local_path}:null,public:ne.kg.public,publish:ne.kg.publish}:null,...ne.openrouter_enabled&&{openrouter_enabled:ne.openrouter_enabled,openrouter_api_key:ne.openrouter_api_key,openrouter_model:ne.openrouter_model}}}),le.roles=he,(!le.default_role||!he[le.default_role])&&(le.default_role=((fe=D.roles[0])==null?void 0:fe.name)??"Default"),le.selected_role=le.default_role;try{if(At(ze))await Pe("update_config",{configNew:le});else{const ne=await fetch("/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(le)});if(!ne.ok)throw new Error(`HTTP ${ne.status}: ${ne.statusText}`)}Ye.set(le),t(1,a="success"),setTimeout(()=>{t(1,a="")},3e3)}catch(ne){console.error(ne),t(1,a="error"),setTimeout(()=>{t(1,a="")},3e3)}}const L=()=>t(1,a=""),A=()=>t(1,a="");function K(){n.id=yt(this),r.set(n)}function j(){n.global_shortcut=this.value,r.set(n)}function w(){n.default_theme=this.value,r.set(n)}function N(){n.default_role=yt(this),r.set(n)}function P(D){n.roles[D].name=this.value,r.set(n)}function q(D){n.roles[D].shortname=this.value,r.set(n)}function J(D){n.roles[D].theme=this.value,r.set(n)}function M(D){n.roles[D].relevance_function=this.value,r.set(n)}function S(D,ee){n.roles[D].haystacks[ee].service=yt(this),r.set(n)}function Y(D,ee){n.roles[D].haystacks[ee].path=this.value,r.set(n)}function U(D,ee){n.roles[D].haystacks[ee].atomic_server_secret=this.value,r.set(n)}const Z=(D,ee,le,he)=>v(D,ee,le,he);function F(D,ee,le){n.roles[D].haystacks[ee].extra_parameters[le]=this.value,r.set(n)}const G=(D,ee,le)=>$(D,ee,le),Q=(D,ee)=>g(D,ee,"tag","#rust"),R=(D,ee)=>g(D,ee,"max_count","10"),W=(D,ee)=>g(D,ee,"","");function X(D,ee){n.roles[D].haystacks[ee].read_only=this.checked,r.set(n)}const O=(D,ee)=>h(D,ee),H=D=>_(D);function B(D){n.roles[D].openrouter_enabled=this.checked,r.set(n)}function oe(D){n.roles[D].openrouter_api_key=this.value,r.set(n)}function pe(D){n.roles[D].openrouter_model=yt(this),r.set(n)}function ae(D){n.roles[D].kg.url=this.value,r.set(n)}function Ue(D){n.roles[D].kg.local_path=this.value,r.set(n)}function we(D){n.roles[D].kg.local_type=yt(this),r.set(n)}function ge(D){n.roles[D].kg.public=this.checked,r.set(n)}function ue(D){n.roles[D].kg.publish=this.checked,r.set(n)}return[s,a,n,r,u,d,m,p,_,h,g,$,v,b,L,A,K,j,w,N,P,q,J,M,S,Y,U,Z,F,G,Q,R,W,X,O,H,B,oe,pe,ae,Ue,we,ge,ue,D=>p(D),()=>{t(0,s=2)}]}class Vs extends Qe{constructor(e){super(),Ze(this,e,Js,Bs,qe,{},null,[-1,-1])}}function Ys(l){let e,t,n,o,r,s;return r=new Rn({props:{content:l[0],onChange:l[1]}}),{c(){e=f("div"),t=f("p"),t.innerHTML="<i>The best editing experience is to configure Atomic Server, in the meantime use editor below. You will need to refresh page via Command R or Ctrl-R to see changes</i>",n=k(),o=f("div"),se(r.$$.fragment),c(o,"class","editor"),c(e,"class","box")},m(a,u){T(a,e,u),i(e,t),i(e,n),i(e,o),re(r,o,null),s=!0},p(a,[u]){const d={};u&1&&(d.content=a[0]),r.$set(d)},i(a){s||(E(r.$$.fragment,a),s=!0)},o(a){I(r.$$.fragment,a),s=!1},d(a){a&&C(e),ie(r)}}}function Qs(l,e,t){let n,o;ke(l,Ye,a=>t(2,n=a)),ke(l,ze,a=>t(3,o=a));let r={json:n};function s(a){if(console.log("contents changed:",a),console.log("is tauri",o),Ye.update(u=>(u=a.json,u)),At(ze))console.log("Updating config on server"),Pe("update_config",{configNew:a.json}).then(u=>{console.log(`Message: ${u}`)}).catch(u=>console.error(u));else{let u=`${tt.ServerURL}/config/`;fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a.json)})}t(0,r=a)}return ol(()=>{t(0,r={json:n})}),[r,s]}class Zs extends Qe{constructor(e){super(),Ze(this,e,Qs,Ys,qe,{})}}const{window:ll}=Xn;function Xs(l){let e,t,n,o,r,s,a,u,d,m;return{c(){e=f("div"),t=f("div"),n=f("h3"),n.textContent="Error loading graph",o=k(),r=f("p"),s=V(l[3]),a=k(),u=f("button"),u.textContent="Retry",c(u,"class","button is-primary"),c(t,"class","error-content svelte-1ry9pkl"),c(e,"class","error-overlay svelte-1ry9pkl")},m(p,_){T(p,e,_),i(e,t),i(t,n),i(t,o),i(t,r),i(r,s),i(t,a),i(t,u),d||(m=x(u,"click",l[11]),d=!0)},p(p,_){_&8&&me(s,p[3])},d(p){p&&C(e),d=!1,m()}}}function xs(l){let e;return{c(){e=f("div"),e.innerHTML=`<div class="loading-content svelte-1ry9pkl"><div class="loader svelte-1ry9pkl"></div> 
        <p>Loading knowledge graph...</p></div>`,c(e,"class","loading-overlay svelte-1ry9pkl")},m(t,n){T(t,e,n)},p:ve,d(t){t&&C(e)}}}function vn(l){let e,t,n;return{c(){e=f("button"),e.innerHTML='<i class="fas fa-times svelte-1ry9pkl"></i>',c(e,"class","close-button svelte-1ry9pkl"),c(e,"title","Close Graph")},m(o,r){T(o,e,r),t||(n=x(e,"click",l[17]),t=!0)},p:ve,d(o){o&&C(e),t=!1,n()}}}function bn(l){let e;return{c(){e=f("div"),e.innerHTML="<span><strong>Left-click:</strong> View node • <strong>Right-click:</strong> Edit node • <strong>Drag:</strong> Move • <strong>Scroll:</strong> Zoom</span>",c(e,"class","controls-info svelte-1ry9pkl")},m(t,n){T(t,e,n)},d(t){t&&C(e)}}}function kn(l){let e,t;return{c(){e=f("div"),t=V(l[8]),c(e,"class","debug-message svelte-1ry9pkl")},m(n,o){T(n,e,o),i(e,t)},p(n,o){o&256&&me(t,n[8])},d(n){n&&C(e)}}}function $n(l){let e=l[5].id,t,n,o=wn(l);return{c(){o.c(),t=Xe()},m(r,s){o.m(r,s),T(r,t,s),n=!0},p(r,s){s&32&&qe(e,e=r[5].id)?(Ne(),I(o,1,1,ve),Oe(),o=wn(r),o.c(),E(o,1),o.m(t.parentNode,t)):o.p(r,s)},i(r){n||(E(o),n=!0)},o(r){I(o),n=!1},d(r){r&&C(t),o.d(r)}}}function wn(l){let e,t,n;function o(s){l[18](s)}let r={item:l[5],initialEdit:l[7]};return l[6]!==void 0&&(r.active=l[6]),e=new sl({props:r}),Ae.push(()=>Ie(e,"active",o)),e.$on("close",l[12]),e.$on("save",l[13]),{c(){se(e.$$.fragment)},m(s,a){re(e,s,a),n=!0},p(s,a){const u={};a&32&&(u.item=s[5]),a&128&&(u.initialEdit=s[7]),!t&&a&64&&(t=!0,u.active=s[6],je(()=>t=!1)),e.$set(u)},i(s){n||(E(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){ie(e,s)}}}function er(l){let e,t,n,o,r,s,a,u,d;nt(l[15]);function m(v,b){if(v[2])return xs;if(v[3])return Xs}let p=m(l),_=p&&p(l),h=l[0]&&vn(l),g=!l[2]&&!l[3]&&l[4].length>0&&bn(),$=l[8]&&kn(l),y=l[5]&&$n(l);return{c(){e=f("div"),_&&_.c(),t=k(),h&&h.c(),n=k(),g&&g.c(),o=k(),$&&$.c(),r=k(),y&&y.c(),s=Xe(),c(e,"class","graph-container svelte-1ry9pkl"),St(e,"width",l[0]?"100vw":"600px"),St(e,"height",l[0]?"100vh":"400px"),rt(e,"fullscreen",l[0])},m(v,b){T(v,e,b),_&&_.m(e,null),l[16](e),T(v,t,b),h&&h.m(v,b),T(v,n,b),g&&g.m(v,b),T(v,o,b),$&&$.m(v,b),T(v,r,b),y&&y.m(v,b),T(v,s,b),a=!0,u||(d=x(ll,"resize",l[15]),u=!0)},p(v,[b]){p===(p=m(v))&&_?_.p(v,b):(_&&_.d(1),_=p&&p(v),_&&(_.c(),_.m(e,null))),(!a||b&1)&&St(e,"width",v[0]?"100vw":"600px"),(!a||b&1)&&St(e,"height",v[0]?"100vh":"400px"),(!a||b&1)&&rt(e,"fullscreen",v[0]),v[0]?h?h.p(v,b):(h=vn(v),h.c(),h.m(n.parentNode,n)):h&&(h.d(1),h=null),!v[2]&&!v[3]&&v[4].length>0?g||(g=bn(),g.c(),g.m(o.parentNode,o)):g&&(g.d(1),g=null),v[8]?$?$.p(v,b):($=kn(v),$.c(),$.m(r.parentNode,r)):$&&($.d(1),$=null),v[5]?y?(y.p(v,b),b&32&&E(y,1)):(y=$n(v),y.c(),E(y,1),y.m(s.parentNode,s)):y&&(Ne(),I(y,1,1,()=>{y=null}),Oe())},i(v){a||(E(y),a=!0)},o(v){I(y),a=!1},d(v){v&&C(e),_&&_.d(),l[16](null),v&&C(t),h&&h.d(v),v&&C(n),g&&g.d(v),v&&C(o),$&&$.d(v),v&&C(r),y&&y.d(v),v&&C(s),u=!1,d()}}}function yn(l){return{id:`kg-node-${l.id}`,url:`#/graph/node/${l.id}`,title:l.label,body:`# ${l.label}

**Knowledge Graph Node**

ID: ${l.id}
Rank: ${l.rank}

This is a concept node from the knowledge graph. You can edit this content to add more information about "${l.label}".`,description:`Knowledge graph concept: ${l.label}`,tags:["knowledge-graph","concept"],rank:l.rank,stub:`Knowledge graph concept: ${l.label}`}}function tr(l,e,t){let n,o;ke(l,gt,S=>t(20,n=S)),ke(l,ze,S=>t(21,o=S));let{apiUrl:r="/rolegraph"}=e,{fullscreen:s=!0}=e,a,u=!0,d=null,m=[],p=[],_=null,h=!1,g=!1,$="",y=window.innerWidth,v=window.innerHeight;function b(){t(9,y=window.innerWidth),t(10,v=window.innerHeight),!u&&!d&&N()}async function L(){t(2,u=!0),t(3,d=null);try{if(o){console.log("Loading rolegraph from Tauri");const S=await Pe("get_rolegraph",{role_name:n||void 0});if(S&&S.status==="success")t(4,m=S.nodes),p=S.edges;else throw new Error(`Tauri rolegraph fetch failed: ${(S==null?void 0:S.status)||"unknown error"}`)}else{console.log("Loading rolegraph from server");const S=n?`${r}?role=${encodeURIComponent(n)}`:r,Y=await fetch(S);if(!Y.ok)throw new Error(`Failed to fetch: ${Y.status}`);const U=await Y.json();t(4,m=U.nodes),p=U.edges}}catch(S){t(3,d=S.message),console.error("Error fetching rolegraph:",S)}finally{t(2,u=!1)}}function A(S,Y){S.stopPropagation(),console.log("Node clicked:",Y.label),t(5,_=yn(Y)),t(7,g=!1),t(6,h=!0)}function K(S,Y){S.preventDefault(),S.stopPropagation(),console.log("Node right-clicked:",Y.label),t(8,$=`Right-clicked: ${Y.label}`),t(5,_=yn(Y)),t(7,g=!0),t(6,h=!0),setTimeout(()=>{t(8,$="")},2e3)}function j(){t(6,h=!1),t(5,_=null),t(7,g=!1)}async function w(){if(_)try{const S=await fetch("/documents",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});S.ok?console.log("Successfully saved KG record:",_.id):console.error("Failed to save KG record:",S.statusText)}catch(S){console.error("Error saving KG record:",S)}finally{t(6,h=!1),t(5,_=null),t(7,g=!1)}}function N(){if(!a)return;t(1,a.innerHTML="",a);const S=Xt(a).append("svg").attr("width",y).attr("height",v),Y=ro().scaleExtent([.1,10]).on("zoom",O=>{U.attr("transform",O.transform)});S.call(Y);const U=S.append("g"),Z=io(m).force("link",ao(p).id(O=>O.id).distance(100)).force("charge",uo().strength(-200)).force("center",co(y/2,v/2)).force("collision",fo().radius(20)),F=U.append("g").attr("class","links").selectAll("line").data(p).enter().append("line").attr("stroke","#666").attr("stroke-opacity",.7).attr("stroke-width",O=>{const H=O.weight||O.rank||1;return Math.max(1,Math.min(8,H*2))}),G=U.append("g").attr("class","nodes").selectAll("circle").data(m).enter().append("circle").attr("r",O=>{const H=O.rank||1;return Math.max(6,Math.min(20,H*2))}).attr("fill",O=>{const H=O.rank||1,B=Math.min(H/10,1);return po(.2+B*.6)}).attr("stroke","#fff").attr("stroke-width",2).style("cursor","pointer").on("click",(O,H)=>A(O,H)).on("contextmenu",(O,H)=>K(O,H)).on("mouseover",function(O,H){Xt(this).transition().duration(150).attr("stroke-width",3).attr("r",B=>{const oe=B.rank||1;return Math.max(8,Math.min(24,oe*2.5))})}).on("mouseout",function(O,H){Xt(this).transition().duration(150).attr("stroke-width",2).attr("r",B=>{const oe=B.rank||1;return Math.max(6,Math.min(20,oe*2))})}).call(_o().on("start",R).on("drag",W).on("end",X)),Q=U.append("g").attr("class","labels").selectAll("text").data(m).enter().append("text").attr("text-anchor","middle").attr("dy",".35em").attr("font-size","11px").attr("font-family","Arial, sans-serif").attr("fill","#333").attr("pointer-events","none").text(O=>O.label.length>12?O.label.substring(0,12)+"...":O.label);Z.on("tick",()=>{F.attr("x1",O=>O.source.x).attr("y1",O=>O.source.y).attr("x2",O=>O.target.x).attr("y2",O=>O.target.y),G.attr("cx",O=>O.x).attr("cy",O=>O.y),Q.attr("x",O=>O.x).attr("y",O=>O.y)});function R(O,H){O.active||Z.alphaTarget(.3).restart(),H.fx=H.x,H.fy=H.y}function W(O,H){H.fx=O.x,H.fy=O.y}function X(O,H){O.active||Z.alphaTarget(0),H.fx=null,H.fy=null}}ol(()=>{L().then(()=>{d||N()});const S=Y=>{Y.preventDefault()};return a&&a.addEventListener("contextmenu",S),window.addEventListener("resize",b),()=>{a&&a.removeEventListener("contextmenu",S),window.removeEventListener("resize",b)}});function P(){t(9,y=ll.innerWidth),t(10,v=ll.innerHeight)}function q(S){Ae[S?"unshift":"push"](()=>{a=S,t(1,a)})}const J=()=>history.back();function M(S){h=S,t(6,h)}return l.$$set=S=>{"apiUrl"in S&&t(14,r=S.apiUrl),"fullscreen"in S&&t(0,s=S.fullscreen)},[s,a,u,d,m,_,h,g,$,y,v,L,j,w,r,P,q,J,M]}class lr extends Qe{constructor(e){super(),Ze(this,e,tr,er,qe,{apiUrl:14,fullscreen:0})}}function nr(l){let e,t;return e=new js({}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function or(l){let e,t;return e=new jo({}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function sr(l){let e,t;return e=new Vs({}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function rr(l){let e,t;return e=new Zs({}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function ir(l){let e,t;return e=new lr({}),{c(){se(e.$$.fragment)},m(n,o){re(e,n,o),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){I(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function ar(l){let e;return{c(){e=f("nav"),e.innerHTML=`<div class="navbar-brand"><a class="navbar-item" href="/"><span class="icon" style="color: #333;"><i class="fas fa-home"></i></span></a> 
            <a class="navbar-item" href="/config/wizard">Wizard</a> 
            <a class="navbar-item" href="/config/json">JSON Editor</a> 
            <a class="navbar-item" href="/graph">Graph</a></div>`,c(e,"class","navbar")},m(t,n){T(t,e,n)},p:ve,d(t){t&&C(e)}}}function ur(l){let e,t,n,o,r,s,a,u,d,m,p,_,h,g,$,y,v,b,L,A,K,j,w,N,P,q,J,M;return a=new Jt({}),m=new ct({props:{path:"/",$$slots:{default:[nr]},$$scope:{ctx:l}}}),g=new ct({props:{path:"/fetch/*",$$slots:{default:[or]},$$scope:{ctx:l}}}),y=new ct({props:{path:"/config/wizard",$$slots:{default:[sr]},$$scope:{ctx:l}}}),b=new ct({props:{path:"/config/json",$$slots:{default:[rr]},$$scope:{ctx:l}}}),A=new ct({props:{path:"/graph",$$slots:{default:[ir]},$$scope:{ctx:l}}}),N=new ct({props:{path:"/",$$slots:{default:[ar]},$$scope:{ctx:l}}}),{c(){e=f("meta"),t=k(),n=f("div"),o=f("main"),r=f("div"),s=f("div"),se(a.$$.fragment),u=k(),d=f("div"),se(m.$$.fragment),p=k(),_=f("br"),h=k(),se(g.$$.fragment),$=k(),se(y.$$.fragment),v=k(),se(b.$$.fragment),L=k(),se(A.$$.fragment),K=k(),j=f("footer"),w=f("div"),se(N.$$.fragment),c(e,"name","color-scheme"),c(e,"content",l[1]),document.title="Terraphim",c(s,"class","role-selector svelte-1bfpta4"),c(r,"class","top-controls svelte-1bfpta4"),c(d,"class","search-area svelte-1bfpta4"),c(o,"class","main-content svelte-1bfpta4"),c(w,"class",P=ht(l[0])+" svelte-1bfpta4"),c(j,"class","svelte-1bfpta4"),c(n,"class","is-full-height svelte-1bfpta4")},m(S,Y){i(document.head,e),T(S,t,Y),T(S,n,Y),i(n,o),i(o,r),i(r,s),re(a,s,null),i(o,u),i(o,d),re(m,d,null),i(o,p),i(o,_),i(o,h),re(g,o,null),i(o,$),re(y,o,null),i(o,v),re(b,o,null),i(o,L),re(A,o,null),i(n,K),i(n,j),i(j,w),re(N,w,null),q=!0,J||(M=[x(j,"mouseover",l[2]),x(j,"focus",l[2])],J=!0)},p(S,[Y]){(!q||Y&2)&&c(e,"content",S[1]);const U={};Y&8&&(U.$$scope={dirty:Y,ctx:S}),m.$set(U);const Z={};Y&8&&(Z.$$scope={dirty:Y,ctx:S}),g.$set(Z);const F={};Y&8&&(F.$$scope={dirty:Y,ctx:S}),y.$set(F);const G={};Y&8&&(G.$$scope={dirty:Y,ctx:S}),b.$set(G);const Q={};Y&8&&(Q.$$scope={dirty:Y,ctx:S}),A.$set(Q);const R={};Y&8&&(R.$$scope={dirty:Y,ctx:S}),N.$set(R),(!q||Y&1&&P!==(P=ht(S[0])+" svelte-1bfpta4"))&&c(w,"class",P)},i(S){q||(E(a.$$.fragment,S),E(m.$$.fragment,S),E(g.$$.fragment,S),E(y.$$.fragment,S),E(b.$$.fragment,S),E(A.$$.fragment,S),E(N.$$.fragment,S),q=!0)},o(S){I(a.$$.fragment,S),I(m.$$.fragment,S),I(g.$$.fragment,S),I(y.$$.fragment,S),I(b.$$.fragment,S),I(A.$$.fragment,S),I(N.$$.fragment,S),q=!1},d(S){C(e),S&&C(t),S&&C(n),ie(a),ie(m),ie(g),ie(y),ie(b),ie(A),ie(N),J=!1,Je(M)}}}function cr(l,e,t){let n;ke(l,Ht,s=>t(1,n=s));let o="is-hidden";function r(){t(0,o="")}return[o,n,r]}class fr extends Qe{constructor(e){super(),Ze(this,e,cr,ur,qe,{})}}const dr=new no;oo(dr);new fr({target:document.getElementById("app")});
